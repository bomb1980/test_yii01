<?php

class SiteController extends Controller
{
	/**
	 * Declares class-based actions.
	 */
	 
	 private $idtoken_logout; 
	 
    /*function init(){
		//if(Yii::app()->user->isGuest){
			//parent::chkLogin(); 
		//}
	}*/
	 
	public function actions()
	{
		return array(
			// captcha action renders the CAPTCHA image displayed on the contact page
			'captcha'=>array(
				'class'=>'CCaptchaAction',
				'backColor'=>0xFFFFFF,
			),
			// page action renders "static" pages stored under 'protected/views/site/pages'
			// They can be accessed via: index.php?r=site/page&view=FileName
			'page'=>array(
				'class'=>'CViewAction',
			),
		);
	}

	/**
	 * This is the default 'index' action that is invoked
	 * when an action is not explicitly requested by users.
	 */
	public function actionIndex()
	{
		
		if(!Yii::app()->user->isGuest) { //if(!isset(Yii::app()->session['sub'])){ //
			//ถ้า login แล้ว
		if(isset(Yii::app()->user->firstname)){
			  if(Yii::app()->user->access_level=='admin'){
				  $this->render('index');
			  }else{
				  $this->render('/site/searchpages/searchs');	
			  }
		   }else{
				echo preg_replace("/\xEF\xBB\xBF/", "","กรุณาติดต่อผู้ดูแลระบบ เพื่อตรวจสอบสิทธ์การใช้งานโปรแกรม WPD !");	
		   }
			
		}else{
			//ถ้ายังไม่ login
			
			if(!isset(Yii::app()->session['sub'])){
				$idplib = new Idplib();
				$idplib->getIdpinfo();
				
				$this->idtoken_logout=$idplib->idtoken;
				
				//sch user
			  $q = new CDbCriteria( array(
				  'condition' => "username = :username ",         
				  'params'    => array(':username' => $idplib->sub)  
			  ));
			   $susa = Users::model()->findAll($q);
			   $countusa = count($susa);
			   if($countusa==0){
				   if($idplib->sub=='kporntima'){
					   $puser = "admin";
				   }else{
					   $puser = "user";
				   }
				   
				  $Users = new Users();
				  $Users->firstname = $idplib->SSOfirstname;
				  $Users->lastname = $idplib->SSOsurname;
				  $Users->email = "-";
				  $Users->contact_number = "-";
				  $Users->address = $idplib->SSObranchCode;
				  $Users->username = $idplib->sub;
				  $Users->password = "-";
				  $Users->access_level = "user";
				  $Users->access_code = "1";
				  $Users->status = 1;
				  $Users->image = "-";
				  $Users->created = date('Y-m-d H:i:s');
				  $Users->modified = date('Y-m-d H:i:s');
				  if($Users->save()){
					  //echo CJSON::encode(array('status' => 'success'));
					  $identity = new UserIdentity($idplib->sub,""); 
					  $identity->authenticate();
					  if($identity->errorCode===UserIdentity::ERROR_NONE)
					  {
						  
						  $duration=3600*24*30; // 30 days
						  Yii::app()->user->login($identity,$duration);
						  
						  if(Yii::app()->user->firstname){
						  
							  if(Yii::app()->user->access_level=='admin'){
								  $this->render('index');
							  }else{
								  $this->render('/site/searchpages/searchs');	
							  }
						  
						  }else{
							  echo preg_replace("/\xEF\xBB\xBF/", "","กรุณาติดต่อผู้ดูแลระบบ เพื่อตรวจสอบสิทธ์การใช้งานโปรแกรม WPD !");	
						  }
					  }
					  
				  }else{
					  //echo CJSON::encode(array('status' => 'error'));
					  echo preg_replace("/\xEF\xBB\xBF/", "",CJSON::encode($Users->getErrors()));
				  }
			   }else{//if($countusg==0)
				  //echo CJSON::encode(array('status' => 'errordup'));
				  $identity = new UserIdentity($idplib->sub,""); 
				  $identity->authenticate();
				  if($identity->errorCode===UserIdentity::ERROR_NONE)
				  {
					  Yii::app()->user->login($identity);
					  
					  if(Yii::app()->user->firstname){
					  
						  if(Yii::app()->user->access_level=='admin'){
							  $this->render('index');
						  }else{
							  $this->render('/site/searchpages/searchs');	
						  }
					  
					  }else{
						  echo preg_replace("/\xEF\xBB\xBF/", "","กรุณาติดต่อผู้ดูแลระบบ เพื่อตรวจสอบสิทธ์การใช้งานโปรแกรม WPD !");	
					  }
				  }
				  
			   }
			   
			   
			}
			
			
			/*
			$model=new LoginForm;
			if(isset($_POST['ajax']) && $_POST['ajax']==='login-form')
			{
				echo CActiveForm::validate($model);
				Yii::app()->end();
			}
			if(isset($_POST['LoginForm']))
			{
				$model->attributes=$_POST['LoginForm'];
				
				if($model->validate() && $model->login())
					$this->redirect(Yii::app()->user->returnUrl);
			}
			
			$this->render('login',array('model'=>$model));
			*/
			
		}// if isGuest
	}// function actionIndex

	/**
	 * This is the action to handle external exceptions.
	 */
	 
    public function actionShowabout(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
				$msgresult = Yii::app()->Clogevent->createlogevent("open", "aboutpage", "openabountpage", "about", "เปิดหน้าAbout");
				$this->render('index');
	   		}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}
	 
	public function actionError()
	{
	    if($error=Yii::app()->errorHandler->error)
	    {
	    	if(Yii::app()->request->isAjaxRequest)
	    		echo preg_replace("/\xEF\xBB\xBF/", "",$error['message']);
	    	else
	        	$this->render('error', $error);
	    }
	}

	/**
	 * Displays the contact page
	 */
	public function actionContact()
	{
		$model=new ContactForm;
		if(isset($_POST['ContactForm']))
		{
			$model->attributes=$_POST['ContactForm'];
			if($model->validate())
			{
				$headers="From: {$model->email}\r\nReply-To: {$model->email}";
				mail(Yii::app()->params['adminEmail'],$model->subject,$model->body,$headers);
				Yii::app()->user->setFlash('contact','Thank you for contacting us. We will respond to you as soon as possible.');
				$this->refresh();
			}
		}
		$this->render('contact',array('model'=>$model));
	}

	/**
	 * Displays the login page
	 */
	public function actionLogin()
	{
		$model=new LoginForm;

		// if it is ajax validation request
		if(isset($_POST['ajax']) && $_POST['ajax']==='login-form')
		{
			echo preg_replace("/\xEF\xBB\xBF/", "",CActiveForm::validate($model));
			Yii::app()->end();
		}

		// collect user input data
		if(isset($_POST['LoginForm']))
		{
			$model->attributes=$_POST['LoginForm'];
			// validate user input and redirect to the previous page if valid
			if($model->validate() && $model->login())
				$this->redirect(Yii::app()->user->returnUrl);
		}
		// display the login form
		$this->render('login',array('model'=>$model));
	}

	/**
	 * Logs out the current user and redirect to homepage.
	 */
	public function actionLogout()
	{
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		
		$msgresult = Yii::app()->Clogevent->createlogevent("logout", "loginpage", "logout", "userstb", "ออกจากระบบ");
		
		$idtokeninfo = Yii::app()->session['idtoken'];
		
		foreach($idtokeninfo as $key=>$value){
		  if($key=='payload'){
			  $idtoken2 = $value[0] . "." . $value[1] . "." . $value[2];
		  }
		}
		
		Yii::app()->session->destroy();
		Yii::app()->user->logout();
		//$this->redirect(Yii::app()->homeUrl);
		
		$linklogout = Yii::app()->params['urllogout1'] . $idtoken2 . Yii::app()->params['urllogout2'];
		$this->redirect($linklogout);
		
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
		
	}
	
	/* custom function */
	public function actionOpenhome(){
		if(!Yii::app()->user->isGuest) {
			$this->layout='nolayout';
			$this->render('home');
		}
	}
	
	public function actionServices(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		$msgresult = Yii::app()->Clogevent->createlogevent("open", "servicepage", "openservicepage", "services", "เปิดหน้าservice");
		$this->render('/site/servicepages/allservices');
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}
	
	
	
	public function actionSearchs(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		$msgresult = Yii::app()->Clogevent->createlogevent("open", "searchpage", "opensearchpage", "search", "เปิดหน้าsearch");
		$this->render('/site/searchpages/searchs');
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}
	
	public function actionReports(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		$msgresult = Yii::app()->Clogevent->createlogevent("open", "reportpage", "openreportpage", "report", "เปิดหน้าreport");
		$this->render('/site/reportpages/reports');
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}
	
	public function actionAdmins(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		$msgresult = Yii::app()->Clogevent->createlogevent("open", "adminpage", "openadminpage", "admin", "เปิดหน้าadmin");
		$this->render('/site/adminpages/admins');
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}
	
	
	public function actionOpenservice(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		$snum = $_POST['snum'];
		$lremark = "เปิดเมนูย่อยservice:" . $snum;
		$msgresult = Yii::app()->Clogevent->createlogevent("open", "servicepage", "openservicepage", "subservice", $lremark);
		$this->layout='nolayout';
		$this->render('/site/servicepages/service' . $snum);
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}
	
	public function actionOpensearch(){
		
			//$idplib = new Idplib();
			//$idplib->getIdpinfo();
		
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		$snum = $_POST['snum'];
		$lremark = "เปิดเมนูย่อยsearch:" . $snum;
		$msgresult = Yii::app()->Clogevent->createlogevent("open", "searchpage", "opensearchpage", "subsearch", $lremark);
		$this->layout='nolayout';
		$this->render('/site/searchpages/search' . $snum);
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}
	
	public function actionOpenreport(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		$snum = $_POST['snum'];
		$lremark = "เปิดเมนูย่อยreport:" . $snum;
		$msgresult = Yii::app()->Clogevent->createlogevent("open", "reportpage", "openreportpage", "subreport", $lremark);
		$this->layout='nolayout';
		$this->render('/site/reportpages/report' . $snum);
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}
	
	public function actionOpenadmin(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		$snum = $_POST['snum'];
		$lremark = "เปิดเมนูย่อยadmin:" . $snum;
		$msgresult = Yii::app()->Clogevent->createlogevent("open", "adminpage", "openadminpage", "subadmin", $lremark);
		$this->layout='nolayout';
		$this->render('/site/adminpages/admin' . $snum);
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}
	
	public function actionOpenadminuser(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		$snum = $_POST['snum'];
		$lremark = "เปิดเมนูย่อยadminuser:" . $snum;
		$msgresult = Yii::app()->Clogevent->createlogevent("open", "adminuserpage", "openadminuserpage", "subadminuser", $lremark);
		$this->layout='nolayout';
		$this->render('/site/adminpages/admin1' . $snum);
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}
	
	public function actionCalldbdservice(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		//bgdatep,eddatep,newdap,updap
		$bgdatep = $_POST['bgdatep'];
		$eddatep = $_POST['eddatep'];
		$newdap = $_POST['newdap'];
		$updap = $_POST['updap'];
		//echo 'ส่งข้อมูลสำเร็จ.' . $bgdatep . ',' . $eddatep . ',' . $newdap . ',' . $updap;
		$data1 = array('bgdatep' => $bgdatep, 'eddatep' => $eddatep, 'newdap' => $newdap, 'updap' => $updap);
		$this->layout='nolayout';
		//$this->render('/site/servicepages/callaspservice');
		$this->render('/site/servicepages/calldbdservice', $data1);
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}
	
	public function actionCalldbdservice2(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		//bgdatep,eddatep,newdap,updap
		$bgdatep = $_POST['bgdatep'];
		$eddatep = $_POST['eddatep'];
		$newdap = $_POST['newdap'];
		$updap = $_POST['updap'];
		//echo 'ส่งข้อมูลสำเร็จ.' . $bgdatep . ',' . $eddatep . ',' . $newdap . ',' . $updap;
		$data1 = array('bgdatep' => $bgdatep, 'eddatep' => $eddatep, 'newdap' => $newdap, 'updap' => $updap);
		$this->layout='nolayout';
		$this->render('/site/servicepages/calldbdservice2', $data1);
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}
	
	public function actionCalldbdservice2auto(){
		
		//bgdatep,eddatep,newdap,updap
		$bgdatep = $_POST['bgdatep'];
		$eddatep = $_POST['eddatep'];
		$newdap = $_POST['newdap'];
		$updap = $_POST['updap'];
		//echo 'ส่งข้อมูลสำเร็จ.' . $bgdatep . ',' . $eddatep . ',' . $newdap . ',' . $updap;
		$data1 = array('bgdatep' => $bgdatep, 'eddatep' => $eddatep, 'newdap' => $newdap, 'updap' => $updap);
		$this->layout='nolayout';
		$this->render('/site/servicepages/calldbdservice2auto', $data1);
		
	}
	
	public function actionCalldbdservice3(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		$bgdatep = $_POST['bgdatep'];
		$eddatep = $_POST['eddatep'];
		$newdap = $_POST['newdap'];
		$updap = $_POST['updap'];
		//echo 'ส่งข้อมูลสำเร็จ.' . $bgdatep . ',' . $eddatep . ',' . $newdap . ',' . $updap;
		$data1 = array('bgdatep' => $bgdatep, 'eddatep' => $eddatep, 'newdap' => $newdap, 'updap' => $updap);
		$this->layout='nolayout';
		$this->render('/site/servicepages/calldbdservice3', $data1);
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
		
	}
	
	public function actionCalldbdservice3auto(){
		
		$bgdatep = $_POST['bgdatep'];
		$eddatep = $_POST['eddatep'];
		$newdap = $_POST['newdap'];
		$updap = $_POST['updap'];
		//echo 'ส่งข้อมูลสำเร็จ.' . $bgdatep . ',' . $eddatep . ',' . $newdap . ',' . $updap;
		$data1 = array('bgdatep' => $bgdatep, 'eddatep' => $eddatep, 'newdap' => $newdap, 'updap' => $updap);
		$this->layout='nolayout';
		$this->render('/site/servicepages/calldbdservice3auto', $data1);
		
		
	}
	
	public function actionCalldbdservice4(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		$bgdatep = $_POST['bgdatep'];
		$eddatep = $_POST['eddatep'];
		$newdap = $_POST['newdap'];
		$updap = $_POST['updap'];
		//echo 'ส่งข้อมูลสำเร็จ.' . $bgdatep . ',' . $eddatep . ',' . $newdap . ',' . $updap;
		$data1 = array('bgdatep' => $bgdatep, 'eddatep' => $eddatep, 'newdap' => $newdap, 'updap' => $updap);
		$this->layout='nolayout';
		$this->render('/site/servicepages/calldbdservice4', $data1);
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
		
	}
	
	public function actionCalldbdservice4auto(){
		
		$bgdatep = $_POST['bgdatep'];
		$eddatep = $_POST['eddatep'];
		$newdap = $_POST['newdap'];
		$updap = $_POST['updap'];
		//echo 'ส่งข้อมูลสำเร็จ.' . $bgdatep . ',' . $eddatep . ',' . $newdap . ',' . $updap;
		$data1 = array('bgdatep' => $bgdatep, 'eddatep' => $eddatep, 'newdap' => $newdap, 'updap' => $updap);
		$this->layout='nolayout';
		$this->render('/site/servicepages/calldbdservice4auto', $data1);
		
		
	}
	
	
	public function actionCallwpdservice1(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		$action = $_POST['action'];
		$bgdatep = $_POST['bgdatep'];
		$rundate = date_create($bgdatep)->format('Ymd');
		//echo "{$action}";
		Yii::app()->Clogrunservice->lrs_servicename = "service1";	
		Yii::app()->Clogrunservice->lrs_remark = $rundate; //date('Ymd'); //$rundate;	
		
		$resultlrs = Yii::app()->Clogrunservice->checkexists2();
		
		echo preg_replace("/\xEF\xBB\xBF/", "","{$resultlrs}");	
		/*if(!Yii::app()->Clogrunservice->checkexists2()){
			echo "No data";
		}else{
			echo "Have data";
		}*/
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}
	
	public function actionCallservice2(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		$aa=$_POST['aa'];
		Yii::app()->CWpdApi->registernumber = "0905562002699"; //กำหนดค่าให้ property in class
		Yii::app()->CCropinfo_tmp->registernumber = "0905562002699"; //กำหนดค่าให้ property in class
		$msg1 = Yii::app()->CWpdApi->getVersion();
		$msg2 = Yii::app()->CCropinfo_tmp->create_corpinfo_temp();
		$msg3 = Yii::app()->CWpdApi->getVar1();
		echo preg_replace("/\xEF\xBB\xBF/", "","Test Callservice {$aa} : {$msg1} <br> {$msg2}, {$msg3}");
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}
	
	public function actionCallservice3(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		$provicecode=$_POST['provicecode']; //รับค่าจาก view
		$registernumber=$_POST['registernumber'];
		Yii::app()->CGenAccNo->provice_code = $provicecode; //กำหนดค่าให้ propreties
		Yii::app()->CGenAccNo->registernumber = $registernumber; 
		//$msg3 = Yii::app()->CGenAccNo->getVar1();
		$numrows = Yii::app()->CGenAccNo->RowsCount();
		Yii::app()->CGenAccNo->rowcountnew = intval($numrows) + 1;
		$newrow = Yii::app()->CGenAccNo->rowcountnew;
		$genacc = Yii::app()->CGenAccNo->genAccNumber();//เรียกใช้ method 
		$createnumprovice = Yii::app()->CGenAccNo->updatenumprovice();
		//$createc = Yii::app()->CGenAccNo->CreateNewAcc(); 
		echo preg_replace("/\xEF\xBB\xBF/", "","{$numrows},-{$genacc}-, {$newrow}, {$createnumprovice}"); //{$numrows}, {$newrow}, {$createnumprovice}
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}
	
	public function actionCallservice4(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		$action = $_POST['action'];
		if($action=="add"){
			/*
			$f1 = iconv("utf-8","tis-620","8000");
			$f2 = iconv("utf-8","tis-620","25620501");
			$f3 = iconv("utf-8","tis-620","102016");
			$f4 = iconv("utf-8","tis-620","8320000025");
			$f5 = iconv("utf-8","tis-620","000000");
			$f6 = iconv("utf-8","tis-620","0835562007340");
			$f7 = iconv("utf-8","tis-620","อีซี่ ทัวร์ เพอร์ซันนอล เทเลอร์");
			$f8 = iconv("utf-8","tis-620","01");
			$f9 = iconv("utf-8","tis-620","52/134 หมู่.2");
			$f10 = iconv("utf-8","tis-620","ตำบลวิชิต");
			$f11 = iconv("utf-8","tis-620","8301");
			$f12 = iconv("utf-8","tis-620","83");
			$f13 = iconv("utf-8","tis-620","83000");
			$f14 = iconv("utf-8","tis-620","0645406893");
			$f15 = iconv("utf-8","tis-620","0645406893");
			$f16 = iconv("utf-8","tis-620","25620601");
			$f17 = iconv("utf-8","tis-620","");
			*/
			
			Yii::app()->CGenAccNo->provice_code = "11"; //กำหนดค่าให้ propreties
		    Yii::app()->CGenAccNo->registernumber = "0115562012587"; 
			
			//set data to properties
			Yii::app()->CCropinfo_tmp->registernumber = "0115562012587"; // VARCHAR( 13 ) NOT NULL COMMENT 'เลขทะเบียนนิติบุคคล' ,
			Yii::app()->CCropinfo_tmp->registername = "คุ้มหลวง ทูยู" ; // VARCHAR( 1000 ) NOT NULL COMMENT 'ชื่อที่ใช้จดทะเบียน' ,
			Yii::app()->CCropinfo_tmp->acc_no = Yii::app()->CGenAccNo->genAccNumber(); // VARCHAR( 10 ) NOT NULL COMMENT 'เลขที่บัญชี' ,
			Yii::app()->CCropinfo_tmp->acc_bran = "000000"; // VARCHAR( 6 ) NOT NULL COMMENT 'สาขา' ,
			Yii::app()->CCropinfo_tmp->tsic = "47612"; // VARCHAR( 5 ) NOT NULL COMMENT 'รหัส tsic' ,
			Yii::app()->CCropinfo_tmp->tsicname = "ร้านขายปลีกเครื่องเขียนและเครื่องใช้สำนักงาน"; // VARCHAR( 1000 ) NOT NULL COMMENT 'ชื่อ tsic' ,
			Yii::app()->CCropinfo_tmp->corptype = "5"; // VARCHAR( 1 ) NOT NULL COMMENT 'รหัสประเภทธุรกิจ' ,
			Yii::app()->CCropinfo_tmp->corptypename = "บริษัทจำกัด"; // VARCHAR( 1000 ) NOT NULL COMMENT 'ชื่อประเภท' ,
			Yii::app()->CCropinfo_tmp->registerdate = "2019-05-01 00:00:00"; // DATETIME NOT NULL COMMENT 'วันที่จดทะเบียน' ,
			Yii::app()->CCropinfo_tmp->updateddate = "1900-01-01 00:00:00"; // DATETIME NOT NULL COMMENT 'วันที่มีการแก้ไขข้อมูลล่าสุด' ,
			Yii::app()->CCropinfo_tmp->updateentry = "0"; // VARCHAR( 1 ) NOT NULL COMMENT 'มีการแก้ไขข้อมูลหลังจากลงทะเบียน' ,
			Yii::app()->CCropinfo_tmp->accountingdate = "3112"; // VARCHAR( 4 ) NOT NULL COMMENT 'รอบปีบัญชี' ,
			Yii::app()->CCropinfo_tmp->authorizedcapital = "1000000"; // Double(20 ,2) NOT NULL COMMENT 'ทุนจดทะเบียน' ,
			Yii::app()->CCropinfo_tmp->statuscode = "1"; // VARCHAR( 1 ) NOT NULL COMMENT 'สถานะนิติบุคคล' ,
			Yii::app()->CCropinfo_tmp->cpower = "กรรมการหนึ่งคนลงลายมือชื่อและประทับตราสำคัญของบริษัท"; // VARCHAR( 5000 ) NOT NULL COMMENT 'จำนวนหรือชื่อกรรมการที่ลงชื่อผูกพัน' ,
			Yii::app()->CCropinfo_tmp->crop_remark = "-"; // TEXT NULL COMMENT 'หมายเหตุ' ,
			Yii::app()->CCropinfo_tmp->crop_createby = "sys"; // VARCHAR( 100 ) NOT NULL COMMENT 'สร้างโดย' ,
			Yii::app()->CCropinfo_tmp->crop_createtime = date('Y-m-d H:i:s'); // DATETIME NOT NULL COMMENT 'วันที่สร้าง' ,
			Yii::app()->CCropinfo_tmp->crop_updateby = "sys"; // VARCHAR( 100 ) NOT NULL COMMENT 'แก้ไขโดย' ,
			Yii::app()->CCropinfo_tmp->crop_updatetime = date('Y-m-d H:i:s'); // DATETIME NOT NULL COMMENT 'วันที่แก้ไข' ,
			Yii::app()->CCropinfo_tmp->crop_status = 1; // TINYINT( 1 ) NOT NULL DEFAULT '1' COMMENT 'สถานะ 1.ใช้งานปกติ' ,
			
			if(!Yii::app()->CCropinfo_tmp->regexists()){
				$createc = Yii::app()->CGenAccNo->CreateNewAcc(); 
				$msg_result = Yii::app()->CCropinfo_tmp->create();
			}else{
				$msg_result = "มีรายการข้อมูลเลขนิติบุคคล : " . Yii::app()->CCropinfo_tmp->registernumber . " อยู่ในระบบแล้ว.";	
			}
			
			
			echo preg_replace("/\xEF\xBB\xBF/", "","{$msg_result},");
			
		}
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}
	
	public function actionCallservice5(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		Yii::app()->CCropinfo_tmp->registernumber = "0115562012587";
		//$msg_result = Yii::app()->CWpdApi->regexists();
		if(Yii::app()->CCropinfo_tmp->regexists()){
			echo preg_replace("/\xEF\xBB\xBF/", "","มีข้อมูลอยู่แล้ว");
		}else{
			echo preg_replace("/\xEF\xBB\xBF/", "","ยังไม่มีข้อมูล");
		}
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}//public function actionCallservice5(){
	
	public function actionAddcommittee(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		$action = $_POST['action'];
		echo preg_replace("/\xEF\xBB\xBF/", "","{$action},");
		
		//กำหนดค่า ให้ properties ใน class
		Yii::app()->CCommittee_tmp->crop_id = Yii::app()->CCropinfo_tmp->getlastcorpid(); 
		Yii::app()->CCommittee_tmp->registernumber = "0115562012587"; //** select
		Yii::app()->CCommittee_tmp->tsic = "47612"; //** select
		Yii::app()->CCommittee_tmp->corptype = "5";  //** select
		Yii::app()->CCommittee_tmp->committeetype = "K"; 
		Yii::app()->CCommittee_tmp->ordernumber = 1; 
		Yii::app()->CCommittee_tmp->typeno = "1"; 
		Yii::app()->CCommittee_tmp->identity = "1100800307965"; 
		Yii::app()->CCommittee_tmp->birthday = "1986-10-24 00:00:00"; 
		Yii::app()->CCommittee_tmp->title = "น.ส."; 
		Yii::app()->CCommittee_tmp->firstname = "จันท์สุดา"; 
		Yii::app()->CCommittee_tmp->lastname = "นวมรัตน์"; 
		Yii::app()->CCommittee_tmp->englishtitle = "Ms."; 
		Yii::app()->CCommittee_tmp->englishfirstname12 = "JANSUDA"; 
		Yii::app()->CCommittee_tmp->englishlastname = "NAWAMARAT"; 
		Yii::app()->CCommittee_tmp->nation = "TH"; 
		Yii::app()->CCommittee_tmp->cmit_remark = "-"; 
		Yii::app()->CCommittee_tmp->cmit_createby = "sys"; 
		Yii::app()->CCommittee_tmp->cmit_createtime = date('Y-m-d H:i:s'); 
		Yii::app()->CCommittee_tmp->cmit_updateby = "sys"; 
		Yii::app()->CCommittee_tmp->cmit_updatetime = date('Y-m-d H:i:s');
		Yii::app()->CCommittee_tmp->cmit_status = 1; 
		
		if(!Yii::app()->CCommittee_tmp->committeeexists()){
			$msg_result = Yii::app()->CCommittee_tmp->create();
		}else{
			$msg_result = preg_replace("/\xEF\xBB\xBF/", "","มีรายการเลขที่บัตรประจำตัว : " . Yii::app()->CCommittee_tmp->identity . " อยู่ในระบบแล้ว.");	
		}
		
		echo "{$msg_result},";
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
		
	}
	
	public function actionGetlastcorpid(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		$action = $_POST['action'];
		$lastcropid = Yii::app()->CCropinfo_tmp->getlastcorpid();
		echo preg_replace("/\xEF\xBB\xBF/", "","{$action}, {$lastcropid}");
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}
	
	public function actionChkcommitteeexists(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		$action = $_POST['action'];
		echo preg_replace("/\xEF\xBB\xBF/", "","{$action}, ");
		Yii::app()->CCommittee_tmp->crop_id = 1;
		Yii::app()->CCommittee_tmp->registernumber = "0115562012587";
		Yii::app()->CCommittee_tmp->committeetype = "K";
		Yii::app()->CCommittee_tmp->ordernumber = 1;
		Yii::app()->CCommittee_tmp->identity = "1100800307965";
		if(Yii::app()->CCommittee_tmp->committeeexists()){
			echo preg_replace("/\xEF\xBB\xBF/", "","มีข้อมูลอยู่แล้ว");
		}else{
			echo preg_replace("/\xEF\xBB\xBF/", "","ยังไม่มีข้อมูล");	
		}
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
		
	}//public function actionChkcommitteeexists(){
		
	public function actionAddbbranch(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		$action = $_POST['action'];
		echo preg_replace("/\xEF\xBB\xBF/", "","{$action}, ");

		Yii::app()->CBranch_tmp->crop_id = Yii::app()->CCropinfo_tmp->getlastcorpid();
		Yii::app()->CBranch_tmp->registernumber = "0115562012587"; 
		Yii::app()->CBranch_tmp->tsic = "47612"; 
		Yii::app()->CBranch_tmp->corptype = "5"; 
		Yii::app()->CBranch_tmp->ordernumber = 1; 
		Yii::app()->CBranch_tmp->name = "สำนักงานใหญ่"; 
		Yii::app()->CBranch_tmp->houseid = "11031785426"; 
		Yii::app()->CBranch_tmp->housenumber = "111/418"; 
		Yii::app()->CBranch_tmp->buildingname = "-"; 
		Yii::app()->CBranch_tmp->buildingnumber = "-"; 
		Yii::app()->CBranch_tmp->buildingfloor = "-";
		Yii::app()->CBranch_tmp->village = "-"; 
		Yii::app()->CBranch_tmp->moo = "4"; 
		Yii::app()->CBranch_tmp->soi = "-"; 
		Yii::app()->CBranch_tmp->road = "-"; 
		Yii::app()->CBranch_tmp->tumbon = "บางแก้ว"; 
		Yii::app()->CBranch_tmp->tumboncode = "02"; 
		Yii::app()->CBranch_tmp->ampur = "บางพลี"; 
		Yii::app()->CBranch_tmp->ampurcode = "03"; 
		Yii::app()->CBranch_tmp->province = "สมุทรปราการ"; 
		Yii::app()->CBranch_tmp->provincecode = "11"; 
		Yii::app()->CBranch_tmp->zipcode = "10540"; 
		Yii::app()->CBranch_tmp->phonenumber = "0922460043"; 
		Yii::app()->CBranch_tmp->faxnumber = "-";
		Yii::app()->CBranch_tmp->email = "-"; 
		Yii::app()->CBranch_tmp->brch_remark = "-"; 
		Yii::app()->CBranch_tmp->brch_createby = "sys"; 
		Yii::app()->CBranch_tmp->brch_createtime = date('Y-m-d H:i:s'); 
		Yii::app()->CBranch_tmp->brch_updateby = "sys"; 
		Yii::app()->CBranch_tmp->brch_updatetime = date('Y-m-d H:i:s'); 
		Yii::app()->CBranch_tmp->brch_status = 1; 
		
		if(!Yii::app()->CBranch_tmp->branchexists()){
			$msg_result = Yii::app()->CBranch_tmp->create();
		}else{
			$msg_result = "มีรายการสาขา : " . Yii::app()->CBranch_tmp->name . " อยู่ในระบบแล้ว.";		
		}
		
		echo preg_replace("/\xEF\xBB\xBF/", "","{$msg_result},");
		
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}
	
	public function actionCallschcropinfo(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		$action = $_POST['action'];
		$regisnum = $_POST['regisnum'];
		//echo "{$action},{$regisnum}";
		$data1 = array('action' => $action, 'regisnum' => $regisnum);
		$this->layout='nolayout';
		$this->render('/site/servicepages/schcropinfo', $data1);
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}
	
	public function actionCallschcropinfosp(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		$action = $_POST['action'];
		$regisnum = $_POST['regisnum'];
		//echo "{$action},{$regisnum}";
		$data1 = array('action' => $action, 'regisnum' => $regisnum);
		$this->layout='nolayout';
		$this->render('/site/searchpages/schcropinfosp', $data1);
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}
	
	public function actionCallschcropinfosp1(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		$action = $_POST['action'];
		$regisnum = $_POST['regisnum'];
		//echo "{$action},{$regisnum}";
		$data1 = array('action' => $action, 'regisnum' => $regisnum);
		$this->layout='nolayout';
		$this->render('/site/searchpages/schcropinfosp1', $data1);
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}
	
	public function actionCallschcommittee(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		$action = $_POST['action'];
		$regisnum = $_POST['regisnum'];
		//echo "{$action},{$regisnum}";
		$data1 = array('action' => $action, 'regisnum' => $regisnum);
		$this->layout='nolayout';
		$this->render('/site/servicepages/schcommittee', $data1);
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}
	
	public function actionCallschcommitteesp(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		$action = $_POST['action'];
		$regisnum = $_POST['regisnum'];
		//echo "{$action},{$regisnum}";
		$data1 = array('action' => $action, 'regisnum' => $regisnum);
		$this->layout='nolayout';
		$this->render('/site/searchpages/schcommitteesp', $data1);
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}
	
	public function actionCallschbranch(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		$action = $_POST['action'];
		$regisnum = $_POST['regisnum'];
		//echo "{$action},{$regisnum}";
		$data1 = array('action' => $action, 'regisnum' => $regisnum);
		$this->layout='nolayout';
		$this->render('/site/servicepages/schbranch', $data1);
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}
	
	public function actionCallschbranchsp(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		$action = $_POST['action'];
		$regisnum = $_POST['regisnum'];
		//echo "{$action},{$regisnum}";
		$data1 = array('action' => $action, 'regisnum' => $regisnum);
		$this->layout='nolayout';
		$this->render('/site/searchpages/schbranchsp', $data1);
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}
	
	public function actionCallschdetailcrop(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		$action = $_POST['action'];
		$regisnum = $_POST['regisnum'];
		//echo "{$action},{$regisnum}";
		$data1 = array('action' => $action, 'regisnum' => $regisnum);
		$this->layout='nolayout';
		$this->render('/site/servicepages/schdetailcrop', $data1);
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}
	
	public function actionCallschdetailcropsp(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		$action = $_POST['action'];
		$regisnum = $_POST['regisnum'];
		//echo "{$action},{$regisnum}";
		$data1 = array('action' => $action, 'regisnum' => $regisnum);
		$this->layout='nolayout';
		$this->render('/site/searchpages/schdetailcropsp', $data1);
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}
	
	public function actionChgstatusfrm(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		$action = $_POST['action'];
		$crop_id = $_POST['crop_id'];
		$registernumber = $_POST['registernumber'];
		//echo "{$action},{$crop_id},{$registernumber}";
		//$match = addcslashes($eid, '%_'); // escape LIKE's special characters
		$q = new CDbCriteria( array(
    		'condition' => "crop_id = :crop_id",         // no quotes around :match
    		'params'    => array(':crop_id' => "{$crop_id}")  // Aha! Wildcards go here
		));
		$model = CropinfoTmpTb::model()->findAll($q);
	 	$encode = CJSON::encode($model);
		//echo "{$encode}";
		$data1 = array('encode'=>$encode); //, 'action'=>$action, 'crop_id'=>$crop_id, 'registernumber'=>$registernumber 
		$this->layout='nolayout';
		$this->render('/site/servicepages/chgstatusfrm', $data1);
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
		
	}
	
	public function actionChgstatusfrmsp(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		$action = $_POST['action'];
		$crop_id = $_POST['crop_id'];
		$registernumber = $_POST['registernumber'];
		//echo "{$action},{$crop_id},{$registernumber}";
		//$match = addcslashes($eid, '%_'); // escape LIKE's special characters
		$q = new CDbCriteria( array(
    		'condition' => "crop_id = :crop_id",         // no quotes around :match
    		'params'    => array(':crop_id' => "{$crop_id}")  // Aha! Wildcards go here
		));
		$model = CropinfoTmpTb::model()->findAll($q);
	 	$encode = CJSON::encode($model);
		//echo "{$encode}";
		$data1 = array('encode'=>$encode); //, 'action'=>$action, 'crop_id'=>$crop_id, 'registernumber'=>$registernumber 
		$this->layout='nolayout';
		$this->render('/site/searchpages/chgstatusfrmsp', $data1);
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
		
	}//function
	
	public function actionChgstatusfrmsp2(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		$action = $_POST['action'];
		$crop_id = $_POST['crop_id'];
		$registernumber = $_POST['registernumber'];
		//echo "{$action},{$crop_id},{$registernumber}";
		//ค้นหาข้อมูลเดิมก่อนแก้ไข จาก EmpstateTb
		$empdm=EmpstateTb::model()->findByAttributes(array('ems_registernumber'=>$registernumber));
		$ems_email = $empdm->ems_email;
		$ems_startdate = $empdm->ems_startdate;
		$ems_numofemp = $empdm->ems_numofemp;
		$ems_totalsalary = $empdm->ems_totalsalary;
		//insert log before edit
		$levremark = "คลิกปุ่มแก้ไขข้อมูลการขึ้นทะเบียนลูกจ้างWPD_ข้อมูลเดิม" .  $registernumber . "&" . $ems_email . "&" . $ems_startdate . "&" . $ems_numofemp . "&" . $ems_totalsalary;
		$msgresult = Yii::app()->Clogevent->createlogevent($action, "BeforeEditData", "EmpstateTb", "BeforeEditEmpstateTb", $levremark);	
		//$match = addcslashes($eid, '%_'); // escape LIKE's special characters
		$q = new CDbCriteria( array(
    		'condition' => "crop_id = :crop_id",         // no quotes around :match
    		'params'    => array(':crop_id' => "{$crop_id}")  // Aha! Wildcards go here
		));
		$model = CropinfoTmpTb::model()->findAll($q);
	 	$encode = CJSON::encode($model);
		//echo "{$encode}";
		$data1 = array('encode'=>$encode); //, 'action'=>$action, 'crop_id'=>$crop_id, 'registernumber'=>$registernumber 
		$this->layout='nolayout';
		$this->render('/site/searchpages/chgstatusfrmsp2', $data1);
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
		
	}//function
	
	public function actionCallupdatestatus1(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		$action = $_POST['action'];
		$crop_id = $_POST['crop_id'];
		$registernumber = $_POST['registernumber'];
		$d1 = $_POST['d1']; //วันที่มีลูกจ้าง
		$e1 = $_POST['e1']; //email ติดต่อกลับ
		$accno = $_POST['accno']; //เลขประกันสังคม 10 หลัก
		$accbranch = $_POST['accbranch']; //เลขสาขา 6 หลัก
		$numemp1 = $_POST['numemp1'];
		$numemp2 = $_POST['numemp2'];
		
		$d1d = date_create($d1)->format('d');
		$d1m = date_create($d1)->format('m');
		$d1y = date_create($d1)->format('Y')-543;
		$d1t = date_create($d1)->format('H:i:s');
		$d1f1 = $d1y . "-" . $d1m . "-" . $d1d . " " . $d1t;
		//$datedbd2 = date_create('2019-02-04T23:59:59+07:00')->format('Y-m-d H:i:s');
		$d1f = date_create($d1f1)->format('Y-m-d H:i:s');
		
		if($e1==""){
			$e1 ="-";	
		}
		if(!$e1){
			$e1 ="-";
		}
		if(Yii::app()->user->username){
			$username = Yii::app()->user->username;
		}else{
			$username = "sys";
		}
		//echo "{$action},{$crop_id},{$registernumber}, {$d1f}, {$e1}, {$accno}, {$accbranch} <br>"
		
	//ค้นหา status ใน cropinfo_tmp ก่อนว่าเป็น A หรือไม่ --------------------------------------------------------------------
	$cit=CropinfoTmpTb::model()->findByAttributes(array('registernumber'=>$registernumber));
	$crop_remark = $cit->crop_remark;	//A
	$crop_status = $cit->crop_status; //4
	
	if($crop_remark!='A'){
		
		$qems = new CDbCriteria( array(
			'condition' => "ems_registernumber = :ems_registernumber ",         
			'params'    => array(':ems_registernumber' => $registernumber)  
		));
		$mems = EmpstateTb::model()->findAll($qems);
		$cems = count($mems);
		if($cems==0){
			$EmpstateTb = new EmpstateTb();
			 $EmpstateTb->ems_registernumber = $registernumber;
			 $EmpstateTb->ems_accno = $accno;
			 $EmpstateTb->ems_accbran = $accbranch;
			 $EmpstateTb->ems_email = $e1;
			 $EmpstateTb->ems_startdate = $d1f;
			 $EmpstateTb->ems_numofemp = $numemp1;
 			 $EmpstateTb->ems_totalsalary = $numemp2;
			 $EmpstateTb->ems_createby = $username;
			 $EmpstateTb->ems_created = date('Y-m-d H:i:s');
			 $EmpstateTb->ems_updateby = $username;
			 $EmpstateTb->ems_modified = date('Y-m-d H:i:s');
			 $EmpstateTb->ems_remark = "-";
			 $EmpstateTb->ems_status = 1;
			 if($EmpstateTb->save()){
				  $msg = "add data is success";
				  //***** update CropinfoTmpTb ***************************
				  $ucif = CropinfoTmpTb::model()->findBySQL('SELECT * FROM cropinfo_tmp_tb WHERE crop_id =' . $crop_id . ' AND registernumber =' . $registernumber);
				  	$ucif->crop_updateby = $username;
 					$ucif->crop_updatetime = date('Y-m-d H:i:s');
					$ucif->crop_remark = "B";
					$ucif->crop_status = 3;
					if($ucif->save()){
						$msg2 = "update data cropinfo is success.";
						//update status crop_v_bran
						$cropid = $crop_id;
						$registernumber = $registernumber;
						Yii::app()->Cwpdreport->updatetob($cropid, $registernumber);
						
						//********* update accnumber_tb *******************
						$anb=AccnumberTb::model()->findByAttributes(array('acc_no'=>$accno, 'acc_regis_no'=>$registernumber));
						$anb->acc_updateby = $username;
						$anb->acc_modified = date('Y-m-d H:i:s');
						$anb->acc_remark = "B";
						$anb->acc_status = 3;
						if($anb->save()){
							$msg3 = "update data is success.";
						}else{
							$msg3 = "can't update data.";
						}
						echo preg_replace("/\xEF\xBB\xBF/", "",CJSON::encode(array('status' => 'success')));
					}else{
						$msg2 = $ucif->getErrors();
						echo preg_replace("/\xEF\xBB\xBF/", "",CJSON::encode(array('status' => 'error')));
					}
					$levremark = "ปรับปรุงสถานะนิติบุคคลเป็นB&เพิ่มข้อมูลสถานนิติบุคคล" . $crop_id . "&" . $registernumber . "&" . $accno . "&" . $e1;
					$msgresult = Yii::app()->Clogevent->createlogevent("Update", "UpdateStatusPage", "UpdatestatustoB", "CropInfo&Empstate", $levremark);	
			  }else{
				  $msg = $EmpstateTb->getErrors();
				  echo preg_replace("/\xEF\xBB\xBF/", "",CJSON::encode(array('status' => 'error')));
			  }
			 
		}//if($cems==0){
		
	}else{//if($crop_remark!='A')
		echo preg_replace("/\xEF\xBB\xBF/", "",CJSON::encode(array('status' => 'success')));
	}//if($crop_remark!='A')
		
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}//function
	
	
	public function actionCallupdatestatus2(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		
		$action = $_POST['action'];
		$crop_id = $_POST['crop_id'];
		$registernumber = $_POST['registernumber'];
		$d1 = $_POST['d1']; //วันที่มีลูกจ้าง
		$e1 = $_POST['e1']; //email ติดต่อกลับ
		$accno = $_POST['accno']; //เลขประกันสังคม 10 หลัก
		$accbranch = $_POST['accbranch']; //เลขสาขา 6 หลัก
		$numemp1 = $_POST['numemp1'];
		$numemp2 = $_POST['numemp2'];
		
		$d1d = date_create($d1)->format('d');
		$d1m = date_create($d1)->format('m');
		$d1y = date_create($d1)->format('Y')-543;
		$d1t = date_create($d1)->format('H:i:s');
		$d1f1 = $d1y . "-" . $d1m . "-" . $d1d . " " . $d1t;
		//$datedbd2 = date_create('2019-02-04T23:59:59+07:00')->format('Y-m-d H:i:s');
		$d1f = date_create($d1f1)->format('Y-m-d H:i:s');
		
		//echo "{$action},{$crop_id},{$registernumber}, {$d1}, {$e1}, {$accno}, {$accbranch}, {$numemp1}, {$numemp2}, {$d1f}";
		
		
		if($e1==""){
			$e1 ="-";	
		}
		if(!$e1){
			$e1 ="-";
		}
		if(Yii::app()->user->username){
			$username = Yii::app()->user->username;
		}else{
			$username = "sys";
		}
		
		//update data to EmpstateTb
		$mempst = EmpstateTb::model()->findByAttributes(array('ems_registernumber'=>$registernumber)); //, 
		if($mempst){
			$mempst->ems_email = $e1;
			$mempst->ems_startdate = $d1f;
			$mempst->ems_numofemp = $numemp1;
			$mempst->ems_totalsalary = $numemp2;
			$mempst->ems_updateby = Yii::app()->user->username;
			$mempst->ems_modified = date('Y-m-d H:i:s');
			if($mempst->save()){
				$msg2 = "Update is Success";
				$levremark = "แก้ไขสถานะนิติบุคคลกรณีบันทึกครั้งแรกผิด" . $crop_id . "&" . $registernumber . "&" . $accno . "&" . $e1 . "&" . $d1f . "&" . $numemp1 . "&" . $numemp2;
				$msgresult = Yii::app()->Clogevent->createlogevent("Update", "AfterEdit", "AfterEditEmpState", "AfterEditEmpstate", $levremark);
				echo preg_replace("/\xEF\xBB\xBF/", "",CJSON::encode(array('status' => 'success')));
			}else{
				$msg2 = $mrc->getErrors();
				echo preg_replace("/\xEF\xBB\xBF/", "",CJSON::encode(array('status' => 'error')));
			}//if  
		}//if
		
	
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}//function

	
	
	public function actionCallschstatusp(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		$bgdatep = $_POST['bgdatep'];
		$eddatep = $_POST['eddatep'];
		$newdap = $_POST['newdap'];
		$updap = $_POST['updap'];
		//echo 'P-' . $bgdatep . ',' . $eddatep . ',' . $newdap . ',' . $updap;
		$data1 = array('bgdatep' => $bgdatep, 'eddatep' => $eddatep, 'newdap' => $newdap, 'updap' => $updap);
		$this->layout='nolayout';
		//$this->render('/site/servicepages/callaspservice');
		$this->render('/site/servicepages/schstatusp', $data1);
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}
	
	public function actionCallschstatusb(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		$bgdatep = $_POST['bgdatep'];
		$eddatep = $_POST['eddatep'];
		$newdap = $_POST['newdap'];
		$updap = $_POST['updap'];
		//echo 'B-' . $bgdatep . ',' . $eddatep . ',' . $newdap . ',' . $updap;
		$data1 = array('bgdatep' => $bgdatep, 'eddatep' => $eddatep, 'newdap' => $newdap, 'updap' => $updap);
		$this->layout='nolayout';
		//$this->render('/site/servicepages/callaspservice');
		$this->render('/site/servicepages/schstatusb', $data1);
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}
	
	public function actionCallschstatusa(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		$bgdatep = $_POST['bgdatep'];
		$eddatep = $_POST['eddatep'];
		$newdap = $_POST['newdap'];
		$updap = $_POST['updap'];
		//echo 'A-' . $bgdatep . ',' . $eddatep . ',' . $newdap . ',' . $updap;
		$data1 = array('bgdatep' => $bgdatep, 'eddatep' => $eddatep, 'newdap' => $newdap, 'updap' => $updap);
		$this->layout='nolayout';
		//$this->render('/site/servicepages/callaspservice');
		$this->render('/site/servicepages/schstatusa', $data1);
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}
	
	public function actionCallgentextfile(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		$action = $_POST['action'];
		$statusgt = $_POST['statusgt'];
		//echo "{$action},{$statusgt}";
		$data1 = array('action' => $action, 'statusgt' => $statusgt);
		$this->layout='nolayout';
		$this->render('/site/servicepages/gentextfile', $data1);
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}//function
	
	public function actionCallgentextfileauto(){
		
		$action = $_POST['action'];
		$statusgt = $_POST['statusgt'];
		//echo "{$action},{$statusgt}";
		$data1 = array('action' => $action, 'statusgt' => $statusgt);
		$this->layout='nolayout';
		$this->render('/site/servicepages/gentextfileauto', $data1);
		
	}//function
	
	public function actionCallschbydate(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		$bgdatep = $_POST['bgdatep'];
		$eddatep = $_POST['eddatep'];
		$newdap = $_POST['newdap'];
		$updap = $_POST['updap'];
		//echo 'ส่งข้อมูลสำเร็จ.' . $bgdatep . ',' . $eddatep . ',' . $newdap . ',' . $updap;
		$levremark = "ค้นหาข้อมูลนิติบุคคลตามวันที่:" . $bgdatep . "&" . $eddatep . "&" . $eddatep . "&" . $newdap . "&" . $updap ;
		$msgresult = Yii::app()->Clogevent->createlogevent("Search", "SearchByDate", "Search", "CropInfo", $levremark);
		$data1 = array('bgdatep' => $bgdatep, 'eddatep' => $eddatep, 'newdap' => $newdap, 'updap' => $updap);
		$this->layout='nolayout';
		$this->render('/site/searchpages/schbydate', $data1);
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}
	
	public function actionCallschbyinfo(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		if(Yii::app()->user->username){
	  		$username = Yii::app()->user->username;
  		}else{
	  		$username = "sys";
  		}
		
		$action = $_POST['action'];
		$schtxt = $_POST['schtxt'];
		$seltxt = $_POST['seltxt'];
		//echo "{$action},{$schtxt},{$seltxt}";
		
		$levremark = "ค้นหาข้อมูลนิติบุคคลด้วย:" . $seltxt . "&" . $schtxt ;
		$msgresult = Yii::app()->Clogevent->createlogevent("Search", "SearchByInfo", "Search", "CropInfo", $levremark);
		
		$data1 = array('action' => $action, 'schtxt' => $schtxt, 'seltxt' => $seltxt);
		$this->layout='nolayout';
		$this->render('/site/searchpages/schbyinfo', $data1);
		
		//ค้นหาข้อมุลในฐานข้อมูล WPD ก่อนว่ามีหรือไม่
		/*if($seltxt == "2"){
			//echo "{$action},{$schtxt},{$seltxt} <br>";
			$qwpd = new CDbCriteria( array(
				'condition' => "registernumber = :schtxt ",         
				'params'    => array(':schtxt' => "{$schtxt}")  
			));
			$modelwpd = CropinfoTmpTb::model()->findAll($qwpd);
			$countwpd = count($modelwpd);
			//echo "{$countwpd} <br>";
			if($countwpd == 0){ 
				//echo "not have data in wpd.";	
				//เรียกใช้ web service dbd รายตัว
				Yii::app()->CCropinfo_tmp->registernumber = $schtxt; //กำหนดค่าให้ property in class
				Yii::app()->CCropinfo_tmp->username = $username; 
				Yii::app()->CCropinfo_tmp->GetinfoByRN(); //call dbd webservice methode
				Yii::app()->CCropinfo_tmp->GenSsoNumber(); //call genssonumber method
				
				$data1 = array('action' => $action, 'schtxt' => $schtxt, 'seltxt' => $seltxt);
				$this->layout='nolayout';
				$this->render('/site/searchpages/schbyinfo', $data1);
				
			}else{
				$data1 = array('action' => $action, 'schtxt' => $schtxt, 'seltxt' => $seltxt);
				$this->layout='nolayout';
				$this->render('/site/searchpages/schbyinfo', $data1);
			}
		}else{
			$data1 = array('action' => $action, 'schtxt' => $schtxt, 'seltxt' => $seltxt);
			$this->layout='nolayout';
			$this->render('/site/searchpages/schbyinfo', $data1);
		}*/
		
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
		
	}
	
	public function actionCallschinfodbd(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		if(Yii::app()->user->username){
	  		$username = Yii::app()->user->username;
  		}else{
	  		$username = "sys";
  		}
		$action = $_POST['action'];
		$schtxt = $_POST['schtxt'];
		$seltxt = $_POST['seltxt'];
		//echo "{$action},{$schtxt},{$seltxt},{$username}";
		$levremark = "search DBD :" . $seltxt . "&" . $schtxt ;
		$msgresult = Yii::app()->Clogevent->createlogevent("Search", "SearchByInfo", "Search", "CropInfo", $levremark);
		Yii::app()->CCropinfo_tmp->registernumber = $schtxt; //กำหนดค่าให้ property in class
		Yii::app()->CCropinfo_tmp->username = $username; 
		//$dbddata = Yii::app()->CCropinfo_tmp->Getinfofrmdbd(); //ดึง xml data จาก dbd
		$dbddata = Yii::app()->CCropinfo_tmp->GetinfofrmdbdV5();
		$data1 = array('action' => $action, 'schtxt' => $schtxt, 'seltxt' => $seltxt, 'dbddata' => $dbddata);
		$this->layout='nolayout';
		$this->render('/site/searchpages/schinfofrmdbd', $data1);
		
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
		
	}
	
	public function actionCallschandsavecropinfo(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
			if(Yii::app()->user->username){
				$username = Yii::app()->user->username;
			}else{
				$username = "sys";
			}
			
			$action = $_POST['action'];
			$schtxt = $_POST['schtxt'];
			$seltxt = $_POST['seltxt'];
			//echo "{$action},{$schtxt},{$seltxt}";
			//ค้นหาข้อมุลในฐานข้อมูล WPD ก่อนว่ามีหรือไม่
			if($seltxt == "2"){
				//echo "{$action},{$schtxt},{$seltxt} <br>";
				$qwpd = new CDbCriteria( array(
					'condition' => "registernumber = :schtxt ",         
					'params'    => array(':schtxt' => "{$schtxt}")  
				));
				$modelwpd = CropinfoTmpTb::model()->findAll($qwpd);
				$countwpd = count($modelwpd);
				//echo "{$countwpd} <br>";
				if($countwpd == 0){ //กรณีที่ยังไม่มีสถานประกอบการนั้นอยู่ในระบบ wpd
				
					//เริ่มกำหนด transection
					$transaction = Yii::app()->db->beginTransaction();
						
					try {
						
					  //เรียกใช้ web service dbd รายตัว
					  Yii::app()->CCropinfo_tmp->registernumber = $schtxt; //กำหนดค่าให้ property in class
					  Yii::app()->CCropinfo_tmp->username = $username; 
					  Yii::app()->CCropinfo_tmp->GetinfoByRN(); //call dbd webservice methode ดึงข้อมูลใหม่จาก DBD
					  Yii::app()->CCropinfo_tmp->GenSsoNumber(); //call genssonumber method สร้างเลข 10 หลักประกันสังคม
					  
					  $transaction->commit(); //ถ้าทำงานผ่า่นทุกฟังก์ชั่น
					  
					  $levremark = "insert data from DBD and gen acc_no : " . $schtxt ;
					  $msgresult = Yii::app()->Clogevent->createlogevent("Insert", "Cropinfo_tmp", "InsertByUser", "CropInfo", $levremark);
					  
					  echo "บันทึกข้อมูลสถานประกอบการ {$schtxt} เพิ่มเติมใน WPD เรียบร้อยแล้ว.";
					  
					} catch (\Exception $e) {
						$transaction->rollBack();
        				throw $e;
						echo "ไม่สามารถบันทึกข้อมูลได้ เนื่องจากเกิดข้อผิดพลาดในการประมวลผลของระบบ กรุณาติดต่อผู้ดูแลระบบ !";
					}//try
				}else{ //กรณีที่มีข้อมูลสถานประกอบการอยุ่แล้ว
					$transaction = Yii::app()->db->beginTransaction();
					try {
						
						Yii::app()->CCropinfo_tmp->registernumber = $schtxt;
					  	Yii::app()->CCropinfo_tmp->username = $username; 
						
						if(Yii::app()->CCropinfo_tmp->BackupBrn()){ //backup สาขาสำนักงานใหญ่
					    	echo "บันทึกปรับปรุงข้อมูลสถานประกอบการ {$schtxt} เรียบร้อยแล้ว.";
						}else{
							echo "ไม่สามารถ ปรับปรุงข้อมูลสถานประกอบการ {$schtxt} !";
						}
						Yii::app()->CCropinfo_tmp->UpdateBrn(); //update ที่ตั้งสำนักงานใหญ่
						Yii::app()->CCropinfo_tmp->BackupCommittee(); //backup committee
						Yii::app()->CCropinfo_tmp->UpdateCommittee(); //update committee
						
						
						Yii::app()->CGenAccNo->registernumber = $schtxt;
						Yii::app()->CGenAccNo->CheckAndGenAccno(); //เรียกใช้ฟังก์ชั่น ตรวจสอบและ gen เลข 10 หลักใหม่
						
						
						$transaction->commit();
						
						
						$levremark = "update data bran & comittee from DBD : " . $schtxt ;
					  	$msgresult = Yii::app()->Clogevent->createlogevent("Update", "bran_committee", "UpdateByUser", "branandcommitee", $levremark);
						
					} catch (\Exception $e) {
						$transaction->rollBack();
        				throw $e;
						echo "มีข้อมูลสถานประกอบการ เลขที่นิติบุคคล {$schtxt} <br> อยู่ในระบบแล้ว ไม่สามารถบันทึกซ้ำได้ !";	
					}//try
				}
			}else{
				echo "ไม่สามารถบันทึกข้อมูลได้ เนื่องจากเกิดข้อผิดพลาด กรุณาติดต่อผู้ดูแลระบบ !";
			}
			//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}//function
	
	public function actionSchdetailfrm(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		$action = $_POST['action'];
		$crop_id = $_POST['crop_id'];
		$registernumber = $_POST['registernumber'];
		//echo "{$action},{$crop_id},{$registernumber}";
		$data1 = array('action' => $action, 'crop_id' => $crop_id, 'registernumber' => $registernumber);
		$this->layout='nolayout';
		$this->render('/site/searchpages/schdetailfrm', $data1);
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}
	
	public function actionCallshowtextfile(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		$action = $_POST['action'];
		//echo "{$action}";
		$data1 = array('action' => $action);
		$this->layout='nolayout';
		$this->render('/site/servicepages/showtextfile', $data1);
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}
	
	public function actionCallusergroupfrm(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		$action = $_POST['action'];
		$usgid = $_POST['usgid'];
		$data1 = array('action' => $action, 'usgid' => $usgid);
		$this->layout='nolayout';
		$this->render('/site/adminpages/usergroupfrm', $data1);
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}
	
	public function actionCallusergroup(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		$action = $_POST['action'];
		//echo "{$action}";
		$data1 = array('action' => $action);
		$this->layout='nolayout';
		$this->render('/site/adminpages/usergroup', $data1);
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}
	
	public function actionCalladdusg(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		$action = $_POST['action'];
		$ug_name = $_POST['ustxt1'];
		$ug_remark = $_POST['ustxt2'];
 		$ug_createby = "sys";
 		$ug_created = date('Y-m-d H:i:s');
		$ug_updateby = "sys";
		$ug_modified = date('Y-m-d H:i:s');
		$ug_status = 1;
		//echo "{$action},{$action},{$ug_remark}";
		$q = new CDbCriteria( array(
					'condition' => "ug_name = :ug_name ",         
					'params'    => array(':ug_name' => $ug_name)  
		));
		$musg = UsergroupTb::model()->findAll($q);
		$countusg = count($musg);
		if($countusg==0){
			$UsergroupTb = new UsergroupTb();
			$UsergroupTb->ug_name = $ug_name;
			$UsergroupTb->ug_remark = $ug_remark;
 			$UsergroupTb->ug_createby = $ug_createby;
 			$UsergroupTb->ug_created = $ug_created;
			$UsergroupTb->ug_updateby = $ug_updateby;
			$UsergroupTb->ug_modified = $ug_modified;
			$UsergroupTb->ug_status = $ug_status;
			if($UsergroupTb->save()){
				//actionCallusergroup();
				//echo "y";
				echo preg_replace("/\xEF\xBB\xBF/", "",CJSON::encode(array('status' => 'success')));
			}else{
				//echo "n";
				echo preg_replace("/\xEF\xBB\xBF/", "",CJSON::encode(array('status' => 'error')));
			}
		}else{//if($countusg==0)
			//echo "d";
			echo preg_replace("/\xEF\xBB\xBF/", "",CJSON::encode(array('status' => 'errordup')));
		}
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}//actionCalladdusg()
	
	public function actionCallchgusg(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		$udid = $_POST['udid'];
		$action = $_POST['action'];
		$ug_name = $_POST['ustxt1'];
		$ug_remark = $_POST['ustxt2'];
		$ug_updateby = "sys";
		$ug_modified = date('Y-m-d H:i:s');
		$ug_status = 1;
		//echo "{$action},{$udid}, {$ug_name}, {$ug_remark}";
		//echo CJSON::encode(array('status' => 'success'));
		$updateusg = UsergroupTb::model()->findByPk($udid);
		$updateusg->ug_name = $ug_name;
		$updateusg->ug_remark = $ug_remark;
		$updateusg->ug_updateby = $ug_updateby;
		$updateusg->ug_modified = $ug_modified;
		if($updateusg->save()){
			echo preg_replace("/\xEF\xBB\xBF/", "",CJSON::encode(array('status' => 'success')));
		}else{
			echo preg_replace("/\xEF\xBB\xBF/", "",CJSON::encode(array('status' => 'error')));
		}
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
		
	}
	
	public function actionCalldelusg(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		$action = $_POST['action'];
		$deid = $_POST['deid'];
		$dename = $_POST['dename'];
		//echo "{$action},{$deid}, {$dename}";
		try{
		   $deleteusg = UsergroupTb::model()->findByPk($deid);
		   $deleteusg->delete();
		   echo preg_replace("/\xEF\xBB\xBF/", "",CJSON::encode(array('status' => 'success')));
		}catch (Exception $e){
		   echo preg_replace("/\xEF\xBB\xBF/", "",CJSON::encode(array('status' => 'error'))); 
		}
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}
	
	public function actionCalluserall(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		$action = $_POST['action'];
		//echo "{$action}";
		$data1 = array('action' => $action);
		$this->layout='nolayout';
		$this->render('/site/adminpages/userall', $data1);
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}
	
	public function actionCallusafrm(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		$action = $_POST['action'];
		$usaid = $_POST['usaid'];
		$data1 = array('action' => $action, 'usaid' => $usaid);
		$this->layout='nolayout';
		$this->render('/site/adminpages/userfrm', $data1);
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}
	
	public function actionCalladdusa(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
 		 $firstname = $_POST['usatxt1'];
		 $lastname = $_POST['usatxt2'];
		 $email = $_POST['usatxt5'];
		 $contact_number = $_POST['usatxt6'];
		 $address = $_POST['usatxt7'];
		 $username = $_POST['usatxt3'];
		 $password = $_POST['usatxt4'];
		 $access_level = $_POST['usatxt9'];
		 $access_code = $_POST['usatxt8'];
		 $status = 1;
		 $image = "-";
		 $created = date('Y-m-d H:i:s');
		 $modified = date('Y-m-d H:i:s');
		 //echo "{$firstname}, {$lastname}, {$email}, {$contact_number}, {$address}, {$username}, {$password}, {$access_level}, {$access_code}, {$status}, {$image}, {$created}, {$modified}";
		 $q = new CDbCriteria( array(
			'condition' => "username = :username ",         
			'params'    => array(':username' => $username)  
		 ));
		 $susa = Users::model()->findAll($q);
		 $countusa = count($susa);
		 if($countusa==0){
		 	$Users = new Users();
		    $Users->firstname = $firstname;
		    $Users->lastname = $lastname;
		    $Users->email = $email;
		    $Users->contact_number = $contact_number;
		    $Users->address = $address;
		    $Users->username = $username;
		    $Users->password = $password;
		    $Users->access_level = $access_level;
		    $Users->access_code = $access_code;
		    $Users->status = $status;
		    $Users->image = $image;
		    $Users->created = $created;
		    $Users->modified = $modified;
			if($Users->save()){
				echo preg_replace("/\xEF\xBB\xBF/", "",CJSON::encode(array('status' => 'success')));
			}else{
				echo preg_replace("/\xEF\xBB\xBF/", "",CJSON::encode(array('status' => 'error')));
				//echo CJSON::encode($Users->getErrors());
			}
		 }else{//if($countusg==0)
			echo preg_replace("/\xEF\xBB\xBF/", "",CJSON::encode(array('status' => 'errordup')));
		}
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}
	
	public function actionCallchgusa(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		$udid = $_POST['udid'];
		$action = $_POST['action'];
		$firstname = $_POST['usatxt1'];
		$lastname = $_POST['usatxt2'];
		$email = $_POST['usatxt5'];
		$contact_number = $_POST['usatxt6'];
		$username = $_POST['usatxt3'];
		$password = $_POST['usatxt4'];
		$address = $_POST['usatxt7'];
		$access_level = $_POST['usatxt9'];
		$access_code = $_POST['usatxt8'];
		$modified = date('Y-m-d H:i:s');
		//echo "{$firstname}, {$lastname}, {$email}, {$contact_number}, {$username}, {$password}, {$address}, {$access_level}, {$access_code}"; exit;
		//echo CJSON::encode(array('status' => 'success'));
		$updateusa = Users::model()->findByPk($udid);
		
		$updateusa->firstname = $firstname;
		$updateusa->lastname = $lastname;
		$updateusa->email = $email;
		$updateusa->contact_number = $contact_number;
		$updateusa->address = $address;
		$updateusa->username = $username;
		$updateusa->password = $password;
		$updateusa->access_level = $access_level;
		$updateusa->access_code = $access_code;
		$updateusa->modified = $modified;
		
		if($updateusa->save()){
			echo preg_replace("/\xEF\xBB\xBF/", "",CJSON::encode(array('status' => 'success')));
		}else{
			echo preg_replace("/\xEF\xBB\xBF/", "",CJSON::encode(array('status' => 'error')));
			//echo CJSON::encode($updateusa->getErrors());
		}
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}
	
	public function actionCalldelusa(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		$action = $_POST['action'];
		$deid = $_POST['deid'];
		$dename = $_POST['dename'];
		//echo "{$action},{$deid}, {$dename}";
		try{
		   $deleteusa = Users::model()->findByPk($deid);
		   $deleteusa->delete();
		   echo preg_replace("/\xEF\xBB\xBF/", "",CJSON::encode(array('status' => 'success')));
		}catch (Exception $e){
		   echo preg_replace("/\xEF\xBB\xBF/", "",CJSON::encode(array('status' => 'error'))); 
		}
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}
	
	public function actionCreatelogevent(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		$action = $_POST['action'];
		$msgresult = Yii::app()->Clogevent->createlogevent("testadd", "tPage", "tCause", "tData", "tRemark");
		echo preg_replace("/\xEF\xBB\xBF/", "","{$action}, {$msgresult}");
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}
	
	public function actionCalluploadfile(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		if(Yii::app()->user->username){
			$username = Yii::app()->user->username;
		}else{
			$username = "sys";
		}
		/*
		$action = $_POST['action'];
		$tfid = $_POST['tfid'];
		//echo "{$action},{$tfid} <br>";
		//$sqlstring = "SELECT * FROM gentextfile_tb WHERE gtf_id =" . $tfid;
		//$getpathfile = GentextfileTb::model()->findBySQL($sqlstring);
		$getpathfile = GentextfileTb::model()->findByPk($tfid);
		$gtf_name = $getpathfile->gtf_name;
		$gtf_path = $getpathfile->gtf_path;
		//echo "{$action},{$tfid}, {$gtf_name}, {$gtf_path} <br>";
		Yii::app()->Cgentextfile->gtf_name = $gtf_name;
		Yii::app()->Cgentextfile->gtf_path = $gtf_path;
		$uploadftxt = Yii::app()->Cgentextfile->uploadtf();
		//echo "{$uploadftxt}";
		if($uploadftxt=='Y'){
			$updattf = GentextfileTb::model()->findByPk($tfid);
			$updattf->gtf_statusupload = "y";
			$updattf->gtf_updateby = $username;
 			$updattf->gtf_modified = date('Y-m-d H:i:s');
			if($updattf->save()){
				$levremark = "uploadtextfiletosftpserver:" . $tfid . "&" . $gtf_name . "&" . $gtf_path;
				$msgresult = Yii::app()->Clogevent->createlogevent("Upload", "UploadfiltToSFTP", "Upload", "gentextfiletb", $levremark);
				echo preg_replace("/\xEF\xBB\xBF/", "",CJSON::encode(array('status' => 'success')));
			}else{
				echo preg_replace("/\xEF\xBB\xBF/", "",CJSON::encode(array('status' => 'error')));
			}
		}else{
			 echo preg_replace("/\xEF\xBB\xBF/", "",CJSON::encode(array('status' => 'error')));
		}
		*/
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
		
	}
	
	public function actionShowfile(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		$action = $_POST['action'];
		//echo "{$action}";
		$data1 = array('action' => $action);
		$this->layout='nolayout';
		$this->render('/site/servicepages/showallfile', $data1);
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}
	
	public function actionCalldbdbyrn(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		$action = $_POST['action'];
		//echo "{$action}";	
		$data1 = array('action' => $action);
		$this->layout='nolayout';
		$this->render('/site/servicepages/calldbdbyrn',$data1);
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}
	
	public function actionCalladdaccno(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		$action = $_POST['action'];
		echo "{$action} <br>";	
		//****** insert accnumber_tb ****************************************
			$intsdata = new AccnumberTb();
			
			$intsdata->acc_no = "-";
		   	$intsdata->acc_bran = "-";
		  	$intsdata->acc_regis_no = "-";
		   	$intsdata->acc_active_flag = "-";
		   	$intsdata->acc_using_date = "";
		   	$intsdata->acc_createby = "sys";
		   	$intsdata->acc_created = "";
		   	$intsdata->acc_updateby = "sys";
		   	$intsdata->acc_modified = "";
		   	$intsdata->acc_remark = "-";
		   	$intsdata->acc_status = 1;
			
			if($intsdata->save()){
				//echo CJSON::encode(array('status' => 'success'));
				echo preg_replace("/\xEF\xBB\xBF/", "","yes <br>");
			}else{
				//echo CJSON::encode(array('status' => 'error'));
				//echo CJSON::encode($Users->getErrors());
				echo preg_replace("/\xEF\xBB\xBF/", "","no <br>");
			}
		//*********************************************************
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}
	
	public function actionCallshowrpt(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		$action = $_POST['action'];
		//echo "{$action} <br>";
		$data1 = array('action' => $action);
		$this->layout='nolayout';
		$this->render('/site/reportpages/printformexcel2', $data1);
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
		
	}
	
	public function actionCallsubrpt(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		$action = $_POST['action'];
		$slv = $_POST['slv'];
		//echo "{$action}, {$slv} <br>";
		$data1 = array('action' => $action, 'slv' => $slv);
		$this->layout='nolayout';
		$this->render('/site/reportpages/reportpage1', $data1);
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}
	
	public function actionCallshowrpt1(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		$this->layout='nolayout';
		$this->render('/site/reportpages/printformexcel2');
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}
	
	public function actionCallshowrptled31(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		if(Yii::app()->user->address){
 			$user_bc = Yii::app()->user->address;
		}
		
		if($user_bc=='1050'){
			$bctid="1";
		}else{
			//ค้นหาประเภทของ barch_code
			$bct=MasSsobranch::model()->findByAttributes(array('ssobranch_code'=>$user_bc));
			$bctid = $bct->ssobranch_type_id;
		}
		//echo $bctid;exit;
		$data1 = array('bc' => $user_bc, 'bct' => $bctid);
		$this->layout='nolayout';
		$this->pageTitle='WPD - Report ';
		$this->render('/site/reportpages/reportled31', $data1);
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}
	
	public function actionCallsubrptled31(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		$action = $_POST['action'];
		$d1 = $_POST['d1'];
		$d2 = $_POST['d2'];
		$sso1 = $_POST['sso1'];
		$bct = $_POST['bct'];
		$bc = $_POST['bc'];
		//ค้นหาชื่อ สปส รับผิดชอบ
		if($sso1=='0'){
			$sso1t="ทั่วประเทศ";
		}else if($sso1=='1050'){
			$sso1t="สำนักบริหารเทคโนโลยีสารสนเทศ";
		}else{
			$bcr=MasSsobranch::model()->findByAttributes(array('ssobranch_code'=>$sso1));
			$bcn = $bcr->name;	
			$sso1t = $bcn;
		}
		
		$data1 = array('action'=>$action,'d1'=>$d1,'d2'=>$d2,'sso1'=>$sso1,'bct'=>$bct,'bc'=>$bc,'sso1t'=>$sso1t);
		$this->layout='nolayout';
		$this->pageTitle='report - ' . $sso1t;
		$this->render('/site/reportpages/reportsled31sub', $data1);
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}
	
	public function actionCallshowrptled32(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		$ssobranch_code = $_GET['ssobranch_code'];
		//$d1 = $_GET['d1'];
		//$d2 = $_GET['d2'];
		//echo "{$ssobranch_code}";exit;
		//ค้นหาชื่อ สปส รับผิดชอบ
		if($ssobranch_code=='0'){
			$ssobranch_codet="ทั่วประเทศ";
		}else if($ssobranch_code=='1050'){
			$ssobranch_codet="สำนักบริหารเทคโนโลยีสารสนเทศ";
		}else{
			$bcr=MasSsobranch::model()->findByAttributes(array('ssobranch_code'=>$ssobranch_code));
			$bcn = $bcr->name;	
			$ssobranch_codet = $bcn;
		}
		
		$data1 = array('ssobranch_code'=>$ssobranch_code, 'ssobranch_codet' => $ssobranch_codet);
		$this->layout='nolayout';
 	    $this->pageTitle='report - LED';
		$this->render('/site/reportpages/reportsled32sub', $data1);
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}
	
	public function actionCallshowrpt31(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		if(Yii::app()->user->address){
 			$user_bc = Yii::app()->user->address;
		}
		
		if($user_bc=='1050'){
			$bctid="1";
		}else{
			//ค้นหาประเภทของ barch_code
			$bct=MasSsobranch::model()->findByAttributes(array('ssobranch_code'=>$user_bc));
			$bctid = $bct->ssobranch_type_id;
		}
		//echo $bctid;exit;
		$data1 = array('bc' => $user_bc, 'bct' => $bctid);
		$this->layout='nolayout';
		$this->pageTitle='WPD - Report ';
		$this->render('/site/reportpages/report31', $data1);
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}
	
	public function actionCallsubrpt31(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		$action = $_POST['action'];
		$d1 = $_POST['d1'];
		$d2 = $_POST['d2'];
		$sso1 = $_POST['sso1'];
		$bct = $_POST['bct'];
		$bc = $_POST['bc'];
		
		//formatdate
		$d1d = date_create($d1)->format('d');
		$d1m = date_create($d1)->format('m');
		$d1y = date_create($d1)->format('Y'); //-543;
		//$d1t = date_create($d1)->format('H:i:s');
		$d1f1 = $d1y . "-" . $d1m . "-" . $d1d; // " " . $d1t;
		//$datedbd2 = date_create('2019-02-04T23:59:59+07:00')->format('Y-m-d H:i:s');
		$d1 = date_create($d1f1)->format('Y-m-d');
		
		//formatdate
		$d2d = date_create($d2)->format('d');
		$d2m = date_create($d2)->format('m');
		$d2y = date_create($d2)->format('Y'); //-543;
		//$d1t = date_create($d1)->format('H:i:s');
		$d2f2 = $d2y . "-" . $d2m . "-" . $d2d; // " " . $d1t;
		//$datedbd2 = date_create('2019-02-04T23:59:59+07:00')->format('Y-m-d H:i:s');
		$d2 = date_create($d2f2)->format('Y-m-d');
		
		//ค้นหาชื่อ สปส รับผิดชอบ
		if($sso1=='0'){
			$sso1t="ทั่วประเทศ";
		}else if($sso1=='1050'){
			$sso1t="สำนักบริหารเทคโนโลยีสารสนเทศ";
		}else{
			$bcr=MasSsobranch::model()->findByAttributes(array('ssobranch_code'=>$sso1));
			$bcn = $bcr->name;	
			$sso1t = $bcn;
		}
		
		$data1 = array('action'=>$action,'d1'=>$d1,'d2'=>$d2,'sso1'=>$sso1,'bct'=>$bct,'bc'=>$bc,'sso1t'=>$sso1t);
		$this->layout='nolayout';
		$this->pageTitle='report - ' . $sso1t;
		$this->render('/site/reportpages/reports31sub', $data1);
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}
	
	public function actionCallshowrpt32(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		$ssobranch_code = $_GET['ssobranch_code'];
		$d1 = $_GET['d1'];
		$d2 = $_GET['d2'];
		//echo "{$ssobranch_code},{$d1},{$d2}";exit;
		//ค้นหาชื่อ สปส รับผิดชอบ
		if($ssobranch_code=='0'){
			$ssobranch_codet="ทั่วประเทศ";
		}else if($ssobranch_code=='1050'){
			$ssobranch_codet="สำนักบริหารเทคโนโลยีสารสนเทศ";
		}else{
			$bcr=MasSsobranch::model()->findByAttributes(array('ssobranch_code'=>$ssobranch_code));
			$bcn = $bcr->name;	
			$ssobranch_codet = $bcn;
		}
		
		$data1 = array('ssobranch_code'=>$ssobranch_code,'d1'=>$d1,'d2'=>$d2, 'ssobranch_codet' => $ssobranch_codet);
		$this->layout='nolayout';
 	    $this->pageTitle='report - ' . $ssobranch_codet;
		$this->render('/site/reportpages/reports32sub', $data1);
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}
	
	
	
	public function actionCallcripvbran(){ //insert crop_v_bran เมื่อ ดึงข้อมูลจาก dbd มาลงฐานข้อมูล
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		$action = $_POST['action'];
		$m = $_POST['m'];
		//echo "{$action}, {$m} <br>";
		$cropid = 3404;
		$registernumber = "0605562001211";
		Yii::app()->Cwpdreport->createcrop_v_bran($cropid, $registernumber);
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}
	
	public function actionCallupdatetob(){ //update crop_v_bran status is b เมื่อ ขึ้นทะเบียนลูกจ้าง
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		$action = $_POST['action'];
		$m = $_POST['m'];
		//echo "{$action}, {$m} <br>";
		$cropid = 3404;
		$registernumber = "0605562001211";
		Yii::app()->Cwpdreport->updatetob($cropid, $registernumber);
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}
	
	public function actionCallupdatetoa(){ //update crop_v_bran status is a เมื่อ gen textfile ออกไปแล้ว
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		$action = $_POST['action'];
		$m = $_POST['m'];
		//echo "{$action}, {$m} <br>";
		$cropid = 3404;
		$registernumber = "0605562001211";
		Yii::app()->Cwpdreport->updatetoa($cropid, $registernumber);
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}
	
	public function actionCallgettxtdata(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		$action = $_POST['action'];
		$fn1 = $_POST['fn1']; //ชื่อ textfile 
		$minrec = $_POST['minrec'];
		//echo "{$action},{$fn1}";
		$data1 = array('action' => $action, 'fn1' => $fn1, 'minrec' => $minrec);
		$this->layout='nolayout';
		//$this->render('/site/servicepages/callaspservice');
		$this->render('/site/servicepages/gettxtdata', $data1);
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}
	
	public function actionCallajaxjson(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		/*if(isset(Yii::app()->user->username)){
	  		$username = Yii::app()->user->username;
 		}else{
	  		$username = "sys";
  		}
		
		
		$sso_accno_arr = CJSON::decode($_POST['sso_accno_arr']);
		$sso_accbran_arr = CJSON::decode($_POST['sso_accbran_arr']);
		$crg_registernum_arr = CJSON::decode($_POST['crg_registernum_arr']);
		$crg_cropname_arr = CJSON::decode($_POST['crg_cropname_arr']);
		$crg_cropaddrss_arr = CJSON::decode($_POST['crg_cropaddrss_arr']);
		$crg_brancode_arr = CJSON::decode($_POST['crg_brancode_arr']);
		
		$countarray1 = count($sso_accno_arr);
		ini_set('max_execution_time', 3600); 
		$time_start = microtime(true);
		for($i=0;$i<=$countarray1-1;$i++){
			$selq = CropRiskGroup::model()->findByAttributes(array('crg_registernum'=>$t3));
			if(empty($selq)){
			  $CropRiskGroup = new CropRiskGroup();
			  $CropRiskGroup->sso_accno = $sso_accno_arr[$i];
			  $CropRiskGroup->sso_accbran = $sso_accbran_arr[$i];
			  $CropRiskGroup->crg_registernum = $crg_registernum_arr[$i];
			  $CropRiskGroup->crg_cropname = $crg_cropname_arr[$i];
			  $CropRiskGroup->crg_cropaddrss = $crg_cropaddrss_arr[$i];
			  $CropRiskGroup->crg_brancode = $crg_brancode_arr[$i];
			  $CropRiskGroup->crg_createby = $username;
			  $CropRiskGroup->crg_created = date('Y-m-d H:i:s');
			  $CropRiskGroup->crg_updateby = $username;
			  $CropRiskGroup->crg_modified = date('Y-m-d H:i:s');
			  $CropRiskGroup->crg_remark = "-";
			  $CropRiskGroup->crg_status = 1;
			  $CropRiskGroup->save();
			}
		}
		$time_end = microtime(true);
		$execution_time = ($time_end - $time_start)/60;
		echo '<b>Total Execution Time:</b> '.$execution_time.' Mins <br>';
		*/
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}
	
	
	
	
       public function actionCallsendmail(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
			$action = $_POST['action'];
			$ema = $_POST['ema'];
			$accno = $_POST['accno'];
			$brnno = $_POST['brnno'];
			
			$msgresult = Yii::app()->Clogevent->sendmail($ema, $accno, $brnno);
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}
	
	public function actionCalluploadfiletosftp(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		if(isset(Yii::app()->user->username)){
	  		$username = Yii::app()->user->username;
 		}else{
	  		$username = "sys";
  		}
		//$time_start = microtime(true);
		
			$action = $_POST['action'];
			$gtfname = $_POST['gtfname'];
			
			$localFile = Yii::app()->Cgentextfile->localpathf . $gtfname; //'wpd25620517.txt';
			$remoteFile = Yii::app()->Cgentextfile->remotepathf . $gtfname; //'wpd25620517.txt';
			
			if(Yii::app()->Cgentextfile->getConnectionsftp()){
				$sftp = ssh2_sftp(Yii::app()->Cgentextfile->conn); 
				$contents = file_get_contents($localFile);  
				$putfile = file_put_contents("ssh2.sftp://" . intval($sftp) . "$remoteFile", $contents);	
				//echo "success";
				//echo preg_replace("/\xEF\xBB\xBF/", "","Success");
				$anb=GentextfileTb::model()->findByAttributes(array('gtf_name'=>$gtfname));
				//$anb = GentextfileTb::model()->findByPk($gtfid);
				$anb->gtf_statusupload = 'y';
				$anb->gtf_updateby = $username;
				$anb->gtf_modified = date('Y-m-d H:i:s');
				$anb->gtf_status = 2;
				if($anb->save()){
					//$msg3 = "update data is success.";
					$msgresult = Yii::app()->Clogevent->createlogevent("upload", "showtextfile", "uploadtextfiletosftp", "upload", "uploadtextfiletosftp");
					echo "Success";
				}else{
					//$msg3 = "can't update data.";
					//echo "Upload Success but Can't update status GentextfileTb.";
					echo "Failed";
				}
			}else{
				//echo "failed"; 
				echo preg_replace("/\xEF\xBB\xBF/", "","Failed");
			}
	
			
			
			//****** call wpdapi service ********************************************************
			/*
			$url = 'http://localhost/wpdapi/api/uploadfile/uploadtosftp.php?fn1=' . $gtfname ;
			
			$arrContextOptions=array(
				"http" => array(
				  "method" => "GET",
				  "header" =>
					  //"Consumer-Key: 8400dfa3-4fe3-43b9-b830-060d948d75cf", 
					  "Content-Type: application/json; charset=utf-8;\r\n".
					  "Connection: keep-alive\r\n",
					  "ignore_errors" => true,
					  "timeout" => (float)30.0,
					  //"content" => $data,
				),
				"ssl"=>array(
					"verify_peer"=>false,
					"verify_peer_name"=>false,
				),
			);  
			
			$content = file_get_contents($url, false, stream_context_create($arrContextOptions));
			
			//echo "{$content} <br>";
			
			if($content){
				//echo "Success";
				//update gentextfile_tb
				$anb=GentextfileTb::model()->findByAttributes(array('gtf_name'=>$gtfname));
				//$anb = GentextfileTb::model()->findByPk($gtfid);
				$anb->gtf_statusupload = 'y';
				$anb->gtf_updateby = $username;
				$anb->gtf_modified = date('Y-m-d H:i:s');
				$anb->gtf_status = 2;
				if($anb->save()){
					//$msg3 = "update data is success.";
					echo "Success";
				}else{
					//$msg3 = "can't update data.";
					//echo "Upload Success but Can't update status GentextfileTb.";
					echo "Failed";
				}
			}else{
				echo "Failed";
			}
			*/
		//***********************************************************************************
		//$time_end = microtime(true);
		//$execution_time = ($time_end - $time_start)/60;
		//echo '<b>timeuses:</b> '.$execution_time.' Mins <br>';	
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}
	
	public function actionCalluploadfiletosftpauto(){
		
		
	  		$username = "sys";
  		
		//$time_start = microtime(true);
		
			$action = $_POST['action'];
			$gtfname = $_POST['gtfname'];
			
			$localFile = Yii::app()->Cgentextfile->localpathf . $gtfname; //'wpd25620517.txt';
			$remoteFile = Yii::app()->Cgentextfile->remotepathf . $gtfname; //'wpd25620517.txt';
			
			if(Yii::app()->Cgentextfile->getConnectionsftp()){
				$sftp = ssh2_sftp(Yii::app()->Cgentextfile->conn); 
				$contents = file_get_contents($localFile);  
				$putfile = file_put_contents("ssh2.sftp://" . intval($sftp) . "$remoteFile", $contents);	
				//echo "success";
				//echo preg_replace("/\xEF\xBB\xBF/", "","Success");
				$anb=GentextfileTb::model()->findByAttributes(array('gtf_name'=>$gtfname));
				//$anb = GentextfileTb::model()->findByPk($gtfid);
				$anb->gtf_statusupload = 'y';
				$anb->gtf_updateby = $username;
				$anb->gtf_modified = date('Y-m-d H:i:s');
				$anb->gtf_status = 2;
				if($anb->save()){
					//$msg3 = "update data is success.";
					$msgresult = Yii::app()->Clogevent->createlogeventauto("upload", "showtextfile", "uploadtextfiletosftp", "upload", "uploadtextfiletosftp");
					echo "Success";
				}else{
					//$msg3 = "can't update data.";
					//echo "Upload Success but Can't update status GentextfileTb.";
					echo "Failed";
				}
			}else{
				//echo "failed"; 
				echo preg_replace("/\xEF\xBB\xBF/", "","Failed");
			}
			
			
			
			/*
			$url = 'http://localhost/wpdapi/api/uploadfile/uploadtosftp.php?fn1=' . $gtfname ;
			
			$arrContextOptions=array(
				"http" => array(
				  "method" => "GET",
				  "header" =>
					  //"Consumer-Key: 8400dfa3-4fe3-43b9-b830-060d948d75cf", 
					  "Content-Type: application/json; charset=utf-8;\r\n".
					  "Connection: keep-alive\r\n",
					  "ignore_errors" => true,
					  "timeout" => (float)30.0,
					  //"content" => $data,
				),
				"ssl"=>array(
					"verify_peer"=>false,
					"verify_peer_name"=>false,
				),
			);  
			
			$content = file_get_contents($url, false, stream_context_create($arrContextOptions));
			
			//echo "{$content} <br>";
			
			if($content){
				//echo "Success";
				//update gentextfile_tb
				$anb=GentextfileTb::model()->findByAttributes(array('gtf_name'=>$gtfname));
				//$anb = GentextfileTb::model()->findByPk($gtfid);
				$anb->gtf_statusupload = 'y';
				$anb->gtf_updateby = $username;
				$anb->gtf_modified = date('Y-m-d H:i:s');
				$anb->gtf_status = 2;
				if($anb->save()){
					//$msg3 = "update data is success.";
					
					echo "Success";
				}else{
					//$msg3 = "can't update data.";
					//echo "Upload Success but Can't update status GentextfileTb.";
					echo "Failed";
				}
			}else{
				echo "Failed";
			}
			*/
		
		//$time_end = microtime(true);
		//$execution_time = ($time_end - $time_start)/60;
		//echo '<b>timeuses:</b> '.$execution_time.' Mins <br>';	
	}
	
	public function actionCallupdateiden(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//******************************************************
			$action = $_POST['action'];
			$ordernum = $_POST['ordernum'];
			$regisnum = $_POST['regisnum'];
			$iden = $_POST['iden'];
			//echo "{$iden}";
			//update identity committees
			$upcomt=CommitteeTmpTb::model()->findByAttributes(array('registernumber'=>$regisnum, 'ordernumber'=>$ordernum));
			$upcomt->identity = $iden;
			$upcomt->cmit_updateby = Yii::app()->user->username;
			$upcomt->cmit_updatetime = date('Y-m-d H:i:s');
			if($upcomt->save()){
				$txt1 = 'update_identity_' . $iden;
				$msgresult = Yii::app()->Clogevent->createlogevent("update", "committee", "identity", "update", $txt1);
				echo "{$iden}";
			}else{
				echo "";
			}
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}	
	}
	
	public function actionCallupdatetsic(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//******************************************************
			$action = $_POST['action'];
			$regisnum = $_POST['regisnum'];
			$tsiccode = $_POST['tsiccode'];
			$tsicdetial = $_POST['tsicdetial'];
			//echo "{$action}, {$regisnum}, {$tsiccode}, {$tsicdetial}";
			$upcif=CropinfoTmpTb::model()->findByAttributes(array('registernumber'=>$regisnum));
			$upcif->tsic = $tsiccode;
			$upcif->tsicname = $tsicdetial;
			$upcif->crop_updateby = Yii::app()->user->username;
			$upcif->crop_updatetime = date('Y-m-d H:i:s');
			if($upcif->save()){
				$txt1 = 'update_tsic_' . $tsiccode . '-' . $tsicdetial . '-' . Yii::app()->user->username;
				$msgresult = Yii::app()->Clogevent->createlogevent("update", "tsic", "schdetailcropsp", "update", $txt1);
				echo "{$tsiccode} :: {$tsicdetial}";
			}
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}
	
	public function actionSchfrmwpd(){
		
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		if(isset(Yii::app()->user->username)){
	  		$username = Yii::app()->user->username;
  		}else{
	  		$username = "sys";
  		}
		$action = $_POST['action'];
		$schtxt = $_POST['schtxt'];
		$seltxt = $_POST['seltxt'];
		//echo "{$action},{$schtxt},{$seltxt}";
		
		$levremark = "ค้นหาสถานประกอบการที่ถูกฟ้องล้มละลาย:" . $seltxt . "&" . $schtxt ;
		$msgresult = Yii::app()->Clogevent->createlogevent("Search", "SearchByInfo", "Search", "CropInfo", $levremark);
		
		$data1 = array('action' => $action, 'schtxt' => $schtxt, 'seltxt' => $seltxt);
		$this->layout='nolayout';
		$this->render('/site/searchpages/searchledfrmwpd', $data1); //schbyinfo
		
	
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
		
	
	}//function
	
	public function actionGetfilenameall(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		if(isset(Yii::app()->user->username)){
	  		$username = Yii::app()->user->username;
  		}else{
	  		$username = "sys";
  		}
		//*********************************************************
		$action = $_POST['action'];
		$fns = $_POST['fns'];
		
		$levremark = "เปิดpopupแสดงชื่อtextfile:" . $fns . "&" . $action . "by" . $username ;
		$msgresult = Yii::app()->Clogevent->createlogevent("Searchpages", "getfilenameall", "Search7", "getfilenameall", $levremark);
		
		$data1 = array('action' => $action, 'fns' => $fns);
		$this->layout='nolayout';
		$this->render('/site/searchpages/getfilenameall', $data1);	
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}
	
	public function actionDownloadtxtfilefrmsftp(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		if(isset(Yii::app()->user->username)){
	  		$username = Yii::app()->user->username;
  		}else{
	  		$username = "sys";
  		}
		//*********************************************************
		$action = $_POST['action'];
		$dwntxt = $_POST['dwntxt'];
		
		
		$localpathf = Yii::app()->Cgentextfile->localpathd . $dwntxt; //"C:/xampp/htdocs/wpdtextfile/out/" . $dwntxt;
		$remotepathf = Yii::app()->Cgentextfile->remotepathd . $dwntxt; //"/home/wpdusr/uploaddir/" . $dwntxt; //T8000_D621030.txt";
		
		// checking whether file exists or not 
		if (file_exists($localpathf))  
		{ 
			echo "ไฟล์ชื่อ : {$dwntxt} มีอยู่แล้ว"; 
		} 
		else 
		{ 
			if(Yii::app()->Cgentextfile->getConnectionsftp()){
			  $sftp = ssh2_sftp(Yii::app()->Cgentextfile->conn);
			  $contents = file_get_contents("ssh2.sftp://" . intval($sftp) . "$remotepathf");
			  if(file_put_contents($localpathf,$contents)){
				  
				//เพิ่มรายการไฟล์ที่ donwload ลงใน table SapainstxtfileTb  *******
				$SapainstxtfileTb = new SapainstxtfileTb();
				$SapainstxtfileTb->sptf_filename = $dwntxt;
				$SapainstxtfileTb->sptf_path = $localpathf;
				$SapainstxtfileTb->sptf_numrec = 0;
				$SapainstxtfileTb->sptf_createby = $username;
				$SapainstxtfileTb->sptf_created = date('Y-m-d H:i:s');
				$SapainstxtfileTb->sptf_updateby = $username;
				$SapainstxtfileTb->sptf_modified = date('Y-m-d H:i:s');
				$SapainstxtfileTb->sptf_remark = "-";
				$SapainstxtfileTb->sptf_status = 1;
				if($SapainstxtfileTb->save()){
					//	
				}else{
					//
				}//if
				//*******************************************************
				    
				echo "Success to download {$dwntxt} <br>";
              }else{
				echo "Failed to download {$dwntxt} <br>";
              }
		
			}
		}//if
		
		//================================================================
		
		//echo "{$action}, {$dwntxt}";
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}//function
	
	public function actionDownloadtxtfilefrmsftpauto(){
		
		$action = $_POST['action'];
		$dwntxt = $_POST['dwntxt'];
		
		
		$localpathf = Yii::app()->Cgentextfile->localpathd . $dwntxt; //"C:/xampp/htdocs/wpdtextfile/out/" . $dwntxt;
		$remotepathf = Yii::app()->Cgentextfile->remotepathd . $dwntxt; //"/home/wpdusr/uploaddir/" . $dwntxt; //T8000_D621030.txt";
		
		// checking whether file exists or not 
		if (file_exists($localpathf))  
		{ 
			echo "The file $localpathf exists"; 
		} 
		else 
		{ 
			if(Yii::app()->Cgentextfile->getConnectionsftp()){
			  $sftp = ssh2_sftp(Yii::app()->Cgentextfile->conn);
			  $contents = file_get_contents("ssh2.sftp://" . intval($sftp) . "$remotepathf");
			  if(file_put_contents($localpathf,$contents)){
				echo "Success to download $dwntxt <br>";
              }else{
				echo "Failed to download $dwntxt <br>";
              }
		
			}
		}//if
		
		
	}//function
	
	public function actionGetfilenamealltb(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		if(isset(Yii::app()->user->username)){
	  		$username = Yii::app()->user->username;
  		}else{
	  		$username = "sys";
  		}
		//*********************************************************
		$this->layout='nolayout';
		$this->render('/site/searchpages/getfilenamealltb');	
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}//function
	
	public function actionCalldbdservice5(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		$bgdatep = $_POST['bgdatep'];
		$eddatep = $_POST['eddatep'];
		$newdap = $_POST['newdap'];
		$updap = $_POST['updap'];
		$fntxt1 = $_POST['fntxt1'];
		//echo 'ส่งข้อมูลสำเร็จ.' . $bgdatep . ',' . $eddatep . ',' . $newdap . ',' . $updap;
		$data1 = array('bgdatep' => $bgdatep, 'eddatep' => $eddatep, 'newdap' => $newdap, 'updap' => $updap, 'fntxt1' => $fntxt1);
		$this->layout='nolayout';
		$this->render('/site/servicepages/calldbdservice5', $data1);
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
		
	}//function
	
	public function actionCalldbdservice5auto(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		$bgdatep = $_POST['bgdatep'];
		$eddatep = $_POST['eddatep'];
		$newdap = $_POST['newdap'];
		$updap = $_POST['updap'];
		$fntxt1 = $_POST['fntxt1'];
		//echo 'ส่งข้อมูลสำเร็จ.' . $bgdatep . ',' . $eddatep . ',' . $newdap . ',' . $updap;
		$data1 = array('bgdatep' => $bgdatep, 'eddatep' => $eddatep, 'newdap' => $newdap, 'updap' => $updap, 'fntxt1' => $fntxt1);
		$this->layout='nolayout';
		$this->render('/site/servicepages/calldbdservice5auto', $data1);
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
		
	}//function
	
	public function actionGettablename(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
			$action = $_POST['action'];
			$tbn = $_POST['tbn'];
			//echo "{$action},{$tbn}";
			$data1 = array('action' => $action, 'tbn' => $tbn);
			$this->layout='nolayout';
			$this->render('/site/adminpages/gettablename', $data1);
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
		
	}//function
	
	public function actionGetfieldname(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
			$action = $_POST['action'];
			$tbn1 = $_POST['tbn1']; //ชื่อตาราง
			$tbn = $_POST['tbn']; //ชื่อฐานข้อมูล
			//echo "{$action},{$tbn1},{$tbn}";
			$data1 = array('action' => $action, 'tbn1' => $tbn1, 'tbn' => $tbn);
			$this->layout='nolayout';
			$this->render('/site/adminpages/getfielddata', $data1);
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}//function
	
	public function actionExecutesqlc(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
			$action = $_POST['action'];
			$sqlc = $_POST['sqlc'];
			$udb1 = $_POST['udb1'];
			//echo "{$action},{$sqlc},{$udb1}";
			$data1 = array('action' => $action, 'sqlc' => $sqlc, 'udb1' => $udb1);
			$this->layout='nolayout';
			$this->render('/site/adminpages/executesqlc', $data1);
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}//function
	
	public function actionExecutesqlcr(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
			$action = $_POST['action'];
			$sqlcr = $_POST['sqlcr'];
			$udb1 = $_POST['udb1'];
			//echo "{$action},{$sqlcr}";
			$data1 = array('action' => $action, 'sqlcr' => $sqlcr,  'udb1' => $udb1);
			$this->layout='nolayout';
			$this->render('/site/adminpages/executesqlcr', $data1);
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}//function
	
	public function actionListdata(){
		//$action = $_POST['action'];
		//echo $action;
		//exit;
		$page = 1;
		if(!empty($_POST['page'])) $page = (int)$_POST['page'];

		$recordsPerPage = 10;
		if(!empty($_POST['length'])) $recordsPerPage = (int)$_POST['length'];

		$start = 0;
		if(!empty($_POST['start'])) $start = (int)$_POST['start'];
		
		$noOfRecords = 0;
		
		//echo "{$page}, {$recordsPerPage}, {$start} ";
		
		/*$q = new CDbCriteria( array(
			'condition' => "lrpt_status = :lrpt_status ",         
			'params'    => array(':lrpt_status' => 1)  
		));
		$leddata = LedrptTb::model()->findAll($q);
		$countled = count($leddata);*/
		
		$conn = Yii::app()->db;	
		
		$sql="SET @rownum := 0;";
		$command = $conn->createCommand($sql)->execute();
			
		$sql = "SELECT * FROM wpddb.ledrpt_tb";
		$sql ="
		 SELECT * FROM (SELECT @rownum := @rownum+1 AS NUMBER, wpddb.ledrpt_tb.* FROM  wpddb.ledrpt_tb ORDER BY lrpt_id) AS TBL
			WHERE NUMBER BETWEEN :rowstart AND :rowend 
			ORDER BY lrpt_id;
		";
		
		$command = $conn->createCommand($sql); 
		$command->bindValue(":rowstart", ($start + 1));	
		$command->bindValue(":rowend", ($start + $recordsPerPage)); 
		/*if(!empty($this->FSearch)){
			$command->bindValue(":Condition", "%" . $FSearch . "%"); 	
		}*/
		$rows = $command->queryAll();

		
		//var_dump($rows);exit;
		
		$arr = array();
		foreach($rows as $dataitem) {
			//$new =  array_push($dataitem,"xxx");
			$arr[] = array_values($dataitem) ;                 
		}
		
		$jsondata = json_encode($arr);
		
		$sql = "SELECT COUNT(*) As ct FROM wpddb.ledrpt_tb";

			$command = $conn->createCommand($sql);
			$rows= $command->queryAll();
			$noOfRecords =  $rows[0]['ct'];
		
		//var_dump($jsondata);
		
		echo '{"recordsTotal":' . $noOfRecords . ',"recordsFiltered":' . $noOfRecords . ',"data":'. $jsondata . '}';
		
		//var_dump($_POST);
		//exit;
	}//function 
	
	public function actionListdata2(){
		
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		
		
		$action = $_POST['action'];
		$tbn1 = $_POST['tbn1']; //tablename
		$udb1 = $_POST['udb1']; //databasename
		$txtsql = $_POST['txtsql']; //sql command ที่ user key
		
		if($udb1=="wpddb"){
			$conn = Yii::app()->db;//get connection
		}else if($udb1=="wpdlogdb"){
			$conn = Yii::app()->db2;//get connection
		}else if($udb1=="wpdreportdb"){
			$conn = Yii::app()->db3;//get connection
		}
		
		//var_dump($_POST);
		
		$dbtb = $udb1 . "." . $tbn1;
		
		//echo "{$action},{$tbn1},{$udb1}";
		
		$draw = $_POST['draw']; //ลำดับที่ตารางที่จะเอาข้อมููลไปเขียน
		
		$columns = $_POST['columns']; //array columns 
		//var_dump($columns);
		
		$columnsdata = $_POST['columns'][1]['data']; //ลำดับที่ collums เริ่มต้นที่ 0
		$colname = $_POST['columns'][1]['name']; //ชื่อ column
		$colsch = $_POST['columns'][1]['searchable']; //เปิดให้ search true or false
		$colord = $_POST['columns'][1]['orderable']; //อนุญาติให้จัดเรียง true or false
		$colschtxt = $_POST['columns'][1]['search']['value']; //ข้อความค้นหาในคอลัมน์ 1
		$colschtype = $_POST['columns'][1]['search']['regex']; //ประเภทการค้นหาในคอลัมน์ true or false
		
		$countcolumns = count($columns);  //จำนวนคอลัมน์ที่กำหนดไว้ในส่วน header
		
		$ordercol = $_POST['order'][0]['column']; //การจัดเรียงเริ่มต้น
		$ordertype = $_POST['order'][0]['dir']; //ประเภทของการจัดเรียง
		
		$start = $_POST['start']; //จำนวน record เริ่มต้นต่อ 1 หน้า 0
		$length = $_POST['length']; //จำนวน record สุดท้าย / หน้า 10
		$page = 1;
		if(!empty($_POST['page'])) $page = $_POST['page'];  //เลขหน้าที่คลิกเข้ามา กรณีไม่มีข้อมูลจะไม่มีเลขหน้า
		
		$searchtxt = $_POST['search']['value']; //คำค้นหารวมที่พิมพ์เข้ามา
		$searchtype = $_POST['search']['regex']; //การค้นหา true or false
		
		$orderb = "";
		if (strstr($txtsql, 'order' )) {
			$orderb = substr($txtsql,strpos($txtsql,'order'),strlen($txtsql));
		}else{
			$orderb = "";
		}
		
		
		$Condition = "";
		if (strstr($txtsql, 'where' )) {
			  $Condition = substr($txtsql,strpos($txtsql,'where'),strlen($txtsql));
		} else {
			  $Condition = "";
		}
		
		if (strstr($Condition, 'order' )) {
			$Condition = substr($Condition,0,strpos($Condition,'order'));	
		}else{
			$Condition = $Condition;
		}
		
		$fn = $conn->schema->getTable($tbn1)->getColumnNames(); //fieldname

		if($Condition != ""){
		  for ( $i=0, $ien=count($columns) ; $i<$ien ; $i++ ) {
			  if($_POST['columns'][$i]['search']['value'] != ""){
			  	$Condition = $Condition . " AND " . $fn[$i-1] . " LIKE '%" . $_POST['columns'][$i]['search']['value'] . "%'";
			  }//if
		  }//for
		}else{//if
		  $fistno = 1;	
		  for ( $i=0, $ien=count($columns) ; $i<$ien ; $i++ ) {
			  if($_POST['columns'][$i]['search']['value'] != ""){
				if($fistno==1){	  
			  		$Condition = $Condition . " WHERE " . $fn[$i-1] . " LIKE '%" . $_POST['columns'][$i]['search']['value'] . "%'";
					$fistno += 1;
				}else{
					$Condition = $Condition . " AND " . $fn[$i-1] . " LIKE '%" . $_POST['columns'][$i]['search']['value'] . "%'";
				}//if
			  }//if
		  }//for
		}//if
		
		if($Condition != ""){
			if($_POST['search']['value'] != ""){
				$firstnos = 1;
				for ( $i=0, $ien=count($columns)-1 ; $i<$ien ; $i++ ) {
					if($firstnos==1){
						$Condition = $Condition . " AND " . $fn[$i] . " LIKE '%" . $_POST['search']['value'] . "%'";
						$firstnos += 1;
					}else if($firstnos>1){
						$Condition = $Condition . " OR " . $fn[$i] . " LIKE '%" . $_POST['search']['value'] . "%'";
						$firstnos += 1;
					}
				}//for
			}//if
		}else{//if
			if($_POST['search']['value'] != ""){
				$firstnos = 1;
				for ( $i=0, $ien=count($columns)-1 ; $i<$ien ; $i++ ) {
					if($firstnos==1){
						$Condition = $Condition . " WHERE " . $fn[$i] . " LIKE '%" . $_POST['search']['value'] . "%'";
						$firstnos += 1;
					}else if($firstnos==2){
						$Condition = $Condition . " AND " . $fn[$i] . " LIKE '%" . $_POST['search']['value'] . "%'";
						$firstnos += 1;
					}else{
						$Condition = $Condition . " OR " . $fn[$i] . " LIKE '%" . $_POST['search']['value'] . "%'";
						$firstnos += 1;
					}
				}//for
			}//if
		}
		
	   if($orderb!=""){
		   $Condition = $Condition . " " . $orderb;
	   }else{
		   $Condition = $Condition;
	   }
	
		//echo "{$countcolumns},{$Condition}";
		//exit;
	
		//echo "{$draw}, {$countcolumns}, {$columnsdata}, {$colname}, {$colsch}, {$colord}, {$colschtxt} , {$colschtype}, {$ordercol}, {$ordertype}, {$start}, {$length}, {$page}, {$searchtxt}, {$searchtype}, {$tbn1}, {$udb1}, {$txtsql}";
		
		//exit;
		
		
		$page = 1;
		if(!empty($_POST['page'])) $page = (int)$_POST['page'];

		$recordsPerPage = 10;
		if(!empty($_POST['length'])) $recordsPerPage = (int)$_POST['length'];

		$start = 0;
		if(!empty($_POST['start'])) $start = (int)$_POST['start'];
		
		$noOfRecords = 0;
		
		$sql="SET @rownum := 0;";
		$command = $conn->createCommand($sql)->execute();
		
		//$sql = "SELECT * FROM " . $udb1 . "." . $tbn1;
		
		$sqldbtball = $udb1 . "." . $tbn1 . ".*"; //wpddb.ledrpt_tb.*
		$sqldbtb = $udb1 . "." . $tbn1;
		
		//echo "{$sqldbtball}"; exit;
		
		$sql ="
		 SELECT * FROM (SELECT @rownum := @rownum+1 AS NUMBER, " . $sqldbtball . " FROM  " . $sqldbtb . " " . $Condition . " ) AS TBL
			WHERE NUMBER BETWEEN :rowstart AND :rowend ;
		";
		
		$command = $conn->createCommand($sql); 
		$command->bindValue(":rowstart", ($start + 1));	
		$command->bindValue(":rowend", ($start + $recordsPerPage));
		
		$rows = $command->queryAll();
		
		$arr = array();
		foreach($rows as $dataitem) {
			$arr[] = array_values($dataitem) ;                 
		}
		
		$jsondata = json_encode($arr);
		
		$sql = "SELECT COUNT(*) As ct FROM " . $sqldbtb . " " . $Condition;

		$command = $conn->createCommand($sql);
		$rows= $command->queryAll();
		$noOfRecords =  $rows[0]['ct'];
		
		echo '{"recordsTotal":' . $noOfRecords . ',"recordsFiltered":' . $noOfRecords . ',"data":'. $jsondata . '}';
		
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
		
	}//function 
	
	public function actionGettxtfilesiskcrop(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
			$this->layout='nolayout';
			$this->render('/site/searchpages/gettxtfilesiskcrop');
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}//function
	
	public function actionGetriskcrop(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
			$this->layout='nolayout';
			$this->render('/site/searchpages/getriskcrop');
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}//function
	
	public function actionDownloadtxtfileledfrmsftp(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		if(isset(Yii::app()->user->username)){
	  		$username = Yii::app()->user->username;
  		}else{
	  		$username = "sys";
  		}
		//*********************************************************
		$action = $_POST['action'];
		$dlt = $_POST['dlt'];
		
		//echo "{$action}, {$dlt}";
		
		$localpathf = Yii::app()->Cgentextfile->localpathled . $dlt; //"C:/xampp/htdocs/wpdtextfile/out/" . $dwntxt;
		$remotepathf = Yii::app()->Cgentextfile->remotepathled . $dlt; //"/home/wpdusr/uploaddir/" . $dwntxt; //T8000_D621030.txt";
		
		// checking whether file exists or not 
		if (file_exists($localpathf))  
		{ 
			echo "มีไฟล์ {$dlt} อยู่แล้ว!"; 
		} 
		else 
		{ 
			if(Yii::app()->Cgentextfile->getConnectionsftp()){
			  $sftp = ssh2_sftp(Yii::app()->Cgentextfile->conn);
			  $contents = file_get_contents("ssh2.sftp://" . intval($sftp) . "$remotepathf");
			  if(file_put_contents($localpathf,$contents)){
				//*** insert data to LedtextfileTb.php ******
					 $LedtextfileTb = new LedtextfileTb();
					 $LedtextfileTb->ltf_name = $dlt;
					 $LedtextfileTb->ltf_path = $localpathf;
					 $LedtextfileTb->ltf_countud = "0";
					 $LedtextfileTb->ltf_statusud = "N";
					 $LedtextfileTb->ltf_statusupload = "N";
					 $LedtextfileTb->ltf_createby = $username;
					 $LedtextfileTb->ltf_created = date('Y-m-d H:i:s');
					 $LedtextfileTb->ltf_updateby = $username;
					 $LedtextfileTb->ltf_modified = date('Y-m-d H:i:s');
					 $LedtextfileTb->ltf_remark = "-";
					 $LedtextfileTb->ltf_status = "1";
					 if($LedtextfileTb->save()){
						$msg = "Success to download {$dlt} <br>";
						//$msgresult = Yii::app()->Clogevent->createlogevent("Update", "UpdateStatusPage", "UpdatestatustoB", "CropInfo&Empstate", $levremark);	
					  }else{
						$msg = $EmpstateTb->getErrors();
						  //echo preg_replace("/\xEF\xBB\xBF/", "",CJSON::encode(array('status' => 'error')));
					  }
				//*******************************************  
				echo $msg;
              }else{
				echo "Failed to download {$dlt} <br>";
              }
			}
		}//if
		
		
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}//function
	
	
	public function actionChkriskcrop(){
		
		set_time_limit(0);
		ini_set("max_execution_time","0");
		ini_set("memory_limit","9999M"); 
		
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		
			$action = $_POST['action'];
			$ltf_name = $_POST['ltf_name'];
			//echo "{$action},{$ltf_name}";
			 //**** นับจำนวนบรรทัดทั้งหมดใน textfile ******** //
			$minrec = 0;
			$linecount = 0;
			$handle = fopen(Yii::app()->Cgentextfile->localpathled . $ltf_name, "r");
			$time_start = microtime(true); 
			while(!feof($handle)){
			  $line = fgets($handle);
			  $linecount++;
			}
			fclose($handle);
			//echo $linecount; echo "<br>";
			$time_end = microtime(true);
			$execution_time = ($time_end - $time_start)/60;
			//echo '<b>Total Execution Time:</b> '.$execution_time.' Mins'; echo "<br>";
		    //**** นับจำนวนบรรทัดทั้งหมดใน textfile ******** //	
		    //********
		     $linecount = $linecount; //5000;
		    //********
		  
		  //echo "{$action},{$ltf_name}, {$execution_time}, {$linecount} ";
		  //*************************** ประกาศตัวแปร array ********
		    $lrc_id_arr = array();
			$lrc_accno_arr = array();
			$lrc_bran_arr = array();
			$lrc_registernumber_arr = array();
			$lrc_registername_arr = array();
			$lrc_ssocode1_arr = array();
			$lrc_ssocode2_arr = array();
			$lrc_address_arr = array();
			$lrc_amphur_arr = array();
			$lrc_province_arr = array();
			$lrc_zipcode_arr = array();
			/*$lrc_createby
			$lrc_created
			$lrc_updateby
			$lrc_modified
			$lrc_remark
			$lrc_status*/
		  //***************************************************
		  	$line = -1;
  			$min = $minrec; //บรรทัดเริ่มต้น บรรทัดแรกสุด คือ 0
  			$max = $linecount; //$min + 1000;//42632; //บรรทัดสุดท้ายที่จะให้ดึง
		  
		  	if (($myfile = fopen( Yii::app()->Cgentextfile->localpathled . $ltf_name , "r")) !== FALSE) {  
				$time_start = microtime(true); 
				$rownum = 0;
				$rowempty = 0;
				$rowlength = 0;
				$rownonum = 0;
				$rowduplicate = 0;
				$numofintsert = 0;
				while(!feof($myfile)) {
					$line++;
					if(($line >= $min && $line <= $max)) {
						$datastr  = fgets($myfile);
						$arraystr = explode(";", $datastr);
						  if(!empty($arraystr[0])){
	  						$t0 = trim($arraystr[0]);// เลขประกันสังคม 10 หลัก
						  }else{
							$t0 = "";  	
						  }
						  if(!empty($arraystr[1])){
							$t1 = trim($arraystr[1]);// เลขสาขา 6 หลัก
						  }else{
							$t1 = "";    
						  }
						  if(!empty($arraystr[2])){
							$t2 = trim($arraystr[2]);// เลขทะเบียนพาณิชย์ 13 หลัก
						  }else{
							$t2 = "";  
						  }
						  if(!empty($arraystr[3])){
							$t3 = trim($arraystr[3]);// ชื่อสถานประกอบการ
						  }else{
							$t3 = "";  
						  }
						  if(!empty($arraystr[4])){
							$t4 = trim($arraystr[4]);// bran_code สปส เร่งรัดหนี้
						  }else{
							$t4 = "";
						  }
						  if(!empty($arraystr[5])){
							$t5 = trim($arraystr[5]);// bran_code สปส รับผิดชอบ
						  }else{
							$t5 = "";  
						  }
						  if(!empty($arraystr[6])){
							$t6 = trim($arraystr[6]);// ที่อยู่
						  }else{
							$t6 = "";   
						  }
						 if(!empty($arraystr[7])){
							$t7 = trim($arraystr[7]);// อำเภอ
						 }else{
							$t7 = "";	 
						 }
						 if(!empty($arraystr[8])){  
							$t8 = trim($arraystr[8]);// จังหวัด
						 }else{
							$t8 = ""; 
						 }
						 if(!empty($arraystr[9])){  
							$t9 = trim($arraystr[9]);// รหัสไปรษณีย์ 
						 }else{
							$t9 = ""; 
						 }
						 
						$t3f = iconv('tis-620','utf-8',$t3);// ชื่อสถานประกอบการ
						$t6f = iconv('tis-620','utf-8',$t6);// ที่อยู่
						$t7f = iconv('tis-620','utf-8',$t7);// อำเภอ
						$t8f = iconv('tis-620','utf-8',$t8);// จังหวัด
						
						$crop_address = $t6f . " " .  $t7f . " " . $t8f . " " . $t9;
						
						if(!empty($t2)){ //ถ้าเลข 13 หลัก เป็นค่าว่าง หรือ null
							 $lent2 = strlen($t2);
							 if($lent2==13){ //ถ้าตัวเลขทะเบียน เท่ากับ 13 หลัก
							 	if(is_numeric($t2) && $t2 > 0 && $t2 == round($t2,0)){ //ถ้าเป็นตัวเลขทั้งหมด
									  $lrc_accno_arr[] = $t0;
									  $lrc_bran_arr[] = $t1;
									  $lrc_registernumber_arr[] = $t2;
									  $lrc_registername_arr[] = $t3f;
									  $lrc_ssocode1_arr[] = $t4;
									  $lrc_ssocode2_arr[] = $t5;
									  $lrc_address_arr[] = $t6f;
									  $lrc_amphur_arr[] = $t7f;
									  $lrc_province_arr[] = $t8f;
									  $lrc_zipcode_arr[] = $t9;
									  
									  //echo "{$rownum}, {$line}, {$t0}, {$t1}, {$t2}, {$t3f}, {$t4}, {$t5}, {$t6f}, {$t7f}, {$t8f}, {$t9}"; echo "<br>";
				 
				 					  $rownum += 1;
									  
									  $selq = LedriskcropTb::model()->findByAttributes(array('lrc_registernumber'=>$t2));
									  if(empty($selq)){
										  $LedriskcropTb = new LedriskcropTb();
										   $LedriskcropTb->lrc_accno = $t0;
										   $LedriskcropTb->lrc_bran = $t1;
										   $LedriskcropTb->lrc_registernumber = $t2;
										   $LedriskcropTb->lrc_registername = $t3f;
										   $LedriskcropTb->lrc_ssocode1 = $t4;
										   $LedriskcropTb->lrc_ssocode2 = $t5;
										   $LedriskcropTb->lrc_address = $t6f;
										   $LedriskcropTb->lrc_amphur = $t7f;
										   $LedriskcropTb->lrc_province = $t8f;
										   $LedriskcropTb->lrc_zipcode = $t9;
										   $LedriskcropTb->lrc_createby = Yii::app()->user->username;
										   $LedriskcropTb->lrc_created = date('Y-m-d H:i:s');
										   $LedriskcropTb->lrc_updateby = Yii::app()->user->username;
										   $LedriskcropTb->lrc_modified = date('Y-m-d H:i:s');
										   $LedriskcropTb->lrc_remark = "-";
										   $LedriskcropTb->lrc_status = 1;
										   if($LedriskcropTb->save()){
											   $msg = "insert data is success.";
											   $numofintsert += 1;
										   }else{//if
										   	   $msg = $LedriskcropTb->getErrors();	 
										   }//if
										   //echo "{$msg} <br>";
									  }//if
								}//if
							 }//if
						}//if
	  
					}//if
					
				}//while
				
				fclose($myfile);
				
				//update status text file ***************
				$qltf = LedtextfileTb::model()->findByAttributes(array('ltf_name'=>$ltf_name));
				$qltf->ltf_countud = $numofintsert;
				$qltf->ltf_statusud = "Y";
				$qltf->ltf_updateby = Yii::app()->user->username;
				$qltf->ltf_modified = date('Y-m-d H:i:s');
				$qltf->ltf_status = 2;
				if($qltf->save()){
					$msg3 = "update data is success.";
				}else{
					$msg3 = $qltf->getErrors();
				}		   
				//***************************************
				
				$time_end = microtime(true);
				$execution_time = ($time_end - $time_start)/60;
				echo '<b> ตรวจสอบไฟล์ :</b> ' . $ltf_name  . ' เรียบร้อย <br>';
				echo '<b> เพิ่มรายการจำนวน :</b> ' . $numofintsert  . ' รายการ <br>';
				echo '<b>ใช้เวลา :</b> '.$execution_time.' Mins <br>';
				
			}//if
		  
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}//function
	
	
	public function actionListdatariskcrop2(){
		
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		
		
		$action = $_POST['action'];
		$tbn1 = $_POST['tbn1']; //tablename
		$udb1 = $_POST['udb1']; //databasename
		$txtsql = $_POST['txtsql']; //sql command ที่ user key
		
		$ssocodeusr =  Yii::app()->user->address;
		$ssocodeusrsub =  substr(Yii::app()->user->address, 0, -2);
		
		//หาว่าเป็นส่วนกลางหรือจังหวัด จาก mas_ssobranch
		$mmsb = MasSsobranch::model()->findByAttributes(array('ssobranch_code'=>$ssocodeusr)); //mas_ssobranch
		if($mmsb){
			$ssobranch_type_id = $mmsb->ssobranch_type_id;
		}else{
			$ssobranch_type_id = 2;
		}
		
		if($ssocodeusr=="1050"){
			$ssobranch_type_id = 1;	
		}
		
		//echo "{$ssobranch_type_id}"; exit;
		
		if($udb1=="wpddb"){
			$conn = Yii::app()->db;//get connection
		}else if($udb1=="wpdlogdb"){
			$conn = Yii::app()->db2;//get connection
		}else if($udb1=="wpdreportdb"){
			$conn = Yii::app()->db3;//get connection
		}
		
		//var_dump($_POST);
		
		$dbtb = $udb1 . "." . $tbn1;
		
		//echo "{$action},{$tbn1},{$udb1},{$txtsql}"; exit;
		
		$draw = $_POST['draw']; //ลำดับที่ตารางที่จะเอาข้อมููลไปเขียน
		$columns = $_POST['columns']; //array columns 
		$columnsdata = $_POST['columns'][1]['data']; //ลำดับที่ collums เริ่มต้นที่ 0
		$colname = $_POST['columns'][1]['name']; //ชื่อ column
		$colsch = $_POST['columns'][1]['searchable']; //เปิดให้ search true or false
		$colord = $_POST['columns'][1]['orderable']; //อนุญาติให้จัดเรียง true or false
		$colschtxt = $_POST['columns'][1]['search']['value']; //ข้อความค้นหาในคอลัมน์ 1
		$colschtype = $_POST['columns'][1]['search']['regex']; //ประเภทการค้นหาในคอลัมน์ true or false
		$countcolumns = count($columns);  //จำนวนคอลัมน์ที่กำหนดไว้ในส่วน header
		$ordercol = $_POST['order'][0]['column']; //การจัดเรียงเริ่มต้น
		$ordertype = $_POST['order'][0]['dir']; //ประเภทของการจัดเรียง
		$start = $_POST['start']; //จำนวน record เริ่มต้นต่อ 1 หน้า 0
		$length = $_POST['length']; //จำนวน record สุดท้าย / หน้า 10
		
		$page = 1;
		if(!empty($_POST['page'])) $page = $_POST['page'];  //เลขหน้าที่คลิกเข้ามา กรณีไม่มีข้อมูลจะไม่มีเลขหน้า
		
		$searchtxt = $_POST['search']['value']; //คำค้นหารวมที่พิมพ์เข้ามา
		$searchtype = $_POST['search']['regex']; //การค้นหา true or false
		
		$orderb = "";
		if (strstr($txtsql, 'order' )) { //ค้นหาว่ามีคำว่า order หรือปล่าว
			$orderb = substr($txtsql,strpos($txtsql,'order'),strlen($txtsql));
		}else{
			$orderb = "";
		}
		
		$Condition = ""; //ตรวจสอบว่ามีคำว่า where หรือปล่าว
		if (strstr($txtsql, 'where' )) {
			  $Condition = substr($txtsql,strpos($txtsql,'where'),strlen($txtsql));
		} else {
			  $Condition = "";
		}
		
		if (strstr($Condition, 'order' )) { //ตัดคำหลัง order ออกไป
			$Condition = substr($Condition,0,strpos($Condition,'order'));	
		}else{
			$Condition = $Condition;
		}
		
		$fn = $conn->schema->getTable($tbn1)->getColumnNames(); //fieldname get


		if($Condition != ""){
		  for ( $i=0, $ien=count($columns) ; $i<$ien ; $i++ ) {
			  if($_POST['columns'][$i]['search']['value'] != ""){
			  	$Condition = $Condition . " AND " . $fn[$i-1] . " LIKE '%" . $_POST['columns'][$i]['search']['value'] . "%'";
			  }//if
		  }//for
		}else{//if
		  $fistno = 1;	
		  for ( $i=0, $ien=count($columns) ; $i<$ien ; $i++ ) {
			  if($_POST['columns'][$i]['search']['value'] != ""){
				if($fistno==1){
			  		$Condition = $Condition . " WHERE " . $fn[$i-1] . " LIKE '%" . $_POST['columns'][$i]['search']['value'] . "%'";
					$fistno += 1;
				}else{
					$Condition = $Condition . " AND " . $fn[$i-1] . " LIKE '%" . $_POST['columns'][$i]['search']['value'] . "%'";
				}//if
			  }//if
		  }//for
		}//if
		
		if($Condition != ""){
			if($_POST['search']['value'] != ""){
				$firstnos = 1;
				for ( $i=0, $ien=count($columns)-1 ; $i<$ien ; $i++ ) {
					if($firstnos==1){
						$Condition = $Condition . " AND " . $fn[$i] . " LIKE '%" . $_POST['search']['value'] . "%'";
						$firstnos += 1;
					}else if($firstnos>1){
						$Condition = $Condition . " OR " . $fn[$i] . " LIKE '%" . $_POST['search']['value'] . "%'";
						$firstnos += 1;
					}
				}//for
			}//if
		}else{//if
			if($_POST['search']['value'] != ""){
				$firstnos = 1;
				for ( $i=0, $ien=count($columns)-1 ; $i<$ien ; $i++ ) {
					if($firstnos==1){
						$Condition = $Condition . " WHERE " . $fn[$i] . " LIKE '%" . $_POST['search']['value'] . "%'";
						$firstnos += 1;
					}else if($firstnos==2){
						$Condition = $Condition . " AND " . $fn[$i] . " LIKE '%" . $_POST['search']['value'] . "%'";
						$firstnos += 1;
					}else{
						$Condition = $Condition . " OR " . $fn[$i] . " LIKE '%" . $_POST['search']['value'] . "%'";
						$firstnos += 1;
					}
				}//for
			}//if
		}
		
		
	   if($orderb!=""){
		   $Condition = $Condition . " " . $orderb;
	   }else{
		   $Condition = $Condition;
	   }
	
       //เพิ่มเงื่อนไขในกรณีที่ เป็น เจ้าหน้าที่ จังหวัด	
		/*if($Condition==""){
			if($ssobranch_type_id==1){
				$Condition = $Condition;
			}else{
				$Condition = $Condition . " WHERE lrc_ssocode1 LIKE '" . $ssocodeusrsub . "%' OR lrc_ssocode2 LIKE '" . $ssocodeusrsub . "%' ";
			}
		}else{
			if($ssobranch_type_id==1){
				$Condition = $Condition;
			}else{
				$Condition = $Condition . " AND lrc_ssocode1 LIKE '" . $ssocodeusrsub . "%' OR lrc_ssocode2 LIKE '" . $ssocodeusrsub . "%' ";      }
		}//if*/
		
		//echo "{$Condition}"; exit;
		
		$page = 1;
		if(!empty($_POST['page'])) $page = (int)$_POST['page'];

		$recordsPerPage = 10;
		if(!empty($_POST['length'])) $recordsPerPage = (int)$_POST['length'];

		$start = 0;
		if(!empty($_POST['start'])) $start = (int)$_POST['start'];
		
		$noOfRecords = 0;
		
		$sql="SET @rownum := 0;";
		$command = $conn->createCommand($sql)->execute();
		
		//$sql = "SELECT * FROM " . $udb1 . "." . $tbn1;
		
		$sqldbtball = $udb1 . "." . $tbn1 . ".*"; //wpddb.ledrpt_tb.*
		$sqldbtb = $udb1 . "." . $tbn1;
		
		//echo "{$sqldbtball}"; exit;
		
		$sql ="
		 SELECT * FROM (SELECT @rownum := @rownum+1 AS NUMBER, " . $sqldbtball . " FROM  " . $sqldbtb . " " . $Condition . " ) AS TBL
			WHERE NUMBER BETWEEN :rowstart AND :rowend ;
		";
		
		
		$command = $conn->createCommand($sql); 
		$command->bindValue(":rowstart", ($start + 1));	
		$command->bindValue(":rowend", ($start + $recordsPerPage));
		
		$rows = $command->queryAll();
		//$noOfRecords = count($rows);
		
		
		//echo count($rows);exit;
		
		//var_dump($rows);exit;
		
		$arr = array();
		foreach($rows as $dataitem) {
			
			$arr[] = array_values($dataitem) ;                 
		}
		
		$jsondata = json_encode($rows); //$arr
		
		//var_dump($jsondata);exit;
		
			$sql = "SELECT COUNT(*) As ct FROM " . $sqldbtb . " " . $Condition;

		$command = $conn->createCommand($sql);
		$rows= $command->queryAll();
		$noOfRecords =  $rows[0]['ct'];
		
		
		
		echo '{"recordsTotal":' . $noOfRecords . ',"recordsFiltered":' . $noOfRecords . ',"data":'. $jsondata . '}';
		
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}	
		
	}//function
	
	
	public function actionListdatariskcrop(){
		
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		
		
		$action = $_POST['action'];
		$tbn1 = $_POST['tbn1']; //tablename
		$udb1 = $_POST['udb1']; //databasename
		$txtsql = $_POST['txtsql']; //sql command ที่ user key
		
		if($udb1=="wpddb"){
			$conn = Yii::app()->db;//get connection
		}else if($udb1=="wpdlogdb"){
			$conn = Yii::app()->db2;//get connection
		}else if($udb1=="wpdreportdb"){
			$conn = Yii::app()->db3;//get connection
		}
		
		//var_dump($_POST);
		
		$dbtb = $udb1 . "." . $tbn1;
		
		//echo "{$action},{$tbn1},{$udb1},{$txtsql}"; exit;
		
		$draw = $_POST['draw']; //ลำดับที่ตารางที่จะเอาข้อมููลไปเขียน
		$columns = $_POST['columns']; //array columns 
		$columnsdata = $_POST['columns'][1]['data']; //ลำดับที่ collums เริ่มต้นที่ 0
		$colname = $_POST['columns'][1]['name']; //ชื่อ column
		$colsch = $_POST['columns'][1]['searchable']; //เปิดให้ search true or false
		$colord = $_POST['columns'][1]['orderable']; //อนุญาติให้จัดเรียง true or false
		$colschtxt = $_POST['columns'][1]['search']['value']; //ข้อความค้นหาในคอลัมน์ 1
		$colschtype = $_POST['columns'][1]['search']['regex']; //ประเภทการค้นหาในคอลัมน์ true or false
		$countcolumns = count($columns);  //จำนวนคอลัมน์ที่กำหนดไว้ในส่วน header
		$ordercol = $_POST['order'][0]['column']; //การจัดเรียงเริ่มต้น
		$ordertype = $_POST['order'][0]['dir']; //ประเภทของการจัดเรียง
		$start = $_POST['start']; //จำนวน record เริ่มต้นต่อ 1 หน้า 0
		$length = $_POST['length']; //จำนวน record สุดท้าย / หน้า 10
		
		$page = 1;
		if(!empty($_POST['page'])) $page = $_POST['page'];  //เลขหน้าที่คลิกเข้ามา กรณีไม่มีข้อมูลจะไม่มีเลขหน้า
		
		$searchtxt = $_POST['search']['value']; //คำค้นหารวมที่พิมพ์เข้ามา
		$searchtype = $_POST['search']['regex']; //การค้นหา true or false
		
		$orderb = "";
		if (strstr($txtsql, 'order' )) { //ค้นหาว่ามีคำว่า order หรือปล่าว
			$orderb = substr($txtsql,strpos($txtsql,'order'),strlen($txtsql));
		}else{
			$orderb = "";
		}
		
		$Condition = ""; //ตรวจสอบว่ามีคำว่า where หรือปล่าว
		if (strstr($txtsql, 'where' )) {
			  $Condition = substr($txtsql,strpos($txtsql,'where'),strlen($txtsql));
		} else {
			  $Condition = "";
		}
		
		if (strstr($Condition, 'order' )) { //ตัดคำหลัง order ออกไป
			$Condition = substr($Condition,0,strpos($Condition,'order'));	
		}else{
			$Condition = $Condition;
		}
		
		$fn = $conn->schema->getTable($tbn1)->getColumnNames(); //fieldname get

		if($Condition != ""){
		  for ( $i=0, $ien=count($columns) ; $i<$ien ; $i++ ) {
			  if($_POST['columns'][$i]['search']['value'] != ""){
			  	$Condition = $Condition . " AND " . $fn[$i-1] . " LIKE '%" . $_POST['columns'][$i]['search']['value'] . "%'";
			  }//if
		  }//for
		}else{//if
		  $fistno = 1;	
		  for ( $i=0, $ien=count($columns) ; $i<$ien ; $i++ ) {
			  if($_POST['columns'][$i]['search']['value'] != ""){
				if($fistno==1){	  
			  		$Condition = $Condition . " WHERE " . $fn[$i-1] . " LIKE '%" . $_POST['columns'][$i]['search']['value'] . "%'";
					$fistno += 1;
				}else{
					$Condition = $Condition . " AND " . $fn[$i-1] . " LIKE '%" . $_POST['columns'][$i]['search']['value'] . "%'";
				}//if
			  }//if
		  }//for
		}//if
		
		if($Condition != ""){
			if($_POST['search']['value'] != ""){
				$firstnos = 1;
				for ( $i=0, $ien=count($columns)-1 ; $i<$ien ; $i++ ) {
					if($firstnos==1){
						$Condition = $Condition . " AND " . $fn[$i] . " LIKE '%" . $_POST['search']['value'] . "%'";
						$firstnos += 1;
					}else if($firstnos>1){
						$Condition = $Condition . " OR " . $fn[$i] . " LIKE '%" . $_POST['search']['value'] . "%'";
						$firstnos += 1;
					}
				}//for
			}//if
		}else{//if
			if($_POST['search']['value'] != ""){
				$firstnos = 1;
				for ( $i=0, $ien=count($columns)-1 ; $i<$ien ; $i++ ) {
					if($firstnos==1){
						$Condition = $Condition . " WHERE " . $fn[$i] . " LIKE '%" . $_POST['search']['value'] . "%'";
						$firstnos += 1;
					}else if($firstnos==2){
						$Condition = $Condition . " AND " . $fn[$i] . " LIKE '%" . $_POST['search']['value'] . "%'";
						$firstnos += 1;
					}else{
						$Condition = $Condition . " OR " . $fn[$i] . " LIKE '%" . $_POST['search']['value'] . "%'";
						$firstnos += 1;
					}
				}//for
			}//if
		}
		
	   if($orderb!=""){
		   $Condition = $Condition . " " . $orderb;
	   }else{
		   $Condition = $Condition;
	   }
	
		
		
		$page = 1;
		if(!empty($_POST['page'])) $page = (int)$_POST['page'];

		$recordsPerPage = 10;
		if(!empty($_POST['length'])) $recordsPerPage = (int)$_POST['length'];

		$start = 0;
		if(!empty($_POST['start'])) $start = (int)$_POST['start'];
		
		$noOfRecords = 0;
		
		$sql="SET @rownum := 0;";
		$command = $conn->createCommand($sql)->execute();
		
		//$sql = "SELECT * FROM " . $udb1 . "." . $tbn1;
		
		$sqldbtball = $udb1 . "." . $tbn1 . ".*"; //wpddb.ledrpt_tb.*
		$sqldbtb = $udb1 . "." . $tbn1;
		
		//echo "{$sqldbtball}"; exit;
		
		
		  $sql ="
		   SELECT * FROM (SELECT @rownum := @rownum+1 AS NUMBER, " . $sqldbtball . " FROM  " . $sqldbtb . " " . $Condition . " ) AS TBL
			  WHERE NUMBER BETWEEN :rowstart AND :rowend ;
		  ";
		
		
		$command = $conn->createCommand($sql); 
		$command->bindValue(":rowstart", ($start + 1));	
		$command->bindValue(":rowend", ($start + $recordsPerPage));
		
		$rows = $command->queryAll();
		
		//var_dump($rows);exit;
		
		$arr = array();
		foreach($rows as $dataitem) {
			
			/*$strbtn ='
				<div class="btn-group" role="group">
					<button type="button" class="btn btn-icon btn-info waves-effect waves-classic" title="แสดงโปรไฟล์"><i class="icon md-file" aria-hidden="true"></i>test</button>
				</div>
				';
			$dataitem['btn'] = $strbtn ;
			*/
			
			$arr[] = array_values($dataitem) ;                 
		}
		
		$jsondata = json_encode($rows); //$arr
		
		//var_dump($jsondata);exit;
		
		$sql = "SELECT COUNT(*) As ct FROM " . $sqldbtb . " " . $Condition;

		$command = $conn->createCommand($sql);
		$rows= $command->queryAll();
		$noOfRecords =  $rows[0]['ct'];
		
		echo '{"recordsTotal":' . $noOfRecords . ',"recordsFiltered":' . $noOfRecords . ',"data":'. $jsondata . '}';
		
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}	
		
	}//function
	
	public function actionOpenfileonftp(){
		if(!Yii::app()->user->isGuest) {
	   	if(isset(Yii::app()->user->username)){
		//*********************************************************
			$action = $_POST['action'];
			
			//$localpathf = Yii::app()->Cgentextfile->localpathd; 
			//$remotepathf = Yii::app()->Cgentextfile->remotepathd; 
			
			
			$localDir  = Yii::app()->Cgentextfile->localpathled; //'C:/xampp/htdocs/downloadfile'; //$localpathled;
			$remoteDir = Yii::app()->Cgentextfile->remotepathled; //'/home/wpdusr/uploaddir'; //$remotepathled; 
			
		
			if(Yii::app()->Cgentextfile->getConnectionsftp()){
			  $sftp = ssh2_sftp(Yii::app()->Cgentextfile->conn);
			  $files    = scandir('ssh2.sftp://' . intval($sftp) . $remoteDir);
			  if (!empty($files)) {
			  	foreach ($files as $key => $value){
					if (!in_array($value,array(".",".."))){
						if (is_dir($remoteDir . DIRECTORY_SEPARATOR . $value)){
							$result[$value] = dirToArray($dir . DIRECTORY_SEPARATOR . $value);
						}else{//if
							$result[] = $value;
						}//if
					}//if
				}//foreach
			  }//if
			}//if
			
			//var_dump($result);
			$data1 = array('action' => $action, 'result' => $result);
			$this->layout='nolayout';
			$this->render('/site/searchpages/getfilenameonsftp', $data1);
		
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}//function
	
	public function actionChkmasleddata(){
		
		set_time_limit(0);
		ini_set("max_execution_time","0");
		ini_set("memory_limit","9999M"); 
		
		if(!Yii::app()->user->isGuest) {
	   	if(isset(Yii::app()->user->username)){
		//*********************************************************
			$action = $_POST['action'];
			//echo "{$action}";
			//get data from ledrpt_tb
			$q = new CDbCriteria( array(
				'condition' => "lrpt_status = :lrpt_status ",         
				'params'    => array(':lrpt_status' => 1)  
			));
			$mLedrptTb = LedrptTb::model()->findAll($q);
			$c = count($mLedrptTb);
			if($c != 0){
				$time_start = microtime(true); //เริ่มจับเวลา
				$rc = 0;
				$scc = 0;
				$sce = 0;
				$sc = 0;
				foreach ($mLedrptTb as $rows){
				  $accno = $rows->lrpt_accno;	
				  $registernumber = trim($rows->lrpt_registernumber);
				  //echo "{$registernumber}, {$accno} <br>";
				  //เปรียบเทียบข้อมูลกับ ข้อมูลกลุ่มเสี่ยง
				  $mrc = LedriskcropTb::model()->findByAttributes(array('lrc_registernumber'=>$registernumber, 'lrc_status'=> 1)); //, 
				  if($mrc){
					  //echo "y,{$registernumber} <br>";
					  //เปลี่ยนสถานะกลุ่มเสี่ยง
					  $mrc->lrc_updateby = Yii::app()->user->username;
					  $mrc->lrc_modified = date('Y-m-d H:i:s');
					  $mrc->lrc_status = 2;
					  if($mrc->save()){
						  $msg = "update data is success.";
						  $scc = $scc + 1; //จำนวนสำเร็จ
						  $sc = 0; //สถานะ error
					  }else{
						  $msg = $mrc->getErrors();
						  $sce = $sce + 1; //จำนวน error
						  $sc = 1; //สถานะ error
					  }//if  
				  }//if
				  $rc += 1;
				}//for
				$time_end = microtime(true);
				$execution_time = ($time_end - $time_start)/60;
				if($sc===0){
			    	echo "ปรับปรุงข้อมูลสำเร็จ, ใช้เวลา : {$execution_time} นาที, จำนวนรายการทั้งหมด : {$rc} รายการ สำเร็จ : {$scc} รายการ, ล้มเหลว : {$sce} รายการ";
				}else{
					echo "มีปัญหาในการปรับปรุงข้อมูล , ใช้เวลา : {$execution_time} นาที, จำนวนรายการทั้งหมด : {$rc} รายการ สำเร็จ : {$scc} รายการ, ล้มเหลว : {$sce} รายการ";
				}
			}//if
				  
			
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}	
	}//function
	
	public function actionCallshowrptled33(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		$lrc_id = $_GET['lrc_id'];
		$lrc_accno = $_GET['lrc_accno'];
		$lrc_registernumber = $_GET['lrc_registernumber'];
		//echo "{$lrc_id},{$lrc_accno}";exit;
		
		//ค้นหาชื่อบริษัท
		$mrc = LedriskcropTb::model()->findByAttributes(array('lrc_registernumber'=>$lrc_registernumber));
		if($mrc){
			$lrc_registername = $mrc->lrc_registername;
		}else{
			$lrc_registername = "-";
		}
		
		//ค้นหาชื่อ user
		$musr = Users::model()->findByAttributes(array('username'=>Yii::app()->user->username));
		if($musr){
			$firstname = $musr->firstname;
			$lastname = $musr->lastname;
			$address = $musr->address;
			$username = $musr->username;
			
			$usrprint = $firstname . "  " . $lastname . " , " . $address . " , " . $username;
		}else{
			$usrprint = "-";
		}
		
		
		
		$data1 = array('lrc_id'=>$lrc_id,'lrc_accno'=>$lrc_accno, 'lrc_registernumber' => $lrc_registernumber, 'lrc_registername'=>$lrc_registername, 'usrprint'=> $usrprint);
		
		$this->layout='nolayout';
		$this->pageTitle='report';
		$this->render('/site/reportpages/reportsled33sub', $data1);
		
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}//function
	
	public function actionCallsearchledall(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		$this->layout='nolayout';
		$this->render('/site/searchpages/searchledall2');
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}//function 
	
	
	public function actionCallledservicecall(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
		$time_start = microtime(true);
		
		$action = $_POST['action'];
		$rgn =  $_POST['rgn'];
		//echo "{$action}";
		
		$url = 'https://wsg.sso.go.th:443/v1/GdxWebServiceSam'; //https://services.led.go.th/v1/GdxWebServiceSam

		$data = json_encode(
			array(
				"username" => "SSO001",
				"password" => "",
				"type" => "DATA",
				"firstName" => "",
				"lastName" => "",
				"idCard" => "{$rgn}",
				"reqHeader" => array( "transID" => "SSO20180620",
					"rqAppID" => "SSO",
					"transDateTimestamp" => "20180620",
					"terminalID" => "terminalID",
					"ip" => "127.0.0.1",
					"branchCode" => "001"
					)
			)
		);
		
		$arrContextOptions=array(
			"http" => array(
			  "method" => "POST",
			  "header" =>
				  //"Consumer-Key: 8400dfa3-4fe3-43b9-b830-060d948d75cf", 
				  "Content-Type: application/json; charset=utf-8;\r\n".
				  "Connection: keep-alive\r\n",
				  "ignore_errors" => true,
				  "timeout" => (float)30.0,
				  "content" => $data,
			),
			"ssl"=>array(
				"verify_peer"=>false,
				"verify_peer_name"=>false,
			),
		);  
		
		$content = file_get_contents($url, false, stream_context_create($arrContextOptions));
		
		//echo "<pre>";
		//echo "{$content} <br>";
		//echo "</pre> <br>";
		$abs_prot = "";
		$abs_gaz = "";
		$abs_due = "";
		$bkr_prot = "";
		$req_dt = "";
		$lastudt = "";
		$df_id = "";
		$df_name = "";
		$df_surnme = "";
		
		$json = json_decode($content, true);
        foreach ($json as $key => $value) {
			
            if (!is_array($value)) {
				if($key=='responseCode'){
					if($value=='000'){
					//echo $key . '=>' . $value . '<br>';
						$msg = "บุคคลหรือธุรกิจที่ได้รับคำสั่งจากศาล (ถูกฟ้องล้มละลาย)";
						$st = 2;
					}else if($value=='904'){
						$msg = "ไม่พบบุคคลหรือธุรกิจที่ได้รับคำสั่งจากศาล (ไม่ถูกฟ้องล้มละลาย)";
						$st = 1;
					}else if($value=='909'){
						$msg = "ระบบผิดพลาด";
						$st = 1;
					}else if($value=='901'){
						$msg = "ไม่อนุญาตแอป";
						$st = 1;
					}else if($value=='902'){
						$msg = "TransId ไม่ตรงกัน";
						$st = 1;
					}else if($value=='902'){
						$msg = "ID ผู้ใช้ไม่ได้รับอนุญาต";
						$st = 1;
					}
				}//if
            }//if
			
		if($st===2){
			if($key=='data'){
				//var_dump($value);echo "<br>";
				foreach ($value[0] as $key2 => $value2) {
					//echo "{$key2}:{$value2}<br>";
					//วันที่พิทักษ์ทรัพย์เด็ดขาด
					if($key2=='abs_prot_dd'){
						if($value2){
							$abs_prot = $abs_prot . $value2 . "-";
						}else{
							$abs_prot = "";
						}//if
					}//if
					if($key2=='abs_prot_mm'){
						if($value2){
							$abs_prot = $abs_prot . $value2 . "-";
						}else{
							$abs_prot = "";
						}//if
					}//if
					if($key2=='abs_prot_yy'){
						if($value2){
							$abs_prot = $abs_prot . $value2 . "";
						}else{
							$abs_prot = "";
						}//if
					}//if
					
					//วันที่ประกาศในราชกิจจาฯ
					if($key2=='abs_gaz_dd'){
						if($value2){
							$abs_gaz = $abs_gaz . $value2 . "-";
						}else{
							$abs_gaz = "";
						}//if
					}//if
					if($key2=='abs_gaz_mm'){
						if($value2){
							$abs_gaz = $abs_gaz . $value2 . "-";
						}else{
							$abs_gaz = "";
						}//if
					}//if
					if($key2=='abs_gaz_yy'){
						if($value2){
							$abs_gaz = $abs_gaz . $value2 . "";
						}else{
							$abs_gaz = "";
						}//if
					}//if
					
					//วันครบกำหนดยื่นคำขอรับชำระหนี้
					if($key2=='abs_due_dd'){
						if($value2){
							$abs_due = $abs_due . $value2 . "-";
						}else{
							$abs_due = "";
						}//if
					}//if
					if($key2=='abs_due_mm'){
						if($value2){
							$abs_due = $abs_due . $value2 . "-";
						}else{
							$abs_due = "";
						}//if
					}//if
					if($key2=='abs_due_yy'){
						if($value2){
							$abs_due = $abs_due . $value2 . "";
						}else{
							$abs_due = "";
						}//if
					}//if
					
					//วันที่พิพากษาให้ล้มละลาย
					if($key2=='bkr_prot_dd'){
						if($value2){
							$bkr_prot = $bkr_prot . $value2 . "-";
						}else{
							$bkr_prot = "";
						}//if
					}//if
					if($key2=='bkr_prot_mm'){
						if($value2){
							$bkr_prot = $bkr_prot . $value2 . "-";
						}else{
							$bkr_prot = "";
						}//if
					}//if
					if($key2=='bkr_prot_yy'){
						if($value2){
							$bkr_prot = $bkr_prot . $value2 . "";
						}else{
							$bkr_prot = "";
						}//if
					}//if
					
					//วันที่ฟ้อง
					if($key2=='req_dd'){
						if($value2){
							$req_dt = $req_dt . $value2 . "-";
						}else{
							$req_dt = "";
						}//if
					}//if
					if($key2=='req_mm'){
						if($value2){
							$req_dt = $req_dt . $value2 . "-";
						}else{
							$req_dt = "";
						}//if
					}//if
					if($key2=='req_yy'){
						if($value2){
							$req_dt = $req_dt . $value2 . "";
						}else{
							$req_dt = "";
						}//if
					}//if
					
					//วันทีปรับปรุงล่าสุด
					if($key2=='lastupdate'){
						if($value2){
							$lastudt = $lastudt . $value2;
						}else{
							$lastudt = "";
						}//if
					}//if
					
					//เลขประจำตัว
					if($key2=='df_id'){
						if($value2){
							$df_id = $df_id . $value2;
						}else{
							$df_id = "";
						}//if
					}//if
					
					//ชื่อจำเลย
					if($key2=='df_name'){
						if($value2){
							$df_name = $df_name . $value2;
						}else{
							$df_name = "";
						}//if
					}//if
					
					//สกุลจำเลย
					if($key2=='df_surname'){
						if($value2){
							$df_surname = $df_surname . $value2;
						}else{
							$df_surname = "";
						}//if
					}//if
					
				}//foreach
				
			}//if
		}//if
			
        }//foreach
		
		//echo "{$abs_prot} , {$abs_gaz}, {$abs_due}, {$bkr_prot}, {$req_dt}, {$lastudt}, {$df_id}, {$df_name}, {$df_surname}";
		//เริ่มบันทึกข้อมูล update model Ledriskcrop2Tb
		if($st===2){
			$msg3 = "วันที่พิทักษ์ทรัพย์เด็ดขาด => {$abs_prot} <br> วันที่ประกาศในราชกิจจา => {$abs_gaz} <br> วันที่ครบกำหนดยื่นคำขอฯ => {$abs_due} <br> วันที่ฟ้อง => {$req_dt} <br> วันที่ปรับปรุงล่าสุด => {$lastudt} <br>วันที่พิพากษาให้ล้มละลาย => {$bkr_prot} <br>";
		}else if($st===1){
			$msg3 = "";
		}
		//exit;
		
		//บันทึกว่า มีการ สอบถามข้อมูลล่าสุดเมื่อไหร่โดยใคร
		$mrc = Ledriskcrop2Tb::model()->findByAttributes(array('lrc_registernumber'=>$rgn)); //, 
		if($mrc){
			//echo "y,{$registernumber} <br>";
			//เปลี่ยนสถานะกลุ่มเสี่ยง
		   if($st===1){
			$mrc->lrc_updateby = Yii::app()->user->username;
			$mrc->lrc_modified = date('Y-m-d H:i:s');
			$mrc->lrc_status = $st;
			if($mrc->save()){
				$msg2 = "";
				//$scc = $scc + 1; //จำนวนสำเร็จ
				//$sc = 0; //สถานะ error
			}else{
				$msg2 = $mrc->getErrors();
				//$sce = $sce + 1; //จำนวน error
				//$sc = 1; //สถานะ error
			}//if 
		   }//if
		   
		   if($st===2){
			$mrc->lrc_updateby = Yii::app()->user->username;
			$mrc->lrc_modified = date('Y-m-d H:i:s');
			$mrc->lrc_status = $st;
			$mrc->lrpt_abs_prot = $abs_prot;
  			$mrc->lrpt_abs_gaz = $abs_gaz;
			$mrc->lrpt_abs_due = $abs_due;
			$mrc->lrpt_bkr_prot = $bkr_prot;
			$mrc->lrpt_req = $req_dt;
			$mrc->lrpt_lastupdate = $lastudt;
			$mrc->lrpt_df_id = $df_id;
			$mrc->lrpt_df_name = $df_name;
			$mrc->lrpt_df_surname = $df_surname;
			if($mrc->save()){
				$msg2 = "";
				//$scc = $scc + 1; //จำนวนสำเร็จ
				//$sc = 0; //สถานะ error
			}else{
				$msg2 = $mrc->getErrors();
				//$sce = $sce + 1; //จำนวน error
				//$sc = 1; //สถานะ error
			}//if 
		   }//if
		   
		}//if
		
		echo "เลข 13 หลัก: {$rgn}<br>{$msg}, {$msg2} <br>";
		echo "{$msg3} <br>";
		
		$time_end = microtime(true);
		$execution_time = ($time_end - $time_start)/60;
		echo '<b>ใช้เวลาเรียก service:</b> '.$execution_time.' Mins <br>';
		//*********************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}//function

	public function actionWpdfortxtfile(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//**************************************************************
			$bgdate = $_POST['bgdate'];
			$eddate = $_POST['eddate'];
			//echo "{$bgdate},{$eddate}";
			$data1 = array('bgdate' => $bgdate, 'eddate' => $eddate);
			$this->layout='nolayout';
			$this->render('/site/servicepages/wpdfortxtfile', $data1);
		//**************************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}//function
	
	public function actionGentxtfilewpd(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//**************************************************************
			$bgdate = $_POST['bgdate'];
			$eddate = $_POST['eddate'];
			//echo "{$bgdate},{$eddate}";
			$data1 = array('bgdate' => $bgdate, 'eddate' => $eddate);
			$this->layout='nolayout';
			$this->render('/site/servicepages/gentxtfileforwpd', $data1);
		//**************************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}//if
	}//function
	
	public function actionGetfilenamesapains(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//**************************************************************
			//echo "Get filename from sapains";
			$this->layout='nolayout';
			$this->render('/site/servicepages/getfilenamesapains');
		//**************************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}//if
	}//function
	
	public function actionGentxtfilesapeains(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//**************************************************************
			$tfn = $_POST['tfn'];
			//echo "{$tfn}";
			$data1 = array('tfn' => $tfn);
			$this->layout='nolayout';
			$this->render('/site/servicepages/gentxtfileforsapains', $data1);
		//**************************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}//if
	}//function
	
		public function actionWritesapeainsall(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//**************************************************************
			$tfns = $_POST['tfns'];
			$tfnsa = "sapainsall.txt";
			//ตรวจสอบว่ามีเท็กซ์ไฟล์ชื่อ sapainsall.txt แล้วหรือยัง
			$filename = $_SERVER['DOCUMENT_ROOT'] . "/wpdtextfile/sapains/" . $tfnsa;
			$filename2 = $_SERVER['DOCUMENT_ROOT'] . "/wpdtextfile/sapains/" . $tfns;
			if (file_exists($filename)) {
				//------กรณีที่มีไฟล์อยู่แล้ว---------------------------------
				
			} else {
				//------กรณีที่ยังไม่มีไฟล์----------------------------------
				//------สร้างไฟล์ sapainsall.txt------------------------
					$file = fopen($filename,"w") or die("Unable to open file!");
						$content = "";
  						fwrite($file,$content);
  					fclose($file);
				//--------------------------------------------------
			}//if
			
			//เริ่มอ่านไฟล์ทั้งหมดว่ามีข้อมูลถึงบรรทัดไหน
			//echo readfile($filename);//อ่านไฟล์แสดงข้อมูลในไฟล์ และ จำนวน column
			if(readfile($filename2)!=0){ //แสดงว่ายังไเป็นไฟล์ว่างไม่มีข้อความ
				//อ่านไฟล์ที่2
				$myfile2 = fopen($filename2, "r") or die("Unable to open file!");
					$myfilecontent2 = fread($myfile2,filesize($filename2));
				fclose($myfile2);
				//เขียนไฟล์รวมต่อจากบรรทัดสุดท้าย
				$data = $myfilecontent2; // . PHP_EOL;
				$fp = fopen($filename, 'a') or die("Unable to open file!");
			 		if(fwrite($fp, $data)){
						$wok = 'y';
					}else{
						$wok = 'n';
					}
				fclose($fp);
			}else{//if
				$wok = 'n';
			}
			
			if($wok==='y'){ //ถ้าเขียนไฟล์เพิ่มสำเร็จ
				//อัปเดทข้อมูลสถานะในตาราง sapainstxtfile2_tb
				$anb=Sapainstxtfile2Tb::model()->findByAttributes(array('sptf_filename'=>$tfns));
				$anb->sptf_updateby = Yii::app()->user->username;
				$anb->sptf_modified = date('Y-m-d H:i:s');
				$anb->sptf_remark = "-";
				$anb->sptf_status = 2;
				if($anb->save()){
					$msg3 = "update data is success.";
				}else{
					$msg3 = "can't update data.";
				}
				echo "y";
			}else{//if
				echo "n";
			}
			
			//echo "เชียนไฟล์รวม เรียบร้อยแล้ว.";
			
			/*$myfile = fopen($filename, "r") or die("Unable to open file!");
				//var_dump($myfile);
				//echo "{$myfile}";
				//echo fread($myfile,filesize($filename)); //read all contineus line 
				//echo fgets($myfile); //read 1 line
				/*while(!feof($myfile)) {// Output one line until end-of-file
				  echo fgets($myfile); //read ที่ละ 1 บรรทัด จนกว่าจะหมดทุกบรรทัด
				}*/
				//readfile to array
				/* $datastr  = fgets($myfile);
	             $arraystr = explode(";", $datastr);
	  			 $t1 = trim($arraystr[0]);
	  			 $t2 = trim($arraystr[1]);
	  			 $t3 = trim($arraystr[2]);
	  			 echo "{$t1}, {$t2}, {$t3}";*/
				 //อ่านไฟล์เก็บไว้ในตัวแปร
				// $myfilecontent = fread($myfile,filesize($filename));
				 //echo "{$myfilecontent}";
			//fclose($myfile);
			
			/*$myfile2 = fopen($filename2, "r") or die("Unable to open file!");
				$myfilecontent2 = fread($myfile2,filesize($filename2));
			fclose($myfile2);
			
			$newcontent = $myfilecontent . "\r\n" . $myfilecontent2;
			
			$data = $myfilecontent2; // . PHP_EOL;
			$fp = fopen($filename, 'a') or die("Unable to open file!");
			 fwrite($fp, $data);
			fclose($fp);*/
			
		//**************************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}//if
	}//function 
	
		public function actionGetfilenamewpd(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//**************************************************************
		  $action = $_POST['action'];
	
		  $data1 = array('action' => $action);
		  $this->layout='nolayout';
		  $this->render('/site/searchpages/getfilenamewpd', $data1);
		  
		//**************************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}//if
	}//function
	
	public function actionGetfilenamesapeains(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//**************************************************************
		  $action = $_POST['action'];
		  $data1 = array('action' => $action);
		  $this->layout='nolayout';
		  $this->render('/site/searchpages/getfilenamesapeains', $data1);
		//**************************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}//if
	}//function
	
	public function actionCleansingdata1(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//**************************************************************
			$action = $_POST['action'];
			$wpdtxt = $_POST['wpdtxt'];
			$sapeinstxt = $_POST['sapeinstxt'];
			$filenamewpd = $_SERVER['DOCUMENT_ROOT'] . "/wpdtextfile/wpd/" . $wpdtxt;
			$filenamesapeins = $_SERVER['DOCUMENT_ROOT'] . "/wpdtextfile/sapains/" . $sapeinstxt;
			
			//echo "{$action}, {$wpdtxt}, {$sapeinstxt} <br> {$filenamewpd} <br> {$filenamesapeins}";
			//$myfilewpd = fopen($filenamewpd, "r") or die("Unable to open file!"); //เปิดไฟล์แบบอ่านอย่างเดียว
				//echo fread($myfilewpd,filesize($filenamewpd)); //read all contineus line 
				//echo fgets($myfilewpd); //read 1 line
				/*while(!feof($myfilewpd)) {// Output one line until end-of-file
				  echo fgets($myfilewpd); //read ที่ละ 1 บรรทัด จนกว่าจะหมดทุกบรรทัด
				}*/
				 //อ่านไฟล์เก็บไว้ในตัวแปร
				/*$myfilewpdcontent = fread($myfilewpd,filesize($filenamewpd));
				 echo "{$myfilewpdcontent}";*/
				 //readfile to array
				 /*$r = 1;
				 while(!feof($myfilewpd)) {
				 	$datastrwpd  = fgets($myfilewpd);
	             	$arraystrwpd = explode(",", $datastrwpd);
	  			 	$t1 = trim($arraystrwpd[0]);
	  			 	//$t2 = trim($arraystrwpd[1]);
	  			 	//$t3 = trim($arraystrwpd[2]);
	  			 	echo "{$r},{$t1} <br>";
					$r += 1;
				 }//*/
			//fclose($myfilewpd); //ปิดไฟล์
			
			$file_content_sapeins = file_get_contents($filenamesapeins);
			echo "{$file_content_sapeins}";
			
			
			$file_content_wpd = file_get_contents($filenamewpd);
			//echo "{$file_content_wpd}";
			$data = explode("\n", $file_content_wpd); 
			foreach($data as $key=>$value){
				//echo "{$key} : {$value}";
				$arraystrwpd = explode(",", $value);
				$registernumberwpd = trim($arraystrwpd[0]);
				echo "{$registernumberwpd}";
				
				//$content_clensing_string = strstr($file_content_sapeins, $registernumberwpd, true);
				//echo "{$content_clensing_string}";
				/*if (false !== $content_clensing_string) {
					echo "yes";
				}else{//if
					//
				}*/
			}//for
			
		//**************************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}//if
	}//function
	
		public function actionUpdatecleansingdata(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//**************************************************************
		
			$action = $_POST['action'];
			$clstxt = $_POST['clstxt'];
			$filenamewpd = $_SERVER['DOCUMENT_ROOT'] . "/wpdtextfile/wpd/" . $clstxt;
		
				/*$regis_no[0]  = "0105562158662";
				$regis_no[1]  = "0485562000659";
				
				
				$acc_no_wpd[0] = "1020005378";
				$acc_no_wpd[1] = "4820000080";
				
				
				$acc_no_sapeins[0] = "1002921945";
				$acc_no_sapeins[1] = "4800000080";*/
				
			
//***************************************************************
$regis_no[0]=	"	0103556056525	";
$regis_no[1]=	"	0103562014022	";
$regis_no[2]=	"	0103562014197	";
$regis_no[3]=	"	0103562014227	";
$regis_no[4]=	"	0103562014286	";
$regis_no[5]=	"	0103562014481	";
$regis_no[6]=	"	0103562015126	";
$regis_no[7]=	"	0103562015584	";
$regis_no[8]=	"	0103562015827	";
$regis_no[9]=	"	0103562016599	";
$regis_no[10]=	"	0103562016670	";
$regis_no[11]=	"	0103562016769	";
$regis_no[12]=	"	0103562017021	";
$regis_no[13]=	"	0103562017129	";
$regis_no[14]=	"	0103562017536	";
$regis_no[15]=	"	0103562017552	";
$regis_no[16]=	"	0103562018109	";
$regis_no[17]=	"	0105557185215	";
$regis_no[18]=	"	0105562006633	";
$regis_no[19]=	"	0105562149957	";
$regis_no[20]=	"	0105562150017	";
$regis_no[21]=	"	0105562150084	";
$regis_no[22]=	"	0105562150254	";
$regis_no[23]=	"	0105562150327	";
$regis_no[24]=	"	0105562150335	";
$regis_no[25]=	"	0105562150343	";
$regis_no[26]=	"	0105562150971	";
$regis_no[27]=	"	0105562151111	";
$regis_no[28]=	"	0105562151188	";
$regis_no[29]=	"	0105562151200	";
$regis_no[30]=	"	0105562151293	";
$regis_no[31]=	"	0105562151731	";
$regis_no[32]=	"	0105562151773	";
$regis_no[33]=	"	0105562151901	";
$regis_no[34]=	"	0105562151978	";
$regis_no[35]=	"	0105562152125	";
$regis_no[36]=	"	0105562152290	";
$regis_no[37]=	"	0105562152532	";
$regis_no[38]=	"	0105562152648	";
$regis_no[39]=	"	0105562152656	";
$regis_no[40]=	"	0105562152672	";
$regis_no[41]=	"	0105562152826	";
$regis_no[42]=	"	0105562152834	";
$regis_no[43]=	"	0105562152907	";
$regis_no[44]=	"	0105562152940	";
$regis_no[45]=	"	0105562153083	";
$regis_no[46]=	"	0105562153121	";
$regis_no[47]=	"	0105562153130	";
$regis_no[48]=	"	0105562153415	";
$regis_no[49]=	"	0105562153458	";
$regis_no[50]=	"	0105562153512	";
$regis_no[51]=	"	0105562153547	";
$regis_no[52]=	"	0105562153610	";
$regis_no[53]=	"	0105562154756	";
$regis_no[54]=	"	0105562154764	";
$regis_no[55]=	"	0105562154781	";
$regis_no[56]=	"	0105562155311	";
$regis_no[57]=	"	0105562155361	";
$regis_no[58]=	"	0105562156198	";
$regis_no[59]=	"	0105562156996	";
$regis_no[60]=	"	0105562157178	";
$regis_no[61]=	"	0105562157330	";
$regis_no[62]=	"	0105562157518	";
$regis_no[63]=	"	0105562157895	";
$regis_no[64]=	"	0105562157925	";
$regis_no[65]=	"	0105562157968	";
$regis_no[66]=	"	0105562158557	";
$regis_no[67]=	"	0105562158760	";
$regis_no[68]=	"	0105562158875	";
$regis_no[69]=	"	0105562158913	";
$regis_no[70]=	"	0105562158948	";
$regis_no[71]=	"	0105562158956	";
$regis_no[72]=	"	0105562159006	";
$regis_no[73]=	"	0105562159278	";
$regis_no[74]=	"	0105562159677	";
$regis_no[75]=	"	0105562159685	";
$regis_no[76]=	"	0105562159758	";
$regis_no[77]=	"	0105562160349	";
$regis_no[78]=	"	0105562160365	";
$regis_no[79]=	"	0105562160381	";
$regis_no[80]=	"	0105562160721	";
$regis_no[81]=	"	0105562160781	";
$regis_no[82]=	"	0105562161078	";
$regis_no[83]=	"	0105562162074	";
$regis_no[84]=	"	0105562162104	";
$regis_no[85]=	"	0105562162210	";
$regis_no[86]=	"	0105562162236	";
$regis_no[87]=	"	0105562162261	";
$regis_no[88]=	"	0105562162376	";
$regis_no[89]=	"	0105562162490	";
$regis_no[90]=	"	0105562162911	";
$regis_no[91]=	"	0105562163020	";
$regis_no[92]=	"	0105562163038	";
$regis_no[93]=	"	0105562163089	";
$regis_no[94]=	"	0105562163186	";
$regis_no[95]=	"	0105562163968	";
$regis_no[96]=	"	0105562164166	";
$regis_no[97]=	"	0105562164255	";
$regis_no[98]=	"	0105562164841	";
$regis_no[99]=	"	0105562164913	";
$regis_no[100]=	"	0105562165031	";
$regis_no[101]=	"	0105562165103	";
$regis_no[102]=	"	0105562165308	";
$regis_no[103]=	"	0105562165758	";
$regis_no[104]=	"	0105562165774	";
$regis_no[105]=	"	0105562165944	";
$regis_no[106]=	"	0105562166576	";
$regis_no[107]=	"	0105562166673	";
$regis_no[108]=	"	0105562166762	";
$regis_no[109]=	"	0105562166851	";
$regis_no[110]=	"	0105562167505	";
$regis_no[111]=	"	0105562167611	";
$regis_no[112]=	"	0105562167921	";
$regis_no[113]=	"	0105562168064	";
$regis_no[114]=	"	0105562168846	";
$regis_no[115]=	"	0105562168986	";
$regis_no[116]=	"	0105562169133	";
$regis_no[117]=	"	0105562169401	";
$regis_no[118]=	"	0105562169702	";
$regis_no[119]=	"	0105562169877	";
$regis_no[120]=	"	0105562170018	";
$regis_no[121]=	"	0105562170590	";
$regis_no[122]=	"	0105562171197	";
$regis_no[123]=	"	0105562171219	";
$regis_no[124]=	"	0105562171511	";
$regis_no[125]=	"	0105562171545	";
$regis_no[126]=	"	0105562171600	";
$regis_no[127]=	"	0105562171685	";
$regis_no[128]=	"	0105562172037	";
$regis_no[129]=	"	0105562172835	";
$regis_no[130]=	"	0105562172908	";
$regis_no[131]=	"	0105562173041	";
$regis_no[132]=	"	0105562173700	";
$regis_no[133]=	"	0105562173955	";
$regis_no[134]=	"	0105562174005	";
$regis_no[135]=	"	0105562174765	";
$regis_no[136]=	"	0105562175354	";
$regis_no[137]=	"	0105562176377	";
$regis_no[138]=	"	0105562177187	";
$regis_no[139]=	"	0105562177608	";
$regis_no[140]=	"	0105562177764	";
$regis_no[141]=	"	0105562178141	";
$regis_no[142]=	"	0105562178256	";
$regis_no[143]=	"	0105562178400	";
$regis_no[144]=	"	0105562178981	";
$regis_no[145]=	"	0105562179210	";
$regis_no[146]=	"	0105562179392	";
$regis_no[147]=	"	0105562179694	";
$regis_no[148]=	"	0105562179783	";
$regis_no[149]=	"	0105562179953	";
$regis_no[150]=	"	0105562180137	";
$regis_no[151]=	"	0105562180323	";
$regis_no[152]=	"	0105562180374	";
$regis_no[153]=	"	0105562180471	";
$regis_no[154]=	"	0105562180552	";
$regis_no[155]=	"	0105562180617	";
$regis_no[156]=	"	0105562180838	";
$regis_no[157]=	"	0105562180935	";
$regis_no[158]=	"	0105562181079	";
$regis_no[159]=	"	0105562181176	";
$regis_no[160]=	"	0105562181354	";
$regis_no[161]=	"	0105562181621	";
$regis_no[162]=	"	0105562181745	";
$regis_no[163]=	"	0105562181834	";
$regis_no[164]=	"	0105562182024	";
$regis_no[165]=	"	0105562182725	";
$regis_no[166]=	"	0105562183161	";
$regis_no[167]=	"	0105562183390	";
$regis_no[168]=	"	0105562183471	";
$regis_no[169]=	"	0105562183527	";
$regis_no[170]=	"	0105562183845	";
$regis_no[171]=	"	0105562184540	";
$regis_no[172]=	"	0105562184591	";
$regis_no[173]=	"	0105562185171	";
$regis_no[174]=	"	0105562185279	";
$regis_no[175]=	"	0105562185562	";
$regis_no[176]=	"	0105562186160	";
$regis_no[177]=	"	0105562186666	";
$regis_no[178]=	"	0105562186950	";
$regis_no[179]=	"	0105562187077	";
$regis_no[180]=	"	0105562187239	";
$regis_no[181]=	"	0105562187646	";
$regis_no[182]=	"	0105562188111	";
$regis_no[183]=	"	0105562188880	";
$regis_no[184]=	"	0105562189118	";
$regis_no[185]=	"	0105562189321	";
$regis_no[186]=	"	0105562189339	";
$regis_no[187]=	"	0105562190086	";
$regis_no[188]=	"	0105562190728	";
$regis_no[189]=	"	0105562191422	";
$regis_no[190]=	"	0105562191538	";
$regis_no[191]=	"	0105562191619	";
$regis_no[192]=	"	0105562191848	";
$regis_no[193]=	"	0105562192844	";
$regis_no[194]=	"	0105562192984	";
$regis_no[195]=	"	0105562193794	";
$regis_no[196]=	"	0105562194987	";
$regis_no[197]=	"	0105562195002	";
$regis_no[198]=	"	0105562195363	";
$regis_no[199]=	"	0105562196181	";
$regis_no[200]=	"	0105562196297	";
$regis_no[201]=	"	0105562196301	";
$regis_no[202]=	"	0105562196343	";
$regis_no[203]=	"	0105562196891	";
$regis_no[204]=	"	0105562197722	";
$regis_no[205]=	"	0105562197773	";
$regis_no[206]=	"	0105562197846	";
$regis_no[207]=	"	0105562198397	";
$regis_no[208]=	"	0105562198621	";
$regis_no[209]=	"	0105562198915	";
$regis_no[210]=	"	0105562199016	";
$regis_no[211]=	"	0105562199121	";
$regis_no[212]=	"	0105562199237	";
$regis_no[213]=	"	0105562200821	";
$regis_no[214]=	"	0105562201771	";
$regis_no[215]=	"	0105562202017	";
$regis_no[216]=	"	0105562202874	";
$regis_no[217]=	"	0105562202921	";
$regis_no[218]=	"	0105562203404	";
$regis_no[219]=	"	0105562203561	";
$regis_no[220]=	"	0105562203650	";
$regis_no[221]=	"	0105562204079	";
$regis_no[222]=	"	0105562204761	";
$regis_no[223]=	"	0105562208309	";
$regis_no[224]=	"	0105562208414	";
$regis_no[225]=	"	0105563000477	";
$regis_no[226]=	"	0105563000761	";
$regis_no[227]=	"	0105563001376	";
$regis_no[228]=	"	0105563004502	";
$regis_no[229]=	"	0105563005002	";
$regis_no[230]=	"	0105563005827	";
$regis_no[231]=	"	0105563006564	";
$regis_no[232]=	"	0105563006700	";
$regis_no[233]=	"	0105563006785	";
$regis_no[234]=	"	0105563010910	";
$regis_no[235]=	"	0105563011746	";
$regis_no[236]=	"	0107562000378	";
$regis_no[237]=	"	0107562000424	";
$regis_no[238]=	"	0107562000441	";
$regis_no[239]=	"	0107562000459	";
$regis_no[240]=	"	0107562000475	";
$regis_no[241]=	"	0113562004710	";
$regis_no[242]=	"	0113562005074	";
$regis_no[243]=	"	0113562005309	";
$regis_no[244]=	"	0113562005341	";
$regis_no[245]=	"	0113562005384	";
$regis_no[246]=	"	0115562023163	";
$regis_no[247]=	"	0115562023180	";
$regis_no[248]=	"	0115562023236	";
$regis_no[249]=	"	0115562023244	";
$regis_no[250]=	"	0115562023279	";
$regis_no[251]=	"	0115562023597	";
$regis_no[252]=	"	0115562023970	";
$regis_no[253]=	"	0115562024321	";
$regis_no[254]=	"	0115562024542	";
$regis_no[255]=	"	0115562026154	";
$regis_no[256]=	"	0115562026227	";
$regis_no[257]=	"	0115562026448	";
$regis_no[258]=	"	0115562026511	";
$regis_no[259]=	"	0115562027169	";
$regis_no[260]=	"	0115562027843	";
$regis_no[261]=	"	0115562027916	";
$regis_no[262]=	"	0115562027983	";
$regis_no[263]=	"	0115562029277	";
$regis_no[264]=	"	0115562029285	";
$regis_no[265]=	"	0115562029439	";
$regis_no[266]=	"	0115562029668	";
$regis_no[267]=	"	0115562029811	";
$regis_no[268]=	"	0115562030062	";
$regis_no[269]=	"	0115562030232	";
$regis_no[270]=	"	0115562030437	";
$regis_no[271]=	"	0115562031727	";
$regis_no[272]=	"	0115563000043	";
$regis_no[273]=	"	0115563000124	";
$regis_no[274]=	"	0115563000132	";
$regis_no[275]=	"	0123562003870	";
$regis_no[276]=	"	0123562003934	";
$regis_no[277]=	"	0123562003942	";
$regis_no[278]=	"	0123562004361	";
$regis_no[279]=	"	0123562004477	";
$regis_no[280]=	"	0123562004515	";
$regis_no[281]=	"	0123562005121	";
$regis_no[282]=	"	0123562005261	";
$regis_no[283]=	"	0125562027711	";
$regis_no[284]=	"	0125562027720	";
$regis_no[285]=	"	0125562027894	";
$regis_no[286]=	"	0125562028084	";
$regis_no[287]=	"	0125562028173	";
$regis_no[288]=	"	0125562028181	";
$regis_no[289]=	"	0125562028246	";
$regis_no[290]=	"	0125562028343	";
$regis_no[291]=	"	0125562028513	";
$regis_no[292]=	"	0125562028581	";
$regis_no[293]=	"	0125562028637	";
$regis_no[294]=	"	0125562028963	";
$regis_no[295]=	"	0125562029005	";
$regis_no[296]=	"	0125562029030	";
$regis_no[297]=	"	0125562029421	";
$regis_no[298]=	"	0125562029641	";
$regis_no[299]=	"	0125562030020	";
$regis_no[300]=	"	0125562030135	";
$regis_no[301]=	"	0125562030160	";
$regis_no[302]=	"	0125562030330	";
$regis_no[303]=	"	0125562030631	";
$regis_no[304]=	"	0125562030721	";
$regis_no[305]=	"	0125562031310	";
$regis_no[306]=	"	0125562031557	";
$regis_no[307]=	"	0125562031751	";
$regis_no[308]=	"	0125562032413	";
$regis_no[309]=	"	0125562033100	";
$regis_no[310]=	"	0125562033398	";
$regis_no[311]=	"	0125562033436	";
$regis_no[312]=	"	0125562033665	";
$regis_no[313]=	"	0125562034114	";
$regis_no[314]=	"	0125562034629	";
$regis_no[315]=	"	0125562034742	";
$regis_no[316]=	"	0125562034831	";
$regis_no[317]=	"	0125562035161	";
$regis_no[318]=	"	0125562035293	";
$regis_no[319]=	"	0125562035994	";
$regis_no[320]=	"	0125562036508	";
$regis_no[321]=	"	0125562037067	";
$regis_no[322]=	"	0125562037075	";
$regis_no[323]=	"	0125562037326	";
$regis_no[324]=	"	0125562037962	";
$regis_no[325]=	"	0125562038021	";
$regis_no[326]=	"	0125562038039	";
$regis_no[327]=	"	0135562021683	";
$regis_no[328]=	"	0135562022027	";
$regis_no[329]=	"	0135562022795	";
$regis_no[330]=	"	0135562025794	";
$regis_no[331]=	"	0135562025816	";
$regis_no[332]=	"	0135562026391	";
$regis_no[333]=	"	0135562027517	";
$regis_no[334]=	"	0135562028017	";
$regis_no[335]=	"	0135562028025	";
$regis_no[336]=	"	0135562028050	";
$regis_no[337]=	"	0135563000175	";
$regis_no[338]=	"	0143562001851	";
$regis_no[339]=	"	0143562002369	";
$regis_no[340]=	"	0145562004096	";
$regis_no[341]=	"	0145562004347	";
$regis_no[342]=	"	0145562004649	";
$regis_no[343]=	"	0145562005351	";
$regis_no[344]=	"	0145562005378	";
$regis_no[345]=	"	0145563000159	";
$regis_no[346]=	"	0153563000041	";
$regis_no[347]=	"	0165562001593	";
$regis_no[348]=	"	0165562001780	";
$regis_no[349]=	"	0165562001844	";
$regis_no[350]=	"	0173562000277	";
$regis_no[351]=	"	0183562000528	";
$regis_no[352]=	"	0185562000643	";
$regis_no[353]=	"	0185562000660	";
$regis_no[354]=	"	0193562001796	";
$regis_no[355]=	"	0195562002646	";
$regis_no[356]=	"	0195562002689	";
$regis_no[357]=	"	0195562002948	";
$regis_no[358]=	"	0195562002999	";
$regis_no[359]=	"	0203562004166	";
$regis_no[360]=	"	0203562004247	";
$regis_no[361]=	"	0203562004280	";
$regis_no[362]=	"	0203562004298	";
$regis_no[363]=	"	0203562004301	";
$regis_no[364]=	"	0203562004310	";
$regis_no[365]=	"	0203562005359	";
$regis_no[366]=	"	0205561002846	";
$regis_no[367]=	"	0205562032251	";
$regis_no[368]=	"	0205562032501	";
$regis_no[369]=	"	0205562032536	";
$regis_no[370]=	"	0205562032901	";
$regis_no[371]=	"	0205562033397	";
$regis_no[372]=	"	0205562033451	";
$regis_no[373]=	"	0205562033567	";
$regis_no[374]=	"	0205562034041	";
$regis_no[375]=	"	0205562034105	";
$regis_no[376]=	"	0205562034121	";
$regis_no[377]=	"	0205562034318	";
$regis_no[378]=	"	0205562035071	";
$regis_no[379]=	"	0205562035837	";
$regis_no[380]=	"	0205562036124	";
$regis_no[381]=	"	0205562036736	";
$regis_no[382]=	"	0205562037864	";
$regis_no[383]=	"	0205562038976	";
$regis_no[384]=	"	0205562039042	";
$regis_no[385]=	"	0205562039271	";
$regis_no[386]=	"	0205562039743	";
$regis_no[387]=	"	0205562039786	";
$regis_no[388]=	"	0205562040075	";
$regis_no[389]=	"	0205562040776	";
$regis_no[390]=	"	0205562040806	";
$regis_no[391]=	"	0205562041861	";
$regis_no[392]=	"	0205562042311	";
$regis_no[393]=	"	0205562042396	";
$regis_no[394]=	"	0205562044623	";
$regis_no[395]=	"	0205563000271	";
$regis_no[396]=	"	0205563000999	";
$regis_no[397]=	"	0205563003793	";
$regis_no[398]=	"	0213562002392	";
$regis_no[399]=	"	0213562002422	";
$regis_no[400]=	"	0215562008058	";
$regis_no[401]=	"	0215562008163	";
$regis_no[402]=	"	0215562008244	";
$regis_no[403]=	"	0215562008368	";
$regis_no[404]=	"	0215562008538	";
$regis_no[405]=	"	0215562008775	";
$regis_no[406]=	"	0215562009135	";
$regis_no[407]=	"	0215562009224	";
$regis_no[408]=	"	0215562009232	";
$regis_no[409]=	"	0215562009241	";
$regis_no[410]=	"	0215562009437	";
$regis_no[411]=	"	0215562010087	";
$regis_no[412]=	"	0215562010095	";
$regis_no[413]=	"	0215562010532	";
$regis_no[414]=	"	0215562010605	";
$regis_no[415]=	"	0215562011156	";
$regis_no[416]=	"	0215563000565	";
$regis_no[417]=	"	0223562000691	";
$regis_no[418]=	"	0225562001550	";
$regis_no[419]=	"	0225562001576	";
$regis_no[420]=	"	0225562001584	";
$regis_no[421]=	"	0225562001606	";
$regis_no[422]=	"	0225562001649	";
$regis_no[423]=	"	0225562001703	";
$regis_no[424]=	"	0225562001789	";
$regis_no[425]=	"	0225562001860	";
$regis_no[426]=	"	0233562000322	";
$regis_no[427]=	"	0235562000715	";
$regis_no[428]=	"	0235562000723	";
$regis_no[429]=	"	0235562000766	";
$regis_no[430]=	"	0235563000042	";
$regis_no[431]=	"	0235563000123	";
$regis_no[432]=	"	0243562000993	";
$regis_no[433]=	"	0245562003358	";
$regis_no[434]=	"	0245562003412	";
$regis_no[435]=	"	0245562003871	";
$regis_no[436]=	"	0245562003935	";
$regis_no[437]=	"	0255562001819	";
$regis_no[438]=	"	0263562000438	";
$regis_no[439]=	"	0263562000489	";
$regis_no[440]=	"	0303562004602	";
$regis_no[441]=	"	0303562004629	";
$regis_no[442]=	"	0303562004637	";
$regis_no[443]=	"	0303562004823	";
$regis_no[444]=	"	0303562004947	";
$regis_no[445]=	"	0303562004963	";
$regis_no[446]=	"	0303562005226	";
$regis_no[447]=	"	0303562005358	";
$regis_no[448]=	"	0305562005953	";
$regis_no[449]=	"	0305562005961	";
$regis_no[450]=	"	0305562005988	";
$regis_no[451]=	"	0305562006291	";
$regis_no[452]=	"	0305562006372	";
$regis_no[453]=	"	0305562006500	";
$regis_no[454]=	"	0305562006526	";
$regis_no[455]=	"	0305562006721	";
$regis_no[456]=	"	0305562006739	";
$regis_no[457]=	"	0305562006780	";
$regis_no[458]=	"	0305562006801	";
$regis_no[459]=	"	0305562006925	";
$regis_no[460]=	"	0305562007042	";
$regis_no[461]=	"	0305562007166	";
$regis_no[462]=	"	0305562007191	";
$regis_no[463]=	"	0305562007204	";
$regis_no[464]=	"	0305562007221	";
$regis_no[465]=	"	0305562007981	";
$regis_no[466]=	"	0305562008189	";
$regis_no[467]=	"	0313562001531	";
$regis_no[468]=	"	0313562001573	";
$regis_no[469]=	"	0315562001478	";
$regis_no[470]=	"	0315562001630	";
$regis_no[471]=	"	0315562001699	";
$regis_no[472]=	"	0315562001745	";
$regis_no[473]=	"	0315562001770	";
$regis_no[474]=	"	0315562001958	";
$regis_no[475]=	"	0315562002041	";
$regis_no[476]=	"	0323562001379	";
$regis_no[477]=	"	0323562001808	";
$regis_no[478]=	"	0325562001346	";
$regis_no[479]=	"	0325563000017	";
$regis_no[480]=	"	0335562000951	";
$regis_no[481]=	"	0335562001109	";
$regis_no[482]=	"	0335562001150	";
$regis_no[483]=	"	0335562001222	";
$regis_no[484]=	"	0335562001265	";
$regis_no[485]=	"	0335562001273	";
$regis_no[486]=	"	0335562001290	";
$regis_no[487]=	"	0343562002278	";
$regis_no[488]=	"	0343562002413	";
$regis_no[489]=	"	0343562002731	";
$regis_no[490]=	"	0343562002774	";
$regis_no[491]=	"	0343562002855	";
$regis_no[492]=	"	0345562002067	";
$regis_no[493]=	"	0345562002091	";
$regis_no[494]=	"	0345562002105	";
$regis_no[495]=	"	0345562002113	";
$regis_no[496]=	"	0345562002199	";
$regis_no[497]=	"	0345562002334	";
$regis_no[498]=	"	0345562002351	";
$regis_no[499]=	"	0345562002407	";
$regis_no[500]=	"	0345562002415	";
$regis_no[501]=	"	0353562000712	";
$regis_no[502]=	"	0353562000801	";
$regis_no[503]=	"	0353562000810	";
$regis_no[504]=	"	0353563000023	";
$regis_no[505]=	"	0355562000455	";
$regis_no[506]=	"	0355562000528	";
$regis_no[507]=	"	0355562000552	";
$regis_no[508]=	"	0365562000692	";
$regis_no[509]=	"	0365562000731	";
$regis_no[510]=	"	0365563000025	";
$regis_no[511]=	"	0403562003583	";
$regis_no[512]=	"	0403562003664	";
$regis_no[513]=	"	0403562004008	";
$regis_no[514]=	"	0403562004211	";
$regis_no[515]=	"	0403562004521	";
$regis_no[516]=	"	0403563000111	";
$regis_no[517]=	"	0405562003933	";
$regis_no[518]=	"	0405562004000	";
$regis_no[519]=	"	0405562004034	";
$regis_no[520]=	"	0405562004212	";
$regis_no[521]=	"	0405562004255	";
$regis_no[522]=	"	0405562004310	";
$regis_no[523]=	"	0405562004417	";
$regis_no[524]=	"	0405562004425	";
$regis_no[525]=	"	0405562004816	";
$regis_no[526]=	"	0405562004824	";
$regis_no[527]=	"	0405562004891	";
$regis_no[528]=	"	0405562005162	";
$regis_no[529]=	"	0405562005375	";
$regis_no[530]=	"	0405562005391	";
$regis_no[531]=	"	0405562005405	";
$regis_no[532]=	"	0413562002170	";
$regis_no[533]=	"	0413562002307	";
$regis_no[534]=	"	0413562002358	";
$regis_no[535]=	"	0415562001647	";
$regis_no[536]=	"	0415562002783	";
$regis_no[537]=	"	0415562003089	";
$regis_no[538]=	"	0415562003291	";
$regis_no[539]=	"	0423562000720	";
$regis_no[540]=	"	0423562000801	";
$regis_no[541]=	"	0423562000916	";
$regis_no[542]=	"	0425562000802	";
$regis_no[543]=	"	0433562001050	";
$regis_no[544]=	"	0433562001076	";
$regis_no[545]=	"	0433562001122	";
$regis_no[546]=	"	0435562001060	";
$regis_no[547]=	"	0453562001220	";
$regis_no[548]=	"	0455562001019	";
$regis_no[549]=	"	0455562001051	";
$regis_no[550]=	"	0455562001060	";
$regis_no[551]=	"	0465562000799	";
$regis_no[552]=	"	0473562001611	";
$regis_no[553]=	"	0475562000853	";
$regis_no[554]=	"	0475562000918	";
$regis_no[555]=	"	0483562000991	";
$regis_no[556]=	"	0485562000675	";
$regis_no[557]=	"	0485562000845	";
$regis_no[558]=	"	0493562000754	";
$regis_no[559]=	"	0493562000762	";
$regis_no[560]=	"	0493562001076	";
$regis_no[561]=	"	0495562000446	";
$regis_no[562]=	"	0495562000454	";
$regis_no[563]=	"	0495562000489	";
$regis_no[564]=	"	0503562006409	";
$regis_no[565]=	"	0503562006662	";
$regis_no[566]=	"	0503562006832	";
$regis_no[567]=	"	0503562007057	";
$regis_no[568]=	"	0503562007472	";
$regis_no[569]=	"	0503562007685	";
$regis_no[570]=	"	0505562014225	";
$regis_no[571]=	"	0505562014276	";
$regis_no[572]=	"	0505562014446	";
$regis_no[573]=	"	0505562014934	";
$regis_no[574]=	"	0505562015191	";
$regis_no[575]=	"	0505562015736	";
$regis_no[576]=	"	0505562015892	";
$regis_no[577]=	"	0505562015949	";
$regis_no[578]=	"	0505562016694	";
$regis_no[579]=	"	0505562017178	";
$regis_no[580]=	"	0505562017534	";
$regis_no[581]=	"	0505562017992	";
$regis_no[582]=	"	0505562018760	";
$regis_no[583]=	"	0505562018859	";
$regis_no[584]=	"	0505562019006	";
$regis_no[585]=	"	0513562001261	";
$regis_no[586]=	"	0515562001191	";
$regis_no[587]=	"	0515562001204	";
$regis_no[588]=	"	0515562001433	";
$regis_no[589]=	"	0515562001557	";
$regis_no[590]=	"	0515563000040	";
$regis_no[591]=	"	0535562000496	";
$regis_no[592]=	"	0543562000559	";
$regis_no[593]=	"	0545562000569	";
$regis_no[594]=	"	0553562000800	";
$regis_no[595]=	"	0553562000818	";
$regis_no[596]=	"	0553562000877	";
$regis_no[597]=	"	0553562000915	";
$regis_no[598]=	"	0553562000958	";
$regis_no[599]=	"	0553562001083	";
$regis_no[600]=	"	0555562000526	";
$regis_no[601]=	"	0555562000607	";
$regis_no[602]=	"	0563562000826	";
$regis_no[603]=	"	0565562000631	";
$regis_no[604]=	"	0573562002756	";
$regis_no[605]=	"	0573562002764	";
$regis_no[606]=	"	0573562003051	";
$regis_no[607]=	"	0575562003819	";
$regis_no[608]=	"	0575562003894	";
$regis_no[609]=	"	0575562003983	";
$regis_no[610]=	"	0575562004394	";
$regis_no[611]=	"	0603562001830	";
$regis_no[612]=	"	0605562001572	";
$regis_no[613]=	"	0613562000302	";
$regis_no[614]=	"	0615562000371	";
$regis_no[615]=	"	0615562000479	";
$regis_no[616]=	"	0623562001589	";
$regis_no[617]=	"	0625562000746	";
$regis_no[618]=	"	0633562000931	";
$regis_no[619]=	"	0633562000981	";
$regis_no[620]=	"	0635562001246	";
$regis_no[621]=	"	0635562001424	";
$regis_no[622]=	"	0643562000663	";
$regis_no[623]=	"	0653562001716	";
$regis_no[624]=	"	0653562001767	";
$regis_no[625]=	"	0653562002089	";
$regis_no[626]=	"	0655562001947	";
$regis_no[627]=	"	0655562002226	";
$regis_no[628]=	"	0655562002234	";
$regis_no[629]=	"	0655562002307	";
$regis_no[630]=	"	0655562002552	";
$regis_no[631]=	"	0673562001112	";
$regis_no[632]=	"	0673562001163	";
$regis_no[633]=	"	0673562001317	";
$regis_no[634]=	"	0673562001341	";
$regis_no[635]=	"	0673562001376	";
$regis_no[636]=	"	0675562001203	";
$regis_no[637]=	"	0675562001378	";
$regis_no[638]=	"	0675562001432	";
$regis_no[639]=	"	0705562003019	";
$regis_no[640]=	"	0705562003051	";
$regis_no[641]=	"	0705562003060	";
$regis_no[642]=	"	0705562003094	";
$regis_no[643]=	"	0705562003108	";
$regis_no[644]=	"	0705562003159	";
$regis_no[645]=	"	0705562003302	";
$regis_no[646]=	"	0705562003353	";
$regis_no[647]=	"	0705562003639	";
$regis_no[648]=	"	0705562003663	";
$regis_no[649]=	"	0705562003868	";
$regis_no[650]=	"	0705562003957	";
$regis_no[651]=	"	0705562004015	";
$regis_no[652]=	"	0713562000905	";
$regis_no[653]=	"	0715562001636	";
$regis_no[654]=	"	0715562001831	";
$regis_no[655]=	"	0715562002071	";
$regis_no[656]=	"	0715562002152	";
$regis_no[657]=	"	0715562002250	";
$regis_no[658]=	"	0715563000056	";
$regis_no[659]=	"	0715563000251	";
$regis_no[660]=	"	0723562001189	";
$regis_no[661]=	"	0723562001227	";
$regis_no[662]=	"	0723562001251	";
$regis_no[663]=	"	0723562001260	";
$regis_no[664]=	"	0725562002055	";
$regis_no[665]=	"	0725562002217	";
$regis_no[666]=	"	0725562002292	";
$regis_no[667]=	"	0725562002314	";
$regis_no[668]=	"	0725562002331	";
$regis_no[669]=	"	0725562002357	";
$regis_no[670]=	"	0725562002381	";
$regis_no[671]=	"	0725562002390	";
$regis_no[672]=	"	0725562002501	";
$regis_no[673]=	"	0725562002519	";
$regis_no[674]=	"	0725562002527	";
$regis_no[675]=	"	0733562001740	";
$regis_no[676]=	"	0733562001766	";
$regis_no[677]=	"	0733562001987	";
$regis_no[678]=	"	0735562007383	";
$regis_no[679]=	"	0735562007600	";
$regis_no[680]=	"	0735562007618	";
$regis_no[681]=	"	0735562007651	";
$regis_no[682]=	"	0735562007944	";
$regis_no[683]=	"	0735562007987	";
$regis_no[684]=	"	0735562008151	";
$regis_no[685]=	"	0735562008185	";
$regis_no[686]=	"	0735562008452	";
$regis_no[687]=	"	0735562008738	";
$regis_no[688]=	"	0735562008908	";
$regis_no[689]=	"	0735562009068	";
$regis_no[690]=	"	0735562009548	";
$regis_no[691]=	"	0735563000501	";
$regis_no[692]=	"	0743562001812	";
$regis_no[693]=	"	0743562001839	";
$regis_no[694]=	"	0745562008517	";
$regis_no[695]=	"	0745562008584	";
$regis_no[696]=	"	0745562009793	";
$regis_no[697]=	"	0745562009823	";
$regis_no[698]=	"	0745562009955	";
$regis_no[699]=	"	0745562010261	";
$regis_no[700]=	"	0745562010775	";
$regis_no[701]=	"	0745562011101	";
$regis_no[702]=	"	0753562000093	";
$regis_no[703]=	"	0755562000729	";
$regis_no[704]=	"	0755562000745	";
$regis_no[705]=	"	0755562000753	";
$regis_no[706]=	"	0755562000761	";
$regis_no[707]=	"	0755562000796	";
$regis_no[708]=	"	0763562000476	";
$regis_no[709]=	"	0765562001440	";
$regis_no[710]=	"	0773563000097	";
$regis_no[711]=	"	0775562001679	";
$regis_no[712]=	"	0775562002829	";
$regis_no[713]=	"	0775562002837	";
$regis_no[714]=	"	0775562002845	";
$regis_no[715]=	"	0775562003256	";
$regis_no[716]=	"	0775562003485	";
$regis_no[717]=	"	0775562003515	";
$regis_no[718]=	"	0775562003558	";
$regis_no[719]=	"	0775562003574	";
$regis_no[720]=	"	0803562001706	";
$regis_no[721]=	"	0803562001749	";
$regis_no[722]=	"	0803562001901	";
$regis_no[723]=	"	0803562002095	";
$regis_no[724]=	"	0805562002232	";
$regis_no[725]=	"	0805562002241	";
$regis_no[726]=	"	0805562002372	";
$regis_no[727]=	"	0805562002551	";
$regis_no[728]=	"	0805563000039	";
$regis_no[729]=	"	0813562000670	";
$regis_no[730]=	"	0813562000742	";
$regis_no[731]=	"	0815562002364	";
$regis_no[732]=	"	0815562002470	";
$regis_no[733]=	"	0815562002542	";
$regis_no[734]=	"	0815562002615	";
$regis_no[735]=	"	0833562001749	";
$regis_no[736]=	"	0833562001765	";
$regis_no[737]=	"	0835562013943	";
$regis_no[738]=	"	0835562014117	";
$regis_no[739]=	"	0835562014150	";
$regis_no[740]=	"	0835562014192	";
$regis_no[741]=	"	0835562014206	";
$regis_no[742]=	"	0835562014222	";
$regis_no[743]=	"	0835562014435	";
$regis_no[744]=	"	0835562014478	";
$regis_no[745]=	"	0835562014524	";
$regis_no[746]=	"	0835562014567	";
$regis_no[747]=	"	0835562014664	";
$regis_no[748]=	"	0835562014788	";
$regis_no[749]=	"	0835562014834	";
$regis_no[750]=	"	0835562014842	";
$regis_no[751]=	"	0835562014851	";
$regis_no[752]=	"	0835562015237	";
$regis_no[753]=	"	0835562015261	";
$regis_no[754]=	"	0835562015431	";
$regis_no[755]=	"	0835562015644	";
$regis_no[756]=	"	0835562015679	";
$regis_no[757]=	"	0835562015881	";
$regis_no[758]=	"	0835562015903	";
$regis_no[759]=	"	0835562015920	";
$regis_no[760]=	"	0835562015989	";
$regis_no[761]=	"	0835562016055	";
$regis_no[762]=	"	0835562017124	";
$regis_no[763]=	"	0835562017221	";
$regis_no[764]=	"	0835562017230	";
$regis_no[765]=	"	0835562017426	";
$regis_no[766]=	"	0835562017931	";
$regis_no[767]=	"	0835562017965	";
$regis_no[768]=	"	0835562018538	";
$regis_no[769]=	"	0835563000560	";
$regis_no[770]=	"	0835563000586	";
$regis_no[771]=	"	0835563001051	";
$regis_no[772]=	"	0843562002362	";
$regis_no[773]=	"	0843562002818	";
$regis_no[774]=	"	0845562009547	";
$regis_no[775]=	"	0845562009652	";
$regis_no[776]=	"	0845562009717	";
$regis_no[777]=	"	0845562009750	";
$regis_no[778]=	"	0845562009903	";
$regis_no[779]=	"	0845562010324	";
$regis_no[780]=	"	0845562010685	";
$regis_no[781]=	"	0845562010731	";
$regis_no[782]=	"	0845562011134	";
$regis_no[783]=	"	0845562011461	";
$regis_no[784]=	"	0845562011533	";
$regis_no[785]=	"	0845562011673	";
$regis_no[786]=	"	0845562011703	";
$regis_no[787]=	"	0845562011959	";
$regis_no[788]=	"	0845562012521	";
$regis_no[789]=	"	0845563000497	";
$regis_no[790]=	"	0865562001201	";
$regis_no[791]=	"	0865562001244	";
$regis_no[792]=	"	0865562001384	";
$regis_no[793]=	"	0865562001392	";
$regis_no[794]=	"	0865563000012	";
$regis_no[795]=	"	0903557002901	";
$regis_no[796]=	"	0903562002710	";
$regis_no[797]=	"	0903562003074	";
$regis_no[798]=	"	0903562003180	";
$regis_no[799]=	"	0903562003210	";
$regis_no[800]=	"	0905562004765	";
$regis_no[801]=	"	0905562004811	";
$regis_no[802]=	"	0905562004889	";
$regis_no[803]=	"	0905562004919	";
$regis_no[804]=	"	0905562005257	";
$regis_no[805]=	"	0905562005362	";
$regis_no[806]=	"	0905562005419	";
$regis_no[807]=	"	0905562005664	";
$regis_no[808]=	"	0905562005877	";
$regis_no[809]=	"	0905562006164	";
$regis_no[810]=	"	0905562006326	";
$regis_no[811]=	"	0905562006407	";
$regis_no[812]=	"	0905562006482	";
$regis_no[813]=	"	0905562006661	";
$regis_no[814]=	"	0905563000216	";
$regis_no[815]=	"	0913562000237	";
$regis_no[816]=	"	0915562000557	";
$regis_no[817]=	"	0915562000603	";
$regis_no[818]=	"	0915562000620	";
$regis_no[819]=	"	0925562001367	";
$regis_no[820]=	"	0933562000857	";
$regis_no[821]=	"	0935562000646	";
$regis_no[822]=	"	0935562000786	";
$regis_no[823]=	"	0963562000571	";


$acc_no_wpd[0]=	"	1020022116	";
$acc_no_wpd[1]=	"	1020001127	";
$acc_no_wpd[2]=	"	1020002646	";
$acc_no_wpd[3]=	"	1020002336	";
$acc_no_wpd[4]=	"	1020002824	";
$acc_no_wpd[5]=	"	1020004282	";
$acc_no_wpd[6]=	"	1020007800	";
$acc_no_wpd[7]=	"	1020010096	";
$acc_no_wpd[8]=	"	1020012251	";
$acc_no_wpd[9]=	"	1020017937	";
$acc_no_wpd[10]=	"	1020019263	";
$acc_no_wpd[11]=	"	1020020113	";
$acc_no_wpd[12]=	"	1020022868	";
$acc_no_wpd[13]=	"	1020023449	";
$acc_no_wpd[14]=	"	1020026642	";
$acc_no_wpd[15]=	"	1020026413	";
$acc_no_wpd[16]=	"	1020034998	";
$acc_no_wpd[17]=	"	1020020351	";
$acc_no_wpd[18]=	"	1020021268	";
$acc_no_wpd[19]=	"	1020000198	";
$acc_no_wpd[20]=	"	1020000252	";
$acc_no_wpd[21]=	"	1020000210	";
$acc_no_wpd[22]=	"	1020000422	";
$acc_no_wpd[23]=	"	1020000431	";
$acc_no_wpd[24]=	"	1020000490	";
$acc_no_wpd[25]=	"	1020000368	";
$acc_no_wpd[26]=	"	1020000937	";
$acc_no_wpd[27]=	"	1020000775	";
$acc_no_wpd[28]=	"	1020000805	";
$acc_no_wpd[29]=	"	1020000716	";
$acc_no_wpd[30]=	"	1020000741	";
$acc_no_wpd[31]=	"	1020001135	";
$acc_no_wpd[32]=	"	1020001071	";
$acc_no_wpd[33]=	"	1020001046	";
$acc_no_wpd[34]=	"	1020001267	";
$acc_no_wpd[35]=	"	1020001194	";
$acc_no_wpd[36]=	"	1020001445	";
$acc_no_wpd[37]=	"	1020001771	";
$acc_no_wpd[38]=	"	1020001658	";
$acc_no_wpd[39]=	"	1020001518	";
$acc_no_wpd[40]=	"	1020001615	";
$acc_no_wpd[41]=	"	1020001941	";
$acc_no_wpd[42]=	"	1020001861	";
$acc_no_wpd[43]=	"	1020001933	";
$acc_no_wpd[44]=	"	1020001801	";
$acc_no_wpd[45]=	"	1020002051	";
$acc_no_wpd[46]=	"	1020002069	";
$acc_no_wpd[47]=	"	1020002085	";
$acc_no_wpd[48]=	"	1020002123	";
$acc_no_wpd[49]=	"	1020002441	";
$acc_no_wpd[50]=	"	1020002344	";
$acc_no_wpd[51]=	"	1020002611	";
$acc_no_wpd[52]=	"	1020002361	";
$acc_no_wpd[53]=	"	1020003545	";
$acc_no_wpd[54]=	"	1020003472	";
$acc_no_wpd[55]=	"	1020003448	";
$acc_no_wpd[56]=	"	1020003642	";
$acc_no_wpd[57]=	"	1020003391	";
$acc_no_wpd[58]=	"	1020002972	";
$acc_no_wpd[59]=	"	1020004100	";
$acc_no_wpd[60]=	"	1020003863	";
$acc_no_wpd[61]=	"	1020004126	";
$acc_no_wpd[62]=	"	1020004151	";
$acc_no_wpd[63]=	"	1020004606	";
$acc_no_wpd[64]=	"	1020004568	";
$acc_no_wpd[65]=	"	1020004576	";
$acc_no_wpd[66]=	"	1020004720	";
$acc_no_wpd[67]=	"	1020004819	";
$acc_no_wpd[68]=	"	1020004975	";
$acc_no_wpd[69]=	"	1020005050	";
$acc_no_wpd[70]=	"	1020004983	";
$acc_no_wpd[71]=	"	1020004967	";
$acc_no_wpd[72]=	"	1020005203	";
$acc_no_wpd[73]=	"	1020005238	";
$acc_no_wpd[74]=	"	1020005793	";
$acc_no_wpd[75]=	"	1020005661	";
$acc_no_wpd[76]=	"	1020005327	";
$acc_no_wpd[77]=	"	1020006269	";
$acc_no_wpd[78]=	"	1020006102	";
$acc_no_wpd[79]=	"	1020006218	";
$acc_no_wpd[80]=	"	1020006331	";
$acc_no_wpd[81]=	"	1020006285	";
$acc_no_wpd[82]=	"	1020006757	";
$acc_no_wpd[83]=	"	1020006994	";
$acc_no_wpd[84]=	"	1020006986	";
$acc_no_wpd[85]=	"	1020006927	";
$acc_no_wpd[86]=	"	1020007141	";
$acc_no_wpd[87]=	"	1020006889	";
$acc_no_wpd[88]=	"	1020007231	";
$acc_no_wpd[89]=	"	1020007214	";
$acc_no_wpd[90]=	"	1020007486	";
$acc_no_wpd[91]=	"	1020007907	";
$acc_no_wpd[92]=	"	1020007761	";
$acc_no_wpd[93]=	"	1020007648	";
$acc_no_wpd[94]=	"	1020007524	";
$acc_no_wpd[95]=	"	1020008288	";
$acc_no_wpd[96]=	"	1020008083	";
$acc_no_wpd[97]=	"	1020008407	";
$acc_no_wpd[98]=	"	1020008873	";
$acc_no_wpd[99]=	"	1020008679	";
$acc_no_wpd[100]=	"	1020008776	";
$acc_no_wpd[101]=	"	1020008814	";
$acc_no_wpd[102]=	"	1020049065	";
$acc_no_wpd[103]=	"	1020009021	";
$acc_no_wpd[104]=	"	1020009071	";
$acc_no_wpd[105]=	"	1020009144	";
$acc_no_wpd[106]=	"	1020009799	";
$acc_no_wpd[107]=	"	1020009578	";
$acc_no_wpd[108]=	"	1020009624	";
$acc_no_wpd[109]=	"	1020010011	";
$acc_no_wpd[110]=	"	1020010321	";
$acc_no_wpd[111]=	"	1020010274	";
$acc_no_wpd[112]=	"	1020010410	";
$acc_no_wpd[113]=	"	1020010614	";
$acc_no_wpd[114]=	"	1020011211	";
$acc_no_wpd[115]=	"	1020041439	";
$acc_no_wpd[116]=	"	1020011025	";
$acc_no_wpd[117]=	"	1020011378	";
$acc_no_wpd[118]=	"	1020011688	";
$acc_no_wpd[119]=	"	1020011971	";
$acc_no_wpd[120]=	"	1020012005	";
$acc_no_wpd[121]=	"	1020012323	";
$acc_no_wpd[122]=	"	1020012633	";
$acc_no_wpd[123]=	"	1020012374	";
$acc_no_wpd[124]=	"	1020012765	";
$acc_no_wpd[125]=	"	1020012811	";
$acc_no_wpd[126]=	"	1020012889	";
$acc_no_wpd[127]=	"	1020012561	";
$acc_no_wpd[128]=	"	1020013117	";
$acc_no_wpd[129]=	"	1020013494	";
$acc_no_wpd[130]=	"	1020013486	";
$acc_no_wpd[131]=	"	1020013559	";
$acc_no_wpd[132]=	"	1020013991	";
$acc_no_wpd[133]=	"	1020014326	";
$acc_no_wpd[134]=	"	1020014113	";
$acc_no_wpd[135]=	"	1020014831	";
$acc_no_wpd[136]=	"	1020015128	";
$acc_no_wpd[137]=	"	1020015403	";
$acc_no_wpd[138]=	"	1020015993	";
$acc_no_wpd[139]=	"	1020016299	";
$acc_no_wpd[140]=	"	1020017171	";
$acc_no_wpd[141]=	"	1020017023	";
$acc_no_wpd[142]=	"	1020017139	";
$acc_no_wpd[143]=	"	1020016965	";
$acc_no_wpd[144]=	"	1020017457	";
$acc_no_wpd[145]=	"	1020017830	";
$acc_no_wpd[146]=	"	1020018186	";
$acc_no_wpd[147]=	"	1020018381	";
$acc_no_wpd[148]=	"	1020018461	";
$acc_no_wpd[149]=	"	1020018712	";
$acc_no_wpd[150]=	"	1020019131	";
$acc_no_wpd[151]=	"	1020018861	";
$acc_no_wpd[152]=	"	1020018828	";
$acc_no_wpd[153]=	"	1020018984	";
$acc_no_wpd[154]=	"	1020019034	";
$acc_no_wpd[155]=	"	1020019425	";
$acc_no_wpd[156]=	"	1020019956	";
$acc_no_wpd[157]=	"	1020020016	";
$acc_no_wpd[158]=	"	1020019751	";
$acc_no_wpd[159]=	"	1020020148	";
$acc_no_wpd[160]=	"	1020020288	";
$acc_no_wpd[161]=	"	1020021179	";
$acc_no_wpd[162]=	"	1020020407	";
$acc_no_wpd[163]=	"	1020020547	";
$acc_no_wpd[164]=	"	1020020717	";
$acc_no_wpd[165]=	"	1020022019	";
$acc_no_wpd[166]=	"	1020022779	";
$acc_no_wpd[167]=	"	1020022892	";
$acc_no_wpd[168]=	"	1020022426	";
$acc_no_wpd[169]=	"	1020022523	";
$acc_no_wpd[170]=	"	1020022418	";
$acc_no_wpd[171]=	"	1020023490	";
$acc_no_wpd[172]=	"	1020023619	";
$acc_no_wpd[173]=	"	1020024305	";
$acc_no_wpd[174]=	"	1020024640	";
$acc_no_wpd[175]=	"	1020024887	";
$acc_no_wpd[176]=	"	1020025379	";
$acc_no_wpd[177]=	"	1020026723	";
$acc_no_wpd[178]=	"	1020026138	";
$acc_no_wpd[179]=	"	1020026375	";
$acc_no_wpd[180]=	"	1020026715	";
$acc_no_wpd[181]=	"	1020027975	";
$acc_no_wpd[182]=	"	1020027347	";
$acc_no_wpd[183]=	"	1020028416	";
$acc_no_wpd[184]=	"	1020028831	";
$acc_no_wpd[185]=	"	1020031182	";
$acc_no_wpd[186]=	"	1020028947	";
$acc_no_wpd[187]=	"	1020029153	";
$acc_no_wpd[188]=	"	1020030194	";
$acc_no_wpd[189]=	"	1020030895	";
$acc_no_wpd[190]=	"	1020031581	";
$acc_no_wpd[191]=	"	1020031450	";
$acc_no_wpd[192]=	"	1020031280	";
$acc_no_wpd[193]=	"	1020032464	";
$acc_no_wpd[194]=	"	1020033291	";
$acc_no_wpd[195]=	"	1020033797	";
$acc_no_wpd[196]=	"	1020034599	";
$acc_no_wpd[197]=	"	1020034971	";
$acc_no_wpd[198]=	"	1020035480	";
$acc_no_wpd[199]=	"	1020036389	";
$acc_no_wpd[200]=	"	1020036281	";
$acc_no_wpd[201]=	"	1020036273	";
$acc_no_wpd[202]=	"	1020036257	";
$acc_no_wpd[203]=	"	1020037067	";
$acc_no_wpd[204]=	"	1020038055	";
$acc_no_wpd[205]=	"	1020037938	";
$acc_no_wpd[206]=	"	1020038241	";
$acc_no_wpd[207]=	"	1020038659	";
$acc_no_wpd[208]=	"	1020038942	";
$acc_no_wpd[209]=	"	1020039183	";
$acc_no_wpd[210]=	"	1020039604	";
$acc_no_wpd[211]=	"	1020039370	";
$acc_no_wpd[212]=	"	1020039566	";
$acc_no_wpd[213]=	"	1020041218	";
$acc_no_wpd[214]=	"	1020042613	";
$acc_no_wpd[215]=	"	1020042621	";
$acc_no_wpd[216]=	"	1020043717	";
$acc_no_wpd[217]=	"	1020043938	";
$acc_no_wpd[218]=	"	1020044047	";
$acc_no_wpd[219]=	"	1020044748	";
$acc_no_wpd[220]=	"	1020044730	";
$acc_no_wpd[221]=	"	1020044756	";
$acc_no_wpd[222]=	"	1020045353	";
$acc_no_wpd[223]=	"	1020047453	";
$acc_no_wpd[224]=	"	1020047445	";
$acc_no_wpd[225]=	"	1020049723	";
$acc_no_wpd[226]=	"	1020050233	";
$acc_no_wpd[227]=	"	1020050977	";
$acc_no_wpd[228]=	"	1020053933	";
$acc_no_wpd[229]=	"	1020054859	";
$acc_no_wpd[230]=	"	1020056029	";
$acc_no_wpd[231]=	"	1020056495	";
$acc_no_wpd[232]=	"	1020056746	";
$acc_no_wpd[233]=	"	1020056720	";
$acc_no_wpd[234]=	"	1020061626	";
$acc_no_wpd[235]=	"	1020062266	";
$acc_no_wpd[236]=	"	1020000082	";
$acc_no_wpd[237]=	"	1020007117	";
$acc_no_wpd[238]=	"	1020018747	";
$acc_no_wpd[239]=	"	1020029927	";
$acc_no_wpd[240]=	"	1020046571	";
$acc_no_wpd[241]=	"	1120000351	";
$acc_no_wpd[242]=	"	1120001421	";
$acc_no_wpd[243]=	"	1120002362	";
$acc_no_wpd[244]=	"	1120002478	";
$acc_no_wpd[245]=	"	1120002613	";
$acc_no_wpd[246]=	"	1120000211	";
$acc_no_wpd[247]=	"	1120000220	";
$acc_no_wpd[248]=	"	1120000289	";
$acc_no_wpd[249]=	"	1120000271	";
$acc_no_wpd[250]=	"	1120000327	";
$acc_no_wpd[251]=	"	1120000530	";
$acc_no_wpd[252]=	"	1120000726	";
$acc_no_wpd[253]=	"	1120000823	";
$acc_no_wpd[254]=	"	1120001099	";
$acc_no_wpd[255]=	"	1120002273	";
$acc_no_wpd[256]=	"	1120002290	";
$acc_no_wpd[257]=	"	1120002583	";
$acc_no_wpd[258]=	"	1120002567	";
$acc_no_wpd[259]=	"	1120003016	";
$acc_no_wpd[260]=	"	1120003814	";
$acc_no_wpd[261]=	"	1120003890	";
$acc_no_wpd[262]=	"	1120004012	";
$acc_no_wpd[263]=	"	1120005442	";
$acc_no_wpd[264]=	"	1120005451	";
$acc_no_wpd[265]=	"	1120005558	";
$acc_no_wpd[266]=	"	1120005833	";
$acc_no_wpd[267]=	"	1120006058	";
$acc_no_wpd[268]=	"	1120006325	";
$acc_no_wpd[269]=	"	1120006511	";
$acc_no_wpd[270]=	"	1120006732	";
$acc_no_wpd[271]=	"	1120008034	";
$acc_no_wpd[272]=	"	1120008255	";
$acc_no_wpd[273]=	"	1120008425	";
$acc_no_wpd[274]=	"	1120008409	";
$acc_no_wpd[275]=	"	1220000086	";
$acc_no_wpd[276]=	"	1220000345	";
$acc_no_wpd[277]=	"	1220000426	";
$acc_no_wpd[278]=	"	1220002097	";
$acc_no_wpd[279]=	"	1220002488	";
$acc_no_wpd[280]=	"	1220002585	";
$acc_no_wpd[281]=	"	1220005541	";
$acc_no_wpd[282]=	"	1220006645	";
$acc_no_wpd[283]=	"	1220000159	";
$acc_no_wpd[284]=	"	1220000175	";
$acc_no_wpd[285]=	"	1220000213	";
$acc_no_wpd[286]=	"	1220000337	";
$acc_no_wpd[287]=	"	1220000434	";
$acc_no_wpd[288]=	"	1220000477	";
$acc_no_wpd[289]=	"	1220000507	";
$acc_no_wpd[290]=	"	1220000523	";
$acc_no_wpd[291]=	"	1220000647	";
$acc_no_wpd[292]=	"	1220000825	";
$acc_no_wpd[293]=	"	1220000761	";
$acc_no_wpd[294]=	"	1220000868	";
$acc_no_wpd[295]=	"	1220000931	";
$acc_no_wpd[296]=	"	1220000914	";
$acc_no_wpd[297]=	"	1220001252	";
$acc_no_wpd[298]=	"	1220001465	";
$acc_no_wpd[299]=	"	1220001643	";
$acc_no_wpd[300]=	"	1220001732	";
$acc_no_wpd[301]=	"	1220001694	";
$acc_no_wpd[302]=	"	1220001783	";
$acc_no_wpd[303]=	"	1220001911	";
$acc_no_wpd[304]=	"	1220001996	";
$acc_no_wpd[305]=	"	1220002500	";
$acc_no_wpd[306]=	"	1220002682	";
$acc_no_wpd[307]=	"	1220002798	";
$acc_no_wpd[308]=	"	1220003085	";
$acc_no_wpd[309]=	"	1220003671	";
$acc_no_wpd[310]=	"	1220004146	";
$acc_no_wpd[311]=	"	1220004022	";
$acc_no_wpd[312]=	"	1220004383	";
$acc_no_wpd[313]=	"	1220004936	";
$acc_no_wpd[314]=	"	1220005428	";
$acc_no_wpd[315]=	"	1220005550	";
$acc_no_wpd[316]=	"	1220005614	";
$acc_no_wpd[317]=	"	1220006050	";
$acc_no_wpd[318]=	"	1220006173	";
$acc_no_wpd[319]=	"	1220006963	";
$acc_no_wpd[320]=	"	1220007498	";
$acc_no_wpd[321]=	"	1220008168	";
$acc_no_wpd[322]=	"	1220008231	";
$acc_no_wpd[323]=	"	1220008486	";
$acc_no_wpd[324]=	"	1220008966	";
$acc_no_wpd[325]=	"	1220009008	";
$acc_no_wpd[326]=	"	1220009016	";
$acc_no_wpd[327]=	"	1320000789	";
$acc_no_wpd[328]=	"	1320001025	";
$acc_no_wpd[329]=	"	1320001491	";
$acc_no_wpd[330]=	"	1320003966	";
$acc_no_wpd[331]=	"	1320003991	";
$acc_no_wpd[332]=	"	1320004679	";
$acc_no_wpd[333]=	"	1320006027	";
$acc_no_wpd[334]=	"	1320006591	";
$acc_no_wpd[335]=	"	1320006604	";
$acc_no_wpd[336]=	"	1320006647	";
$acc_no_wpd[337]=	"	1320007406	";
$acc_no_wpd[338]=	"	1420000161	";
$acc_no_wpd[339]=	"	1420001591	";
$acc_no_wpd[340]=	"	1420000136	";
$acc_no_wpd[341]=	"	1420000349	";
$acc_no_wpd[342]=	"	1420000616	";
$acc_no_wpd[343]=	"	1420001507	";
$acc_no_wpd[344]=	"	1420001531	";
$acc_no_wpd[345]=	"	1420001809	";
$acc_no_wpd[346]=	"	1520000316	";
$acc_no_wpd[347]=	"	1620000113	";
$acc_no_wpd[348]=	"	1620000342	";
$acc_no_wpd[349]=	"	1620000423	";
$acc_no_wpd[350]=	"	1720000107	";
$acc_no_wpd[351]=	"	1820000222	";
$acc_no_wpd[352]=	"	1820000192	";
$acc_no_wpd[353]=	"	1820000257	";
$acc_no_wpd[354]=	"	1920000828	";
$acc_no_wpd[355]=	"	1920000071	";
$acc_no_wpd[356]=	"	1920000101	";
$acc_no_wpd[357]=	"	1920000399	";
$acc_no_wpd[358]=	"	1920000411	";
$acc_no_wpd[359]=	"	2020000024	";
$acc_no_wpd[360]=	"	2020000245	";
$acc_no_wpd[361]=	"	2020000440	";
$acc_no_wpd[362]=	"	2020000415	";
$acc_no_wpd[363]=	"	2020000431	";
$acc_no_wpd[364]=	"	2020000407	";
$acc_no_wpd[365]=	"	2020007312	";
$acc_no_wpd[366]=	"	2020005166	";
$acc_no_wpd[367]=	"	2020000172	";
$acc_no_wpd[368]=	"	2020000342	";
$acc_no_wpd[369]=	"	2020000326	";
$acc_no_wpd[370]=	"	2020000636	";
$acc_no_wpd[371]=	"	2020000857	";
$acc_no_wpd[372]=	"	2020000881	";
$acc_no_wpd[373]=	"	2020000946	";
$acc_no_wpd[374]=	"	2020001161	";
$acc_no_wpd[375]=	"	2020001349	";
$acc_no_wpd[376]=	"	2020001241	";
$acc_no_wpd[377]=	"	2020001373	";
$acc_no_wpd[378]=	"	2020001641	";
$acc_no_wpd[379]=	"	2020002213	";
$acc_no_wpd[380]=	"	2020002426	";
$acc_no_wpd[381]=	"	2020002787	";
$acc_no_wpd[382]=	"	2020003431	";
$acc_no_wpd[383]=	"	2020004411	";
$acc_no_wpd[384]=	"	2020004542	";
$acc_no_wpd[385]=	"	2020004615	";
$acc_no_wpd[386]=	"	2020005433	";
$acc_no_wpd[387]=	"	2020005379	";
$acc_no_wpd[388]=	"	2020005611	";
$acc_no_wpd[389]=	"	2020006341	";
$acc_no_wpd[390]=	"	2020006391	";
$acc_no_wpd[391]=	"	2020007843	";
$acc_no_wpd[392]=	"	2020007991	";
$acc_no_wpd[393]=	"	2020008211	";
$acc_no_wpd[394]=	"	2020010542	";
$acc_no_wpd[395]=	"	2020012863	";
$acc_no_wpd[396]=	"	2020013606	";
$acc_no_wpd[397]=	"	2020016885	";
$acc_no_wpd[398]=	"	2120001626	";
$acc_no_wpd[399]=	"	2120001782	";
$acc_no_wpd[400]=	"	2120000034	";
$acc_no_wpd[401]=	"	2120000140	";
$acc_no_wpd[402]=	"	2120000255	";
$acc_no_wpd[403]=	"	2120000271	";
$acc_no_wpd[404]=	"	2120000441	";
$acc_no_wpd[405]=	"	2120000565	";
$acc_no_wpd[406]=	"	2120000859	";
$acc_no_wpd[407]=	"	2120000930	";
$acc_no_wpd[408]=	"	2120000964	";
$acc_no_wpd[409]=	"	2120000999	";
$acc_no_wpd[410]=	"	2120001081	";
$acc_no_wpd[411]=	"	2120001901	";
$acc_no_wpd[412]=	"	2120001928	";
$acc_no_wpd[413]=	"	2120002495	";
$acc_no_wpd[414]=	"	2120002606	";
$acc_no_wpd[415]=	"	2120003211	";
$acc_no_wpd[416]=	"	2120003963	";
$acc_no_wpd[417]=	"	2220000010	";
$acc_no_wpd[418]=	"	2220000028	";
$acc_no_wpd[419]=	"	2220000044	";
$acc_no_wpd[420]=	"	2220000052	";
$acc_no_wpd[421]=	"	2220000095	";
$acc_no_wpd[422]=	"	2220000125	";
$acc_no_wpd[423]=	"	2220000176	";
$acc_no_wpd[424]=	"	2220000273	";
$acc_no_wpd[425]=	"	2220000397	";
$acc_no_wpd[426]=	"	2320000089	";
$acc_no_wpd[427]=	"	2320000143	";
$acc_no_wpd[428]=	"	2320000135	";
$acc_no_wpd[429]=	"	2320000224	";
$acc_no_wpd[430]=	"	2320000381	";
$acc_no_wpd[431]=	"	2320000470	";
$acc_no_wpd[432]=	"	2420000021	";
$acc_no_wpd[433]=	"	2420000099	";
$acc_no_wpd[434]=	"	2420000137	";
$acc_no_wpd[435]=	"	2420000536	";
$acc_no_wpd[436]=	"	2420000625	";
$acc_no_wpd[437]=	"	2520000112	";
$acc_no_wpd[438]=	"	2620000114	";
$acc_no_wpd[439]=	"	2620000181	";
$acc_no_wpd[440]=	"	3020000173	";
$acc_no_wpd[441]=	"	3020000203	";
$acc_no_wpd[442]=	"	3020000301	";
$acc_no_wpd[443]=	"	3020000530	";
$acc_no_wpd[444]=	"	3020000751	";
$acc_no_wpd[445]=	"	3020000777	";
$acc_no_wpd[446]=	"	3020001382	";
$acc_no_wpd[447]=	"	3020001650	";
$acc_no_wpd[448]=	"	3020000017	";
$acc_no_wpd[449]=	"	3020000084	";
$acc_no_wpd[450]=	"	3020000050	";
$acc_no_wpd[451]=	"	3020000467	";
$acc_no_wpd[452]=	"	3020002061	";
$acc_no_wpd[453]=	"	3020000718	";
$acc_no_wpd[454]=	"	3020000742	";
$acc_no_wpd[455]=	"	3020001048	";
$acc_no_wpd[456]=	"	3020001030	";
$acc_no_wpd[457]=	"	3020001137	";
$acc_no_wpd[458]=	"	3020001161	";
$acc_no_wpd[459]=	"	3020001242	";
$acc_no_wpd[460]=	"	3020001544	";
$acc_no_wpd[461]=	"	3020001625	";
$acc_no_wpd[462]=	"	3020001668	";
$acc_no_wpd[463]=	"	3020001676	";
$acc_no_wpd[464]=	"	3020001684	";
$acc_no_wpd[465]=	"	3020003059	";
$acc_no_wpd[466]=	"	3020003415	";
$acc_no_wpd[467]=	"	3120000124	";
$acc_no_wpd[468]=	"	3120000132	";
$acc_no_wpd[469]=	"	3120000027	";
$acc_no_wpd[470]=	"	3120000183	";
$acc_no_wpd[471]=	"	3120000213	";
$acc_no_wpd[472]=	"	3120000299	";
$acc_no_wpd[473]=	"	3120000361	";
$acc_no_wpd[474]=	"	3120000752	";
$acc_no_wpd[475]=	"	3120000884	";
$acc_no_wpd[476]=	"	3220000011	";
$acc_no_wpd[477]=	"	3220000541	";
$acc_no_wpd[478]=	"	3220000177	";
$acc_no_wpd[479]=	"	3220000592	";
$acc_no_wpd[480]=	"	3320000047	";
$acc_no_wpd[481]=	"	3320000209	";
$acc_no_wpd[482]=	"	3320000250	";
$acc_no_wpd[483]=	"	3320000306	";
$acc_no_wpd[484]=	"	3320000365	";
$acc_no_wpd[485]=	"	3320000390	";
$acc_no_wpd[486]=	"	3320000420	";
$acc_no_wpd[487]=	"	3420000081	";
$acc_no_wpd[488]=	"	3420000359	";
$acc_no_wpd[489]=	"	3420000901	";
$acc_no_wpd[490]=	"	3420001045	";
$acc_no_wpd[491]=	"	3420001169	";
$acc_no_wpd[492]=	"	3420000073	";
$acc_no_wpd[493]=	"	3420000146	";
$acc_no_wpd[494]=	"	3420000154	";
$acc_no_wpd[495]=	"	3420000162	";
$acc_no_wpd[496]=	"	3420000235	";
$acc_no_wpd[497]=	"	3420000456	";
$acc_no_wpd[498]=	"	3420000472	";
$acc_no_wpd[499]=	"	3420000596	";
$acc_no_wpd[500]=	"	3420000618	";
$acc_no_wpd[501]=	"	3520000105	";
$acc_no_wpd[502]=	"	3520000211	";
$acc_no_wpd[503]=	"	3520000229	";
$acc_no_wpd[504]=	"	3520000482	";
$acc_no_wpd[505]=	"	3520000202	";
$acc_no_wpd[506]=	"	3520000326	";
$acc_no_wpd[507]=	"	3520000369	";
$acc_no_wpd[508]=	"	3620000034	";
$acc_no_wpd[509]=	"	3620000042	";
$acc_no_wpd[510]=	"	3620000557	";
$acc_no_wpd[511]=	"	4020000131	";
$acc_no_wpd[512]=	"	4020000247	";
$acc_no_wpd[513]=	"	4020000786	";
$acc_no_wpd[514]=	"	4020001090	";
$acc_no_wpd[515]=	"	4020001570	";
$acc_no_wpd[516]=	"	4020002860	";
$acc_no_wpd[517]=	"	4020000051	";
$acc_no_wpd[518]=	"	4020000166	";
$acc_no_wpd[519]=	"	4020000182	";
$acc_no_wpd[520]=	"	4020003009	";
$acc_no_wpd[521]=	"	4020000484	";
$acc_no_wpd[522]=	"	4020000565	";
$acc_no_wpd[523]=	"	4020000697	";
$acc_no_wpd[524]=	"	4020000719	";
$acc_no_wpd[525]=	"	4020001391	";
$acc_no_wpd[526]=	"	4020001405	";
$acc_no_wpd[527]=	"	4020001545	";
$acc_no_wpd[528]=	"	4020002177	";
$acc_no_wpd[529]=	"	4020002410	";
$acc_no_wpd[530]=	"	4020002461	";
$acc_no_wpd[531]=	"	4020002479	";
$acc_no_wpd[532]=	"	4120000010	";
$acc_no_wpd[533]=	"	4120000184	";
$acc_no_wpd[534]=	"	4120000249	";
$acc_no_wpd[535]=	"	4120000885	";
$acc_no_wpd[536]=	"	4120000354	";
$acc_no_wpd[537]=	"	4120000940	";
$acc_no_wpd[538]=	"	4120001318	";
$acc_no_wpd[539]=	"	4220000038	";
$acc_no_wpd[540]=	"	4220000127	";
$acc_no_wpd[541]=	"	4220000305	";
$acc_no_wpd[542]=	"	4220000283	";
$acc_no_wpd[543]=	"	4320000242	";
$acc_no_wpd[544]=	"	4320000277	";
$acc_no_wpd[545]=	"	4320000358	";
$acc_no_wpd[546]=	"	4320000391	";
$acc_no_wpd[547]=	"	4520000076	";
$acc_no_wpd[548]=	"	4520000033	";
$acc_no_wpd[549]=	"	4520000092	";
$acc_no_wpd[550]=	"	4520000106	";
$acc_no_wpd[551]=	"	4620000043	";
$acc_no_wpd[552]=	"	4720000401	";
$acc_no_wpd[553]=	"	4720000266	";
$acc_no_wpd[554]=	"	4720000428	";
$acc_no_wpd[555]=	"	4820000128	";
$acc_no_wpd[556]=	"	4820000098	";
$acc_no_wpd[557]=	"	4820000446	";
$acc_no_wpd[558]=	"	4920000090	";
$acc_no_wpd[559]=	"	4920000138	";
$acc_no_wpd[560]=	"	4920000511	";
$acc_no_wpd[561]=	"	4920000073	";
$acc_no_wpd[562]=	"	4920000103	";

$acc_no_wpd[563]=	"	4920000189	";
$acc_no_wpd[564]=	"	5020000060	";
$acc_no_wpd[565]=	"	5020000396	";
$acc_no_wpd[566]=	"	5020000779	";
$acc_no_wpd[567]=	"	5020001198	";
$acc_no_wpd[568]=	"	5020002020	";
$acc_no_wpd[569]=	"	5020002631	";
$acc_no_wpd[570]=	"	5020000035	";
$acc_no_wpd[571]=	"	5020000051	";
$acc_no_wpd[572]=	"	5020000264	";
$acc_no_wpd[573]=	"	5020000744	";
$acc_no_wpd[574]=	"	5020000965	";
$acc_no_wpd[575]=	"	5020001422	";
$acc_no_wpd[576]=	"	5020001546	";
$acc_no_wpd[577]=	"	5020001619	";
$acc_no_wpd[578]=	"	5020002321	";
$acc_no_wpd[579]=	"	5020003107	";
$acc_no_wpd[580]=	"	5020003549	";
$acc_no_wpd[581]=	"	5020004065	";
$acc_no_wpd[582]=	"	5020005371	";
$acc_no_wpd[583]=	"	5020005444	";
$acc_no_wpd[584]=	"	5020005681	";
$acc_no_wpd[585]=	"	5120000282	";
$acc_no_wpd[586]=	"	5120000011	";
$acc_no_wpd[587]=	"	5120000029	";
$acc_no_wpd[588]=	"	5120000363	";
$acc_no_wpd[589]=	"	5120000584	";
$acc_no_wpd[590]=	"	5120000649	";
$acc_no_wpd[591]=	"	5320000014	";
$acc_no_wpd[592]=	"	5420000041	";
$acc_no_wpd[593]=	"	5420000059	";
$acc_no_wpd[594]=	"	5520000051	";
$acc_no_wpd[595]=	"	5520000077	";
$acc_no_wpd[596]=	"	5520000131	";
$acc_no_wpd[597]=	"	5520000191	";
$acc_no_wpd[598]=	"	5520000263	";
$acc_no_wpd[599]=	"	5520000441	";
$acc_no_wpd[600]=	"	5520000158	";
$acc_no_wpd[601]=	"	5520000344	";
$acc_no_wpd[602]=	"	5620000087	";
$acc_no_wpd[603]=	"	5620000249	";
$acc_no_wpd[604]=	"	5720000186	";
$acc_no_wpd[605]=	"	5720000194	";
$acc_no_wpd[606]=	"	5720000437	";
$acc_no_wpd[607]=	"	5720000607	";
$acc_no_wpd[608]=	"	5720000801	";
$acc_no_wpd[609]=	"	5720001034	";
$acc_no_wpd[610]=	"	5720001824	";
$acc_no_wpd[611]=	"	6020000168	";
$acc_no_wpd[612]=	"	6020000061	";
$acc_no_wpd[613]=	"	6120000038	";
$acc_no_wpd[614]=	"	6120000046	";
$acc_no_wpd[615]=	"	6120000216	";
$acc_no_wpd[616]=	"	6220000510	";
$acc_no_wpd[617]=	"	6220000129	";
$acc_no_wpd[618]=	"	6320000244	";
$acc_no_wpd[619]=	"	6320000325	";
$acc_no_wpd[620]=	"	6320000198	";
$acc_no_wpd[621]=	"	6320000571	";
$acc_no_wpd[622]=	"	6420000068	";
$acc_no_wpd[623]=	"	6520000167	";
$acc_no_wpd[624]=	"	6520000272	";
$acc_no_wpd[625]=	"	6520000931	";
$acc_no_wpd[626]=	"	6520000027	";
$acc_no_wpd[627]=	"	6520000302	";
$acc_no_wpd[628]=	"	6520000299	";
$acc_no_wpd[629]=	"	6520000345	";
$acc_no_wpd[630]=	"	6520000604	";
$acc_no_wpd[631]=	"	6720000071	";
$acc_no_wpd[632]=	"	6720000110	";
$acc_no_wpd[633]=	"	6720000268	";
$acc_no_wpd[634]=	"	6720000373	";
$acc_no_wpd[635]=	"	6720000438	";
$acc_no_wpd[636]=	"	6720000021	";
$acc_no_wpd[637]=	"	6720000179	";
$acc_no_wpd[638]=	"	6720000217	";
$acc_no_wpd[639]=	"	7020000011	";
$acc_no_wpd[640]=	"	7020000037	";
$acc_no_wpd[641]=	"	7020000045	";
$acc_no_wpd[642]=	"	7020000053	";
$acc_no_wpd[643]=	"	7020000088	";
$acc_no_wpd[644]=	"	7020000100	";
$acc_no_wpd[645]=	"	7020000231	";
$acc_no_wpd[646]=	"	7020000274	";
$acc_no_wpd[647]=	"	7020000517	";
$acc_no_wpd[648]=	"	7020000576	";
$acc_no_wpd[649]=	"	7020000819	";
$acc_no_wpd[650]=	"	7020000916	";
$acc_no_wpd[651]=	"	7020001025	";
$acc_no_wpd[652]=	"	7120000080	";
$acc_no_wpd[653]=	"	7120000110	";
$acc_no_wpd[654]=	"	7120000306	";
$acc_no_wpd[655]=	"	7120000616	";
$acc_no_wpd[656]=	"	7120000705	";
$acc_no_wpd[657]=	"	7120000918	";
$acc_no_wpd[658]=	"	7120001167	";
$acc_no_wpd[659]=	"	7120001485	";
$acc_no_wpd[660]=	"	7220000529	";
$acc_no_wpd[661]=	"	7220000596	";
$acc_no_wpd[662]=	"	7220000634	";
$acc_no_wpd[663]=	"	7220000642	";
$acc_no_wpd[664]=	"	7220000090	";
$acc_no_wpd[665]=	"	7220000316	";
$acc_no_wpd[666]=	"	7220000421	";
$acc_no_wpd[667]=	"	7220000430	";
$acc_no_wpd[668]=	"	7220000448	";
$acc_no_wpd[669]=	"	7220000472	";
$acc_no_wpd[670]=	"	7220000537	";
$acc_no_wpd[671]=	"	7220000553	";
$acc_no_wpd[672]=	"	7220000766	";
$acc_no_wpd[673]=	"	7220000740	";
$acc_no_wpd[674]=	"	7220000774	";
$acc_no_wpd[675]=	"	7320001101	";
$acc_no_wpd[676]=	"	7320001179	";
$acc_no_wpd[677]=	"	7320001802	";
$acc_no_wpd[678]=	"	7320000105	";
$acc_no_wpd[679]=	"	7320000202	";
$acc_no_wpd[680]=	"	7320000211	";
$acc_no_wpd[681]=	"	7320000245	";
$acc_no_wpd[682]=	"	7320000423	";
$acc_no_wpd[683]=	"	7320000431	";
$acc_no_wpd[684]=	"	7320000598	";
$acc_no_wpd[685]=	"	7320000601	";
$acc_no_wpd[686]=	"	7320000750	";
$acc_no_wpd[687]=	"	7320000938	";
$acc_no_wpd[688]=	"	7320001144	";
$acc_no_wpd[689]=	"	7320001349	";
$acc_no_wpd[690]=	"	7320002051	";
$acc_no_wpd[691]=	"	7320003210	";
$acc_no_wpd[692]=	"	7420000212	";
$acc_no_wpd[693]=	"	7420000247	";
$acc_no_wpd[694]=	"	7420000069	";
$acc_no_wpd[695]=	"	7420000093	";
$acc_no_wpd[696]=	"	7420001006	";
$acc_no_wpd[697]=	"	7420001057	";
$acc_no_wpd[698]=	"	7420001197	";
$acc_no_wpd[699]=	"	7420001511	";
$acc_no_wpd[700]=	"	7420002070	";
$acc_no_wpd[701]=	"	7420002452	";
$acc_no_wpd[702]=	"	7520000061	";
$acc_no_wpd[703]=	"	7520000044	";
$acc_no_wpd[704]=	"	7520000052	";
$acc_no_wpd[705]=	"	7520000079	";
$acc_no_wpd[706]=	"	7520000087	";
$acc_no_wpd[707]=	"	7520000109	";
$acc_no_wpd[708]=	"	7620000062	";
$acc_no_wpd[709]=	"	7620000186	";
$acc_no_wpd[710]=	"	7720001419	";
$acc_no_wpd[711]=	"	7720000633	";
$acc_no_wpd[712]=	"	7720000030	";
$acc_no_wpd[713]=	"	7720000064	";
$acc_no_wpd[714]=	"	7720000072	";
$acc_no_wpd[715]=	"	7720000331	";
$acc_no_wpd[716]=	"	7720000587	";
$acc_no_wpd[717]=	"	7720000641	";
$acc_no_wpd[718]=	"	7720000692	";
$acc_no_wpd[719]=	"	7720000706	";
$acc_no_wpd[720]=	"	8020000011	";
$acc_no_wpd[721]=	"	8020000054	";
$acc_no_wpd[722]=	"	8020000178	";
$acc_no_wpd[723]=	"	8020000488	";
$acc_no_wpd[724]=	"	8020000071	";
$acc_no_wpd[725]=	"	8020000089	";
$acc_no_wpd[726]=	"	8020000160	";
$acc_no_wpd[727]=	"	8020000291	";
$acc_no_wpd[728]=	"	8020001069	";
$acc_no_wpd[729]=	"	8120000048	";
$acc_no_wpd[730]=	"	8120000242	";
$acc_no_wpd[731]=	"	8120000030	";
$acc_no_wpd[732]=	"	8120000081	";
$acc_no_wpd[733]=	"	8120000145	";
$acc_no_wpd[734]=	"	8120000170	";
$acc_no_wpd[735]=	"	8320001498	";
$acc_no_wpd[736]=	"	8320001552	";
$acc_no_wpd[737]=	"	8320000033	";
$acc_no_wpd[738]=	"	8320000301	";
$acc_no_wpd[739]=	"	8320000262	";
$acc_no_wpd[740]=	"	8320000319	";
$acc_no_wpd[741]=	"	8320000327	";
$acc_no_wpd[742]=	"	8320000343	";
$acc_no_wpd[743]=	"	8320000530	";
$acc_no_wpd[744]=	"	8320000564	";
$acc_no_wpd[745]=	"	8320000611	";
$acc_no_wpd[746]=	"	8320000670	";
$acc_no_wpd[747]=	"	8320000718	";
$acc_no_wpd[748]=	"	8320000858	";
$acc_no_wpd[749]=	"	8320000891	";
$acc_no_wpd[750]=	"	8320000904	";
$acc_no_wpd[751]=	"	8320000912	";
$acc_no_wpd[752]=	"	8320001242	";
$acc_no_wpd[753]=	"	8320001251	";
$acc_no_wpd[754]=	"	8320001412	";
$acc_no_wpd[755]=	"	8320001641	";
$acc_no_wpd[756]=	"	8320001676	";
$acc_no_wpd[757]=	"	8320001901	";
$acc_no_wpd[758]=	"	8320001919	";
$acc_no_wpd[759]=	"	8320001935	";
$acc_no_wpd[760]=	"	8320001978	";
$acc_no_wpd[761]=	"	8320002044	";
$acc_no_wpd[762]=	"	8320003148	";
$acc_no_wpd[763]=	"	8320003237	";
$acc_no_wpd[764]=	"	8320003245	";
$acc_no_wpd[765]=	"	8320003474	";
$acc_no_wpd[766]=	"	8320004047	";
$acc_no_wpd[767]=	"	8320004071	";
$acc_no_wpd[768]=	"	8320004659	";
$acc_no_wpd[769]=	"	8320006376	";
$acc_no_wpd[770]=	"	8320006368	";
$acc_no_wpd[771]=	"	8320006911	";
$acc_no_wpd[772]=	"	8420000299	";
$acc_no_wpd[773]=	"	8420001872	";
$acc_no_wpd[774]=	"	8420000248	";
$acc_no_wpd[775]=	"	8420000337	";
$acc_no_wpd[776]=	"	8420000400	";
$acc_no_wpd[777]=	"	8420000434	";
$acc_no_wpd[778]=	"	8420000582	";
$acc_no_wpd[779]=	"	8420000949	";
$acc_no_wpd[780]=	"	8420001309	";
$acc_no_wpd[781]=	"	8420001333	";
$acc_no_wpd[782]=	"	8420001775	";
$acc_no_wpd[783]=	"	8420002186	";
$acc_no_wpd[784]=	"	8420002330	";
$acc_no_wpd[785]=	"	8420002496	";
$acc_no_wpd[786]=	"	8420002542	";
$acc_no_wpd[787]=	"	8420002836	";
$acc_no_wpd[788]=	"	8420003549	";
$acc_no_wpd[789]=	"	8420004413	";
$acc_no_wpd[790]=	"	8620000055	";
$acc_no_wpd[791]=	"	8620000063	";
$acc_no_wpd[792]=	"	8620000314	";
$acc_no_wpd[793]=	"	8620000322	";
$acc_no_wpd[794]=	"	8620000586	";
$acc_no_wpd[795]=	"	9020001191	";
$acc_no_wpd[796]=	"	9020000381	";
$acc_no_wpd[797]=	"	9020001353	";
$acc_no_wpd[798]=	"	9020001744	";
$acc_no_wpd[799]=	"	9020001833	";
$acc_no_wpd[800]=	"	9020000039	";
$acc_no_wpd[801]=	"	9020000080	";
$acc_no_wpd[802]=	"	9020000152	";
$acc_no_wpd[803]=	"	9020000225	";
$acc_no_wpd[804]=	"	9020000624	";
$acc_no_wpd[805]=	"	9020000713	";
$acc_no_wpd[806]=	"	9020000756	";
$acc_no_wpd[807]=	"	9020001027	";
$acc_no_wpd[808]=	"	9020001337	";
$acc_no_wpd[809]=	"	9020001728	";
$acc_no_wpd[810]=	"	9020002040	";
$acc_no_wpd[811]=	"	9020002171	";
$acc_no_wpd[812]=	"	9020002309	";
$acc_no_wpd[813]=	"	9020002503	";
$acc_no_wpd[814]=	"	9020002813	";
$acc_no_wpd[815]=	"	9120000014	";
$acc_no_wpd[816]=	"	9120000103	";
$acc_no_wpd[817]=	"	9120000146	";
$acc_no_wpd[818]=	"	9120000171	";
$acc_no_wpd[819]=	"	9220000229	";
$acc_no_wpd[820]=	"	9320000174	";
$acc_no_wpd[821]=	"	9320000018	";
$acc_no_wpd[822]=	"	9320000191	";
$acc_no_wpd[823]=	"	9620000188	";

$acc_no_sapeins[0]=	"	1002921945	";
$acc_no_sapeins[1]=	"	1003401457	";
$acc_no_sapeins[2]=	"	1003687075	";
$acc_no_sapeins[3]=	"	1003588638	";
$acc_no_sapeins[4]=	"	1003401414	";
$acc_no_sapeins[5]=	"	1003401341	";
$acc_no_sapeins[6]=	"	1003317294	";
$acc_no_sapeins[7]=	"	1003347673	";
$acc_no_sapeins[8]=	"	1003644678	";
$acc_no_sapeins[9]=	"	1003347240	";
$acc_no_sapeins[10]=	"	1003320139	";
$acc_no_sapeins[11]=	"	1003687440	";
$acc_no_sapeins[12]=	"	1003688535	";
$acc_no_sapeins[13]=	"	1003348238	";
$acc_no_sapeins[14]=	"	1003686699	";
$acc_no_sapeins[15]=	"	1003687261	";
$acc_no_sapeins[16]=	"	1003687351	";
$acc_no_sapeins[17]=	"	1003645721	";
$acc_no_sapeins[18]=	"	1003684891	";
$acc_no_sapeins[19]=	"	1003588450	";
$acc_no_sapeins[20]=	"	1003687504	";
$acc_no_sapeins[21]=	"	1003685315	";
$acc_no_sapeins[22]=	"	1003588841	";
$acc_no_sapeins[23]=	"	1003644511	";
$acc_no_sapeins[24]=	"	1003495281	";
$acc_no_sapeins[25]=	"	1003496121	";
$acc_no_sapeins[26]=	"	1003316085	";
$acc_no_sapeins[27]=	"	1003587020	";
$acc_no_sapeins[28]=	"	1003686231	";
$acc_no_sapeins[29]=	"	1003441131	";
$acc_no_sapeins[30]=	"	1003644686	";
$acc_no_sapeins[31]=	"	1003401627	";
$acc_no_sapeins[32]=	"	1003644961	";
$acc_no_sapeins[33]=	"	1003346421	";
$acc_no_sapeins[34]=	"	1003402178	";
$acc_no_sapeins[35]=	"	1003644431	";
$acc_no_sapeins[36]=	"	1003588743	";
$acc_no_sapeins[37]=	"	1003543910	";
$acc_no_sapeins[38]=	"	1003495079	";
$acc_no_sapeins[39]=	"	1003346464	";
$acc_no_sapeins[40]=	"	1003345051	";
$acc_no_sapeins[41]=	"	1003687300	";
$acc_no_sapeins[42]=	"	1003588760	";
$acc_no_sapeins[43]=	"	1003586601	";
$acc_no_sapeins[44]=	"	1003687407	";
$acc_no_sapeins[45]=	"	1003687539	";
$acc_no_sapeins[46]=	"	1003586694	";
$acc_no_sapeins[47]=	"	1002270405	";
$acc_no_sapeins[48]=	"	1003197108	";
$acc_no_sapeins[49]=	"	1003441327	";
$acc_no_sapeins[50]=	"	1003318681	";
$acc_no_sapeins[51]=	"	1003685609	";
$acc_no_sapeins[52]=	"	1003587127	";
$acc_no_sapeins[53]=	"	1003544983	";
$acc_no_sapeins[54]=	"	1003545009	";
$acc_no_sapeins[55]=	"	1003544991	";
$acc_no_sapeins[56]=	"	1003495583	";
$acc_no_sapeins[57]=	"	1003495567	";
$acc_no_sapeins[58]=	"	1003199461	";
$acc_no_sapeins[59]=	"	1003495443	";
$acc_no_sapeins[60]=	"	1003487271	";
$acc_no_sapeins[61]=	"	1003496041	";
$acc_no_sapeins[62]=	"	1003687903	";
$acc_no_sapeins[63]=	"	1003315933	";
$acc_no_sapeins[64]=	"	1003400949	";
$acc_no_sapeins[65]=	"	1003199054	";
$acc_no_sapeins[66]=	"	1003586619	";
$acc_no_sapeins[67]=	"	1003543871	";
$acc_no_sapeins[68]=	"	1003346154	";
$acc_no_sapeins[69]=	"	1003685935	";
$acc_no_sapeins[70]=	"	1003586911	";
$acc_no_sapeins[71]=	"	1001081200	";
$acc_no_sapeins[72]=	"	1003587011	";
$acc_no_sapeins[73]=	"	1003588123	";
$acc_no_sapeins[74]=	"	1003317260	";
$acc_no_sapeins[75]=	"	1003686150	";
$acc_no_sapeins[76]=	"	1003686541	";
$acc_no_sapeins[77]=	"	1003320856	";
$acc_no_sapeins[78]=	"	1003546404	";
$acc_no_sapeins[79]=	"	1003547257	";
$acc_no_sapeins[80]=	"	1003589341	";
$acc_no_sapeins[81]=	"	1003345263	";
$acc_no_sapeins[82]=	"	1003441700	";
$acc_no_sapeins[83]=	"	1003317197	";
$acc_no_sapeins[84]=	"	1003045430	";
$acc_no_sapeins[85]=	"	1003545149	";
$acc_no_sapeins[86]=	"	1003498116	";
$acc_no_sapeins[87]=	"	1003346430	";
$acc_no_sapeins[88]=	"	1003686991	";
$acc_no_sapeins[89]=	"	1003346740	";
$acc_no_sapeins[90]=	"	1003546358	";
$acc_no_sapeins[91]=	"	1003441742	";
$acc_no_sapeins[92]=	"	1003317201	";
$acc_no_sapeins[93]=	"	1003589006	";
$acc_no_sapeins[94]=	"	1001027914	";
$acc_no_sapeins[95]=	"	1003546315	";
$acc_no_sapeins[96]=	"	1003648428	";
$acc_no_sapeins[97]=	"	1003317243	";
$acc_no_sapeins[98]=	"	1003586872	";
$acc_no_sapeins[99]=	"	1003685641	";
$acc_no_sapeins[100]=	"	1003589464	";
$acc_no_sapeins[101]=	"	1003544266	";
$acc_no_sapeins[102]=	"	1003498264	";
$acc_no_sapeins[103]=	"	1003644864	";
$acc_no_sapeins[104]=	"	1003644872	";
$acc_no_sapeins[105]=	"	1003199232	";
$acc_no_sapeins[106]=	"	1003199615	";
$acc_no_sapeins[107]=	"	1002006104	";
$acc_no_sapeins[108]=	"	1003317839	";
$acc_no_sapeins[109]=	"	1003685501	";
$acc_no_sapeins[110]=	"	1003644325	";
$acc_no_sapeins[111]=	"	1003346057	";
$acc_no_sapeins[112]=	"	1003319301	";
$acc_no_sapeins[113]=	"	1003319467	";
$acc_no_sapeins[114]=	"	1003588514	";
$acc_no_sapeins[115]=	"	1003319190	";
$acc_no_sapeins[116]=	"	1003318240	";
$acc_no_sapeins[117]=	"	1003686451	";
$acc_no_sapeins[118]=	"	1003544096	";
$acc_no_sapeins[119]=	"	1003545726	";
$acc_no_sapeins[120]=	"	1003318291	";
$acc_no_sapeins[121]=	"	1003318801	";
$acc_no_sapeins[122]=	"	1003401295	";
$acc_no_sapeins[123]=	"	1003199135	";
$acc_no_sapeins[124]=	"	1003587101	";
$acc_no_sapeins[125]=	"	1003588506	";
$acc_no_sapeins[126]=	"	1003587623	";
$acc_no_sapeins[127]=	"	1002270740	";
$acc_no_sapeins[128]=	"	1003688331	";
$acc_no_sapeins[129]=	"	1003496202	";
$acc_no_sapeins[130]=	"	1003587160	";
$acc_no_sapeins[131]=	"	1003318762	";
$acc_no_sapeins[132]=	"	1003587691	";
$acc_no_sapeins[133]=	"	1001059778	";
$acc_no_sapeins[134]=	"	1003648576	";
$acc_no_sapeins[135]=	"	1003589472	";
$acc_no_sapeins[136]=	"	1003433171	";
$acc_no_sapeins[137]=	"	7600049821	";
$acc_no_sapeins[138]=	"	7600050153	";
$acc_no_sapeins[139]=	"	1001769961	";
$acc_no_sapeins[140]=	"	1003319751	";
$acc_no_sapeins[141]=	"	1003345930	";
$acc_no_sapeins[142]=	"	1003401708	";
$acc_no_sapeins[143]=	"	1003200052	";
$acc_no_sapeins[144]=	"	1003347053	";
$acc_no_sapeins[145]=	"	1003545971	";
$acc_no_sapeins[146]=	"	1003588352	";
$acc_no_sapeins[147]=	"	1003588972	";
$acc_no_sapeins[148]=	"	1003685731	";
$acc_no_sapeins[149]=	"	1003588107	";
$acc_no_sapeins[150]=	"	1003687822	";
$acc_no_sapeins[151]=	"	1100474986	";
$acc_no_sapeins[152]=	"	1003318592	";
$acc_no_sapeins[153]=	"	1003545220	";
$acc_no_sapeins[154]=	"	1003441467	";
$acc_no_sapeins[155]=	"	1003588948	";
$acc_no_sapeins[156]=	"	1003045251	";
$acc_no_sapeins[157]=	"	1003647910	";
$acc_no_sapeins[158]=	"	1003588018	";
$acc_no_sapeins[159]=	"	1003588212	";
$acc_no_sapeins[160]=	"	1003588751	";
$acc_no_sapeins[161]=	"	1003588191	";
$acc_no_sapeins[162]=	"	1003318665	";
$acc_no_sapeins[163]=	"	1003320040	";
$acc_no_sapeins[164]=	"	1003588778	";
$acc_no_sapeins[165]=	"	1003648720	";
$acc_no_sapeins[166]=	"	1003587909	";
$acc_no_sapeins[167]=	"	8400140834	";
$acc_no_sapeins[168]=	"	1000475590	";
$acc_no_sapeins[169]=	"	1003318525	";
$acc_no_sapeins[170]=	"	1003587925	";
$acc_no_sapeins[171]=	"	1003347347	";
$acc_no_sapeins[172]=	"	1003587968	";
$acc_no_sapeins[173]=	"	7300026656	";
$acc_no_sapeins[174]=	"	1003647618	";
$acc_no_sapeins[175]=	"	1003546218	";
$acc_no_sapeins[176]=	"	1000393682	";
$acc_no_sapeins[177]=	"	1003587810	";
$acc_no_sapeins[178]=	"	1001229347	";
$acc_no_sapeins[179]=	"	1003588468	";
$acc_no_sapeins[180]=	"	1003546234	";
$acc_no_sapeins[181]=	"	1003687598	";
$acc_no_sapeins[182]=	"	1003545165	";
$acc_no_sapeins[183]=	"	1001126157	";
$acc_no_sapeins[184]=	"	1003589090	";
$acc_no_sapeins[185]=	"	1003497268	";
$acc_no_sapeins[186]=	"	1003647219	";
$acc_no_sapeins[187]=	"	1001234359	";
$acc_no_sapeins[188]=	"	1003687113	";
$acc_no_sapeins[189]=	"	1003318860	";
$acc_no_sapeins[190]=	"	1003588395	";
$acc_no_sapeins[191]=	"	1003588034	";
$acc_no_sapeins[192]=	"	1002271576	";
$acc_no_sapeins[193]=	"	1100474862	";
$acc_no_sapeins[194]=	"	1003588590	";
$acc_no_sapeins[195]=	"	1003647961	";
$acc_no_sapeins[196]=	"	1003318703	";
$acc_no_sapeins[197]=	"	1001735510	";
$acc_no_sapeins[198]=	"	1003687172	";
$acc_no_sapeins[199]=	"	1003589316	";
$acc_no_sapeins[200]=	"	1003347312	";
$acc_no_sapeins[201]=	"	1003546170	";
$acc_no_sapeins[202]=	"	1003688489	";
$acc_no_sapeins[203]=	"	1003687423	";
$acc_no_sapeins[204]=	"	1003647723	";
$acc_no_sapeins[205]=	"	1003320724	";
$acc_no_sapeins[206]=	"	1000015572	";
$acc_no_sapeins[207]=	"	1003687059	";
$acc_no_sapeins[208]=	"	1003319602	";
$acc_no_sapeins[209]=	"	1003588701	";
$acc_no_sapeins[210]=	"	1003687491	";
$acc_no_sapeins[211]=	"	1001779231	";
$acc_no_sapeins[212]=	"	1003688063	";
$acc_no_sapeins[213]=	"	1003588336	";
$acc_no_sapeins[214]=	"	1000557626	";
$acc_no_sapeins[215]=	"	8300255265	";
$acc_no_sapeins[216]=	"	1003687679	";
$acc_no_sapeins[217]=	"	1003347681	";
$acc_no_sapeins[218]=	"	2400050571	";
$acc_no_sapeins[219]=	"	1003142737	";
$acc_no_sapeins[220]=	"	1002406919	";
$acc_no_sapeins[221]=	"	1003588697	";
$acc_no_sapeins[222]=	"	1000129870	";
$acc_no_sapeins[223]=	"	1001789890	";
$acc_no_sapeins[224]=	"	1000448291	";
$acc_no_sapeins[225]=	"	1003687881	";
$acc_no_sapeins[226]=	"	1001151518	";
$acc_no_sapeins[227]=	"	1003688101	";
$acc_no_sapeins[228]=	"	1000555691	";
$acc_no_sapeins[229]=	"	1003688225	";
$acc_no_sapeins[230]=	"	1003688080	";
$acc_no_sapeins[231]=	"	1003589138	";
$acc_no_sapeins[232]=	"	1000916022	";
$acc_no_sapeins[233]=	"	1003201431	";
$acc_no_sapeins[234]=	"	1003648355	";
$acc_no_sapeins[235]=	"	1003688322	";
$acc_no_sapeins[236]=	"	1200205677	";
$acc_no_sapeins[237]=	"	1300175672	";
$acc_no_sapeins[238]=	"	1000237281	";
$acc_no_sapeins[239]=	"	7300011918	";
$acc_no_sapeins[240]=	"	1002036411	";
$acc_no_sapeins[241]=	"	1100409441	";
$acc_no_sapeins[242]=	"	1100475079	";
$acc_no_sapeins[243]=	"	1100409084	";
$acc_no_sapeins[244]=	"	1100473769	";
$acc_no_sapeins[245]=	"	1100409220	";
$acc_no_sapeins[246]=	"	1100408835	";
$acc_no_sapeins[247]=	"	1100408606	";
$acc_no_sapeins[248]=	"	1100456571	";
$acc_no_sapeins[249]=	"	1100473971	";
$acc_no_sapeins[250]=	"	1100473220	";
$acc_no_sapeins[251]=	"	1100456058	";
$acc_no_sapeins[252]=	"	1100408690	";
$acc_no_sapeins[253]=	"	1100338608	";
$acc_no_sapeins[254]=	"	1100473921	";
$acc_no_sapeins[255]=	"	2000393748	";
$acc_no_sapeins[256]=	"	1100457011	";
$acc_no_sapeins[257]=	"	1100473912	";
$acc_no_sapeins[258]=	"	1100409271	";
$acc_no_sapeins[259]=	"	1100473891	";
$acc_no_sapeins[260]=	"	1100408991	";
$acc_no_sapeins[261]=	"	1100408827	";
$acc_no_sapeins[262]=	"	1100409289	";
$acc_no_sapeins[263]=	"	1100409076	";
$acc_no_sapeins[264]=	"	1100438611	";
$acc_no_sapeins[265]=	"	1100409106	";
$acc_no_sapeins[266]=	"	1100381619	";
$acc_no_sapeins[267]=	"	1100409181	";
$acc_no_sapeins[268]=	"	1003547206	";
$acc_no_sapeins[269]=	"	1100409416	";
$acc_no_sapeins[270]=	"	1100457330	";
$acc_no_sapeins[271]=	"	1001586255	";
$acc_no_sapeins[272]=	"	1100066004	";
$acc_no_sapeins[273]=	"	1100409459	";
$acc_no_sapeins[274]=	"	1100409408	";
$acc_no_sapeins[275]=	"	1200326458	";
$acc_no_sapeins[276]=	"	1200325281	";
$acc_no_sapeins[277]=	"	1200288114	";
$acc_no_sapeins[278]=	"	1200289749	";
$acc_no_sapeins[279]=	"	1200289471	";
$acc_no_sapeins[280]=	"	1200288611	";
$acc_no_sapeins[281]=	"	1200289595	";
$acc_no_sapeins[282]=	"	1200289862	";
$acc_no_sapeins[283]=	"	1200288173	";
$acc_no_sapeins[284]=	"	1200288939	";
$acc_no_sapeins[285]=	"	1200288157	";
$acc_no_sapeins[286]=	"	1200327802	";
$acc_no_sapeins[287]=	"	1200198620	";
$acc_no_sapeins[288]=	"	1200324382	";
$acc_no_sapeins[289]=	"	1200324811	";
$acc_no_sapeins[290]=	"	1200288874	";
$acc_no_sapeins[291]=	"	1200287959	";
$acc_no_sapeins[292]=	"	1200288491	";
$acc_no_sapeins[293]=	"	1200288840	";
$acc_no_sapeins[294]=	"	1200288360	";
$acc_no_sapeins[295]=	"	1200289153	";
$acc_no_sapeins[296]=	"	1200021371	";
$acc_no_sapeins[297]=	"	1200327420	";
$acc_no_sapeins[298]=	"	1200325486	";
$acc_no_sapeins[299]=	"	1200326245	";
$acc_no_sapeins[300]=	"	1200326083	";
$acc_no_sapeins[301]=	"	1200325133	";
$acc_no_sapeins[302]=	"	1200325478	";
$acc_no_sapeins[303]=	"	1200288581	";
$acc_no_sapeins[304]=	"	1200326130	";
$acc_no_sapeins[305]=	"	1200288637	";
$acc_no_sapeins[306]=	"	1200288564	";
$acc_no_sapeins[307]=	"	1200288815	";
$acc_no_sapeins[308]=	"	1200289056	";
$acc_no_sapeins[309]=	"	1200289251	";
$acc_no_sapeins[310]=	"	1200325915	";
$acc_no_sapeins[311]=	"	1200326261	";
$acc_no_sapeins[312]=	"	1200289269	";
$acc_no_sapeins[313]=	"	1200327853	";
$acc_no_sapeins[314]=	"	1200268644	";
$acc_no_sapeins[315]=	"	1200289099	";
$acc_no_sapeins[316]=	"	1200289455	";
$acc_no_sapeins[317]=	"	1200328493	";
$acc_no_sapeins[318]=	"	1200327594	";
$acc_no_sapeins[319]=	"	1200328353	";
$acc_no_sapeins[320]=	"	1200328434	";
$acc_no_sapeins[321]=	"	1200328175	";
$acc_no_sapeins[322]=	"	1200328078	";
$acc_no_sapeins[323]=	"	1200327861	";
$acc_no_sapeins[324]=	"	1200327870	";
$acc_no_sapeins[325]=	"	1200212894	";
$acc_no_sapeins[326]=	"	1200328388	";
$acc_no_sapeins[327]=	"	1300282274	";
$acc_no_sapeins[328]=	"	1300273917	";
$acc_no_sapeins[329]=	"	1300273895	";
$acc_no_sapeins[330]=	"	2600023020	";
$acc_no_sapeins[331]=	"	2600023046	";
$acc_no_sapeins[332]=	"	1000844285	";
$acc_no_sapeins[333]=	"	1300042214	";
$acc_no_sapeins[334]=	"	1300236574	";
$acc_no_sapeins[335]=	"	1300122251	";
$acc_no_sapeins[336]=	"	1300078430	";
$acc_no_sapeins[337]=	"	1300086335	";
$acc_no_sapeins[338]=	"	1400092493	";
$acc_no_sapeins[339]=	"	1400093210	";
$acc_no_sapeins[340]=	"	1400092485	";
$acc_no_sapeins[341]=	"	1400092728	";
$acc_no_sapeins[342]=	"	1400092582	";
$acc_no_sapeins[343]=	"	1200024567	";
$acc_no_sapeins[344]=	"	1400093287	";
$acc_no_sapeins[345]=	"	1400055326	";
$acc_no_sapeins[346]=	"	1500022373	";
$acc_no_sapeins[347]=	"	1600003435	";
$acc_no_sapeins[348]=	"	3200030038	";
$acc_no_sapeins[349]=	"	1600000908	";
$acc_no_sapeins[350]=	"	1700019406	";
$acc_no_sapeins[351]=	"	1800017936	";
$acc_no_sapeins[352]=	"	1800014856	";
$acc_no_sapeins[353]=	"	1800007213	";
$acc_no_sapeins[354]=	"	1900091381	";
$acc_no_sapeins[355]=	"	1900091275	";
$acc_no_sapeins[356]=	"	1900091046	";
$acc_no_sapeins[357]=	"	1900091186	";
$acc_no_sapeins[358]=	"	1900091780	";
$acc_no_sapeins[359]=	"	2000392172	";
$acc_no_sapeins[360]=	"	2000437770	";
$acc_no_sapeins[361]=	"	2000437966	";
$acc_no_sapeins[362]=	"	2000393420	";
$acc_no_sapeins[363]=	"	2000437940	";
$acc_no_sapeins[364]=	"	2000437931	";
$acc_no_sapeins[365]=	"	2000393811	";
$acc_no_sapeins[366]=	"	2000367496	";
$acc_no_sapeins[367]=	"	2000436277	";
$acc_no_sapeins[368]=	"	2000438016	";
$acc_no_sapeins[369]=	"	2000436919	";
$acc_no_sapeins[370]=	"	2000437915	";
$acc_no_sapeins[371]=	"	2000392377	";
$acc_no_sapeins[372]=	"	2000394035	";
$acc_no_sapeins[373]=	"	2000438733	";
$acc_no_sapeins[374]=	"	2000392211	";
$acc_no_sapeins[375]=	"	2000391974	";
$acc_no_sapeins[376]=	"	2000394221	";
$acc_no_sapeins[377]=	"	2000437133	";
$acc_no_sapeins[378]=	"	2000393306	";
$acc_no_sapeins[379]=	"	2000438008	";
$acc_no_sapeins[380]=	"	2000438075	";
$acc_no_sapeins[381]=	"	2000438199	";
$acc_no_sapeins[382]=	"	2000438351	";
$acc_no_sapeins[383]=	"	2000438440	";
$acc_no_sapeins[384]=	"	2000393764	";
$acc_no_sapeins[385]=	"	2000438741	";
$acc_no_sapeins[386]=	"	2000373127	";
$acc_no_sapeins[387]=	"	2000394183	";
$acc_no_sapeins[388]=	"	2000392971	";
$acc_no_sapeins[389]=	"	2000439438	";
$acc_no_sapeins[390]=	"	2000392997	";
$acc_no_sapeins[391]=	"	2000439446	";
$acc_no_sapeins[392]=	"	2000394116	";
$acc_no_sapeins[393]=	"	2000440401	";
$acc_no_sapeins[394]=	"	2000307558	";
$acc_no_sapeins[395]=	"	2000139299	";
$acc_no_sapeins[396]=	"	2000268391	";
$acc_no_sapeins[397]=	"	2000372961	";
$acc_no_sapeins[398]=	"	2100171313	";
$acc_no_sapeins[399]=	"	2100171330	";
$acc_no_sapeins[400]=	"	2100152564	";
$acc_no_sapeins[401]=	"	2100152602	";
$acc_no_sapeins[402]=	"	2100152726	";
$acc_no_sapeins[403]=	"	2100152637	";
$acc_no_sapeins[404]=	"	2100152483	";
$acc_no_sapeins[405]=	"	2100171208	";
$acc_no_sapeins[406]=	"	2100171615	";
$acc_no_sapeins[407]=	"	2100171488	";
$acc_no_sapeins[408]=	"	2100085883	";
$acc_no_sapeins[409]=	"	2100171437	";
$acc_no_sapeins[410]=	"	2100171551	";
$acc_no_sapeins[411]=	"	2100171381	";
$acc_no_sapeins[412]=	"	2100171763	";
$acc_no_sapeins[413]=	"	2100129406	";
$acc_no_sapeins[414]=	"	2100107640	";
$acc_no_sapeins[415]=	"	2100171721	";
$acc_no_sapeins[416]=	"	2100048155	";
$acc_no_sapeins[417]=	"	2200053983	";
$acc_no_sapeins[418]=	"	2200054203	";
$acc_no_sapeins[419]=	"	2200057555	";
$acc_no_sapeins[420]=	"	2200054262	";
$acc_no_sapeins[421]=	"	2200053916	";
$acc_no_sapeins[422]=	"	2200054351	";
$acc_no_sapeins[423]=	"	2200054297	";
$acc_no_sapeins[424]=	"	2200054424	";
$acc_no_sapeins[425]=	"	2200056125	";
$acc_no_sapeins[426]=	"	2300028549	";
$acc_no_sapeins[427]=	"	2300028492	";
$acc_no_sapeins[428]=	"	2300028506	";
$acc_no_sapeins[429]=	"	2300028450	";
$acc_no_sapeins[430]=	"	2300028581	";
$acc_no_sapeins[431]=	"	2300028654	";
$acc_no_sapeins[432]=	"	2400073490	";
$acc_no_sapeins[433]=	"	2400019045	";
$acc_no_sapeins[434]=	"	2400018758	";
$acc_no_sapeins[435]=	"	2400027030	";
$acc_no_sapeins[436]=	"	2400078009	";
$acc_no_sapeins[437]=	"	2500038360	";
$acc_no_sapeins[438]=	"	2600022805	";
$acc_no_sapeins[439]=	"	2600022945	";
$acc_no_sapeins[440]=	"	3000166131	";
$acc_no_sapeins[441]=	"	3000155813	";
$acc_no_sapeins[442]=	"	3000155589	";
$acc_no_sapeins[443]=	"	3000157069	";
$acc_no_sapeins[444]=	"	3000166238	";
$acc_no_sapeins[445]=	"	3000157000	";
$acc_no_sapeins[446]=	"	3000166271	";
$acc_no_sapeins[447]=	"	3000156496	";
$acc_no_sapeins[448]=	"	3000155490	";
$acc_no_sapeins[449]=	"	3000137670	";
$acc_no_sapeins[450]=	"	3000156488	";
$acc_no_sapeins[451]=	"	3000156011	";
$acc_no_sapeins[452]=	"	3000136061	";
$acc_no_sapeins[453]=	"	3000157026	";
$acc_no_sapeins[454]=	"	3000155767	";
$acc_no_sapeins[455]=	"	3000156551	";
$acc_no_sapeins[456]=	"	3000156020	";
$acc_no_sapeins[457]=	"	3000155945	";
$acc_no_sapeins[458]=	"	3000165011	";
$acc_no_sapeins[459]=	"	3000156445	";
$acc_no_sapeins[460]=	"	3000156615	";
$acc_no_sapeins[461]=	"	3000009701	";
$acc_no_sapeins[462]=	"	3000120190	";
$acc_no_sapeins[463]=	"	3000040081	";
$acc_no_sapeins[464]=	"	3000126228	";
$acc_no_sapeins[465]=	"	3000044990	";
$acc_no_sapeins[466]=	"	3000014870	";
$acc_no_sapeins[467]=	"	3100039378	";
$acc_no_sapeins[468]=	"	3100039432	";
$acc_no_sapeins[469]=	"	3100039327	";
$acc_no_sapeins[470]=	"	3100039602	";
$acc_no_sapeins[471]=	"	3100039173	";
$acc_no_sapeins[472]=	"	3100039408	";
$acc_no_sapeins[473]=	"	3100039564	";
$acc_no_sapeins[474]=	"	3100039599	";
$acc_no_sapeins[475]=	"	3100039700	";
$acc_no_sapeins[476]=	"	3200039124	";
$acc_no_sapeins[477]=	"	3200038993	";
$acc_no_sapeins[478]=	"	3200038845	";
$acc_no_sapeins[479]=	"	3200039027	";
$acc_no_sapeins[480]=	"	3300032521	";
$acc_no_sapeins[481]=	"	3300032458	";
$acc_no_sapeins[482]=	"	3300032733	";
$acc_no_sapeins[483]=	"	3300032474	";
$acc_no_sapeins[484]=	"	3300032741	";
$acc_no_sapeins[485]=	"	3300032661	";
$acc_no_sapeins[486]=	"	3300032610	";
$acc_no_sapeins[487]=	"	3400070165	";
$acc_no_sapeins[488]=	"	3400071056	";
$acc_no_sapeins[489]=	"	3400071277	";
$acc_no_sapeins[490]=	"	3400070742	";
$acc_no_sapeins[491]=	"	3400071226	";
$acc_no_sapeins[492]=	"	3400070700	";
$acc_no_sapeins[493]=	"	3400070408	";
$acc_no_sapeins[494]=	"	3400070335	";
$acc_no_sapeins[495]=	"	3400070718	";
$acc_no_sapeins[496]=	"	3400070238	";
$acc_no_sapeins[497]=	"	3400070521	";
$acc_no_sapeins[498]=	"	3400070254	";
$acc_no_sapeins[499]=	"	3400070793	";
$acc_no_sapeins[500]=	"	3400070343	";
$acc_no_sapeins[501]=	"	3500019536	";
$acc_no_sapeins[502]=	"	3500019587	";
$acc_no_sapeins[503]=	"	3500019617	";
$acc_no_sapeins[504]=	"	3500019633	";
$acc_no_sapeins[505]=	"	3500015832	";
$acc_no_sapeins[506]=	"	3500019595	";
$acc_no_sapeins[507]=	"	3500019552	";
$acc_no_sapeins[508]=	"	3600042700	";
$acc_no_sapeins[509]=	"	3600042319	";
$acc_no_sapeins[510]=	"	3600000501	";
$acc_no_sapeins[511]=	"	4000120905	";
$acc_no_sapeins[512]=	"	4000121405	";
$acc_no_sapeins[513]=	"	4000121588	";
$acc_no_sapeins[514]=	"	4000121545	";
$acc_no_sapeins[515]=	"	4000121502	";
$acc_no_sapeins[516]=	"	4000121481	";
$acc_no_sapeins[517]=	"	4000120671	";
$acc_no_sapeins[518]=	"	4000120921	";
$acc_no_sapeins[519]=	"	4000120051	";
$acc_no_sapeins[520]=	"	1003347932	";
$acc_no_sapeins[521]=	"	4000121651	";
$acc_no_sapeins[522]=	"	4000120310	";
$acc_no_sapeins[523]=	"	4000120786	";
$acc_no_sapeins[524]=	"	4000120972	";
$acc_no_sapeins[525]=	"	4000121456	";
$acc_no_sapeins[526]=	"	4000121464	";
$acc_no_sapeins[527]=	"	4000121081	";
$acc_no_sapeins[528]=	"	4000121341	";
$acc_no_sapeins[529]=	"	4000121511	";
$acc_no_sapeins[530]=	"	4000121308	";
$acc_no_sapeins[531]=	"	4000121448	";
$acc_no_sapeins[532]=	"	4100076398	";
$acc_no_sapeins[533]=	"	4100076525	";
$acc_no_sapeins[534]=	"	4100076509	";
$acc_no_sapeins[535]=	"	4100076631	";
$acc_no_sapeins[536]=	"	4100102097	";
$acc_no_sapeins[537]=	"	4100012128	";
$acc_no_sapeins[538]=	"	4100102135	";
$acc_no_sapeins[539]=	"	4200027020	";
$acc_no_sapeins[540]=	"	4200027259	";
$acc_no_sapeins[541]=	"	4200027194	";
$acc_no_sapeins[542]=	"	4200027267	";
$acc_no_sapeins[543]=	"	4300032513	";
$acc_no_sapeins[544]=	"	4300032637	";
$acc_no_sapeins[545]=	"	4300032602	";
$acc_no_sapeins[546]=	"	4300032661	";
$acc_no_sapeins[547]=	"	4500044736	";
$acc_no_sapeins[548]=	"	4500056378	";
$acc_no_sapeins[549]=	"	4500044990	";
$acc_no_sapeins[550]=	"	4500045023	";
$acc_no_sapeins[551]=	"	4600031997	";
$acc_no_sapeins[552]=	"	4700042851	";
$acc_no_sapeins[553]=	"	4700042834	";
$acc_no_sapeins[554]=	"	4700042796	";
$acc_no_sapeins[555]=	"	4800020816	";
$acc_no_sapeins[556]=	"	4800020751	";
$acc_no_sapeins[557]=	"	4800017386	";
$acc_no_sapeins[558]=	"	4900021440	";
$acc_no_sapeins[559]=	"	4900021415	";
$acc_no_sapeins[560]=	"	4900021555	";
$acc_no_sapeins[561]=	"	4900021474	";
$acc_no_sapeins[562]=	"	4900021369	";
$acc_no_sapeins[563]=	"	4900021431	";
$acc_no_sapeins[564]=	"	5000337212	";
$acc_no_sapeins[565]=	"	5000337646	";
$acc_no_sapeins[566]=	"	5000336623	";
$acc_no_sapeins[567]=	"	5000337409	";
$acc_no_sapeins[568]=	"	5000337727	";
$acc_no_sapeins[569]=	"	5000341198	";
$acc_no_sapeins[570]=	"	5000337182	";
$acc_no_sapeins[571]=	"	5000263235	";
$acc_no_sapeins[572]=	"	5000335830	";
$acc_no_sapeins[573]=	"	5000336755	";
$acc_no_sapeins[574]=	"	5000337514	";
$acc_no_sapeins[575]=	"	5000337387	";
$acc_no_sapeins[576]=	"	5000039076	";
$acc_no_sapeins[577]=	"	5000338057	";
$acc_no_sapeins[578]=	"	5000339215	";
$acc_no_sapeins[579]=	"	5000285263	";
$acc_no_sapeins[580]=	"	5000025814	";
$acc_no_sapeins[581]=	"	5000049420	";
$acc_no_sapeins[582]=	"	5000340370	";
$acc_no_sapeins[583]=	"	5000013956	";
$acc_no_sapeins[584]=	"	5000221419	";
$acc_no_sapeins[585]=	"	5100053356	";
$acc_no_sapeins[586]=	"	5100052783	";
$acc_no_sapeins[587]=	"	5100052805	";
$acc_no_sapeins[588]=	"	5100052627	";
$acc_no_sapeins[589]=	"	5100042338	";
$acc_no_sapeins[590]=	"	5100049430	";
$acc_no_sapeins[591]=	"	5300003476	";
$acc_no_sapeins[592]=	"	5400037691	";
$acc_no_sapeins[593]=	"	5400037879	";
$acc_no_sapeins[594]=	"	5500028812	";
$acc_no_sapeins[595]=	"	5500028545	";
$acc_no_sapeins[596]=	"	5500028944	";
$acc_no_sapeins[597]=	"	5500029070	";
$acc_no_sapeins[598]=	"	5500028871	";
$acc_no_sapeins[599]=	"	5500028936	";
$acc_no_sapeins[600]=	"	5500028928	";
$acc_no_sapeins[601]=	"	5500028791	";
$acc_no_sapeins[602]=	"	5600031351	";
$acc_no_sapeins[603]=	"	5600031475	";
$acc_no_sapeins[604]=	"	5700110130	";
$acc_no_sapeins[605]=	"	5700109832	";
$acc_no_sapeins[606]=	"	5700111039	";
$acc_no_sapeins[607]=	"	5700078694	";
$acc_no_sapeins[608]=	"	5700110253	";
$acc_no_sapeins[609]=	"	5700110580	";
$acc_no_sapeins[610]=	"	5700089360	";
$acc_no_sapeins[611]=	"	6000068131	";
$acc_no_sapeins[612]=	"	6000067682	";
$acc_no_sapeins[613]=	"	6100016320	";
$acc_no_sapeins[614]=	"	6100016397	";
$acc_no_sapeins[615]=	"	6100016451	";
$acc_no_sapeins[616]=	"	6200034427	";
$acc_no_sapeins[617]=	"	6200030456	";
$acc_no_sapeins[618]=	"	6300030865	";
$acc_no_sapeins[619]=	"	6300044050	";
$acc_no_sapeins[620]=	"	6300044181	";
$acc_no_sapeins[621]=	"	6300009254	";
$acc_no_sapeins[622]=	"	6400023437	";
$acc_no_sapeins[623]=	"	6500069633	";
$acc_no_sapeins[624]=	"	6500070003	";
$acc_no_sapeins[625]=	"	6500069986	";
$acc_no_sapeins[626]=	"	6500069277	";
$acc_no_sapeins[627]=	"	6500095979	";
$acc_no_sapeins[628]=	"	6500010671	";
$acc_no_sapeins[629]=	"	6500069587	";
$acc_no_sapeins[630]=	"	6500059557	";
$acc_no_sapeins[631]=	"	6700004799	";
$acc_no_sapeins[632]=	"	6700035228	";

$acc_no_sapeins[633]=	"	6700035511	";
$acc_no_sapeins[634]=	"	6700052700	";
$acc_no_sapeins[635]=	"	6700052769	";
$acc_no_sapeins[636]=	"	6700035309	";
$acc_no_sapeins[637]=	"	6700035368	";
$acc_no_sapeins[638]=	"	6700052661	";
$acc_no_sapeins[639]=	"	7000088427	";
$acc_no_sapeins[640]=	"	7000011904	";
$acc_no_sapeins[641]=	"	7000071559	";
$acc_no_sapeins[642]=	"	7000089008	";
$acc_no_sapeins[643]=	"	7000088745	";
$acc_no_sapeins[644]=	"	7000089407	";
$acc_no_sapeins[645]=	"	7000088753	";
$acc_no_sapeins[646]=	"	7000088494	";
$acc_no_sapeins[647]=	"	7000088648	";
$acc_no_sapeins[648]=	"	7000089334	";
$acc_no_sapeins[649]=	"	7000088737	";
$acc_no_sapeins[650]=	"	7000089121	";
$acc_no_sapeins[651]=	"	7000073080	";
$acc_no_sapeins[652]=	"	7100051657	";
$acc_no_sapeins[653]=	"	7100051436	";
$acc_no_sapeins[654]=	"	7100064694	";
$acc_no_sapeins[655]=	"	7100037271	";
$acc_no_sapeins[656]=	"	7100064791	";
$acc_no_sapeins[657]=	"	7100051797	";
$acc_no_sapeins[658]=	"	7100042399	";
$acc_no_sapeins[659]=	"	7100064830	";
$acc_no_sapeins[660]=	"	7200070262	";
$acc_no_sapeins[661]=	"	7200083801	";
$acc_no_sapeins[662]=	"	7200070475	";
$acc_no_sapeins[663]=	"	7200070521	";
$acc_no_sapeins[664]=	"	7200069671	";
$acc_no_sapeins[665]=	"	7200069442	";
$acc_no_sapeins[666]=	"	7200070190	";
$acc_no_sapeins[667]=	"	7200070645	";
$acc_no_sapeins[668]=	"	7200069914	";
$acc_no_sapeins[669]=	"	7200037869	";
$acc_no_sapeins[670]=	"	7200070726	";
$acc_no_sapeins[671]=	"	7200069931	";
$acc_no_sapeins[672]=	"	7200070246	";
$acc_no_sapeins[673]=	"	7200031992	";
$acc_no_sapeins[674]=	"	7200070581	";
$acc_no_sapeins[675]=	"	7300138403	";
$acc_no_sapeins[676]=	"	7300147011	";
$acc_no_sapeins[677]=	"	7300147461	";
$acc_no_sapeins[678]=	"	7300146597	";
$acc_no_sapeins[679]=	"	7300146601	";
$acc_no_sapeins[680]=	"	7300147232	";
$acc_no_sapeins[681]=	"	7300139019	";
$acc_no_sapeins[682]=	"	7300146856	";
$acc_no_sapeins[683]=	"	7300147208	";
$acc_no_sapeins[684]=	"	7300147127	";
$acc_no_sapeins[685]=	"	7300147500	";
$acc_no_sapeins[686]=	"	7300146937	";
$acc_no_sapeins[687]=	"	7300147038	";
$acc_no_sapeins[688]=	"	7300029205	";
$acc_no_sapeins[689]=	"	7300147364	";
$acc_no_sapeins[690]=	"	7300003745	";
$acc_no_sapeins[691]=	"	7300147691	";
$acc_no_sapeins[692]=	"	7400172697	";
$acc_no_sapeins[693]=	"	7400171381	";
$acc_no_sapeins[694]=	"	7400171828	";
$acc_no_sapeins[695]=	"	7400173359	";
$acc_no_sapeins[696]=	"	1002347017	";
$acc_no_sapeins[697]=	"	7400173588	";
$acc_no_sapeins[698]=	"	7400174291	";
$acc_no_sapeins[699]=	"	7400130188	";
$acc_no_sapeins[700]=	"	7400167928	";
$acc_no_sapeins[701]=	"	1200147588	";
$acc_no_sapeins[702]=	"	7500025971	";
$acc_no_sapeins[703]=	"	7500026391	";
$acc_no_sapeins[704]=	"	7500026382	";
$acc_no_sapeins[705]=	"	7500025793	";
$acc_no_sapeins[706]=	"	7500026013	";
$acc_no_sapeins[707]=	"	7500026641	";
$acc_no_sapeins[708]=	"	7600049813	";
$acc_no_sapeins[709]=	"	7600049929	";
$acc_no_sapeins[710]=	"	7700083681	";
$acc_no_sapeins[711]=	"	7700049343	";
$acc_no_sapeins[712]=	"	7700049254	";
$acc_no_sapeins[713]=	"	7700049645	";
$acc_no_sapeins[714]=	"	7700082871	";
$acc_no_sapeins[715]=	"	7700083061	";
$acc_no_sapeins[716]=	"	7700049416	";
$acc_no_sapeins[717]=	"	7700029644	";
$acc_no_sapeins[718]=	"	7700083142	";
$acc_no_sapeins[719]=	"	7700050309	";
$acc_no_sapeins[720]=	"	8000073528	";
$acc_no_sapeins[721]=	"	8000072327	";
$acc_no_sapeins[722]=	"	8000073676	";
$acc_no_sapeins[723]=	"	8000072718	";
$acc_no_sapeins[724]=	"	8000072696	";
$acc_no_sapeins[725]=	"	8000072483	";
$acc_no_sapeins[726]=	"	8000072513	";
$acc_no_sapeins[727]=	"	8000073404	";
$acc_no_sapeins[728]=	"	8000000962	";
$acc_no_sapeins[729]=	"	8100057303	";
$acc_no_sapeins[730]=	"	8100073147	";
$acc_no_sapeins[731]=	"	8100057311	";
$acc_no_sapeins[732]=	"	8100057222	";
$acc_no_sapeins[733]=	"	8100073015	";
$acc_no_sapeins[734]=	"	8100057915	";
$acc_no_sapeins[735]=	"	8300251944	";
$acc_no_sapeins[736]=	"	8300251740	";
$acc_no_sapeins[737]=	"	8300252061	";
$acc_no_sapeins[738]=	"	8300252622	";
$acc_no_sapeins[739]=	"	8300251057	";
$acc_no_sapeins[740]=	"	8300252045	";
$acc_no_sapeins[741]=	"	8300251880	";
$acc_no_sapeins[742]=	"	8300252690	";
$acc_no_sapeins[743]=	"	8300250964	";
$acc_no_sapeins[744]=	"	8300251634	";
$acc_no_sapeins[745]=	"	8300252533	";
$acc_no_sapeins[746]=	"	8300251545	";
$acc_no_sapeins[747]=	"	8300254579	";
$acc_no_sapeins[748]=	"	8300069372	";
$acc_no_sapeins[749]=	"	8300252088	";
$acc_no_sapeins[750]=	"	8300250751	";
$acc_no_sapeins[751]=	"	8300250930	";
$acc_no_sapeins[752]=	"	8300251481	";
$acc_no_sapeins[753]=	"	8300251863	";
$acc_no_sapeins[754]=	"	8300251766	";
$acc_no_sapeins[755]=	"	8300252771	";
$acc_no_sapeins[756]=	"	8300252568	";
$acc_no_sapeins[757]=	"	8300252720	";
$acc_no_sapeins[758]=	"	8300252614	";
$acc_no_sapeins[759]=	"	8300251928	";
$acc_no_sapeins[760]=	"	8300252541	";
$acc_no_sapeins[761]=	"	8300252606	";
$acc_no_sapeins[762]=	"	8300252983	";
$acc_no_sapeins[763]=	"	8300253017	";
$acc_no_sapeins[764]=	"	8300253025	";
$acc_no_sapeins[765]=	"	8300253106	";
$acc_no_sapeins[766]=	"	8300253408	";
$acc_no_sapeins[767]=	"	8300253416	";
$acc_no_sapeins[768]=	"	8300211071	";
$acc_no_sapeins[769]=	"	8300255664	";
$acc_no_sapeins[770]=	"	8300255656	";
$acc_no_sapeins[771]=	"	8300255770	";
$acc_no_sapeins[772]=	"	8400136365	";
$acc_no_sapeins[773]=	"	8400137213	";
$acc_no_sapeins[774]=	"	8400136527	";
$acc_no_sapeins[775]=	"	8400133781	";
$acc_no_sapeins[776]=	"	8400134397	";
$acc_no_sapeins[777]=	"	8400133854	";
$acc_no_sapeins[778]=	"	8400134214	";
$acc_no_sapeins[779]=	"	8400140150	";
$acc_no_sapeins[780]=	"	8400013344	";
$acc_no_sapeins[781]=	"	8400140800	";
$acc_no_sapeins[782]=	"	8400135521	";
$acc_no_sapeins[783]=	"	8400130961	";
$acc_no_sapeins[784]=	"	8400141059	";
$acc_no_sapeins[785]=	"	8400080921	";
$acc_no_sapeins[786]=	"	8400140753	";
$acc_no_sapeins[787]=	"	8400118910	";
$acc_no_sapeins[788]=	"	8400141091	";
$acc_no_sapeins[789]=	"	8400141083	";
$acc_no_sapeins[790]=	"	8600038324	";
$acc_no_sapeins[791]=	"	8600038341	";
$acc_no_sapeins[792]=	"	8600039347	";
$acc_no_sapeins[793]=	"	8600039061	";
$acc_no_sapeins[794]=	"	8600049563	";
$acc_no_sapeins[795]=	"	8000072661	";
$acc_no_sapeins[796]=	"	9000205671	";
$acc_no_sapeins[797]=	"	9000206804	";
$acc_no_sapeins[798]=	"	9000206651	";
$acc_no_sapeins[799]=	"	9000207631	";
$acc_no_sapeins[800]=	"	9000206316	";
$acc_no_sapeins[801]=	"	9000206481	";
$acc_no_sapeins[802]=	"	9000205492	";
$acc_no_sapeins[803]=	"	9000207819	";
$acc_no_sapeins[804]=	"	9000206294	";
$acc_no_sapeins[805]=	"	9000207860	";
$acc_no_sapeins[806]=	"	9000207941	";
$acc_no_sapeins[807]=	"	9000207223	";
$acc_no_sapeins[808]=	"	9000206863	";
$acc_no_sapeins[809]=	"	9000206537	";
$acc_no_sapeins[810]=	"	9000207924	";
$acc_no_sapeins[811]=	"	9000207363	";
$acc_no_sapeins[812]=	"	9000207843	";
$acc_no_sapeins[813]=	"	9000021766	";
$acc_no_sapeins[814]=	"	9000129842	";
$acc_no_sapeins[815]=	"	9100018937	";
$acc_no_sapeins[816]=	"	9100018732	";
$acc_no_sapeins[817]=	"	9100019623	";
$acc_no_sapeins[818]=	"	9100019704	";
$acc_no_sapeins[819]=	"	9200071767	";
$acc_no_sapeins[820]=	"	9300026348	";
$acc_no_sapeins[821]=	"	9300026178	";
$acc_no_sapeins[822]=	"	9300023071	";
$acc_no_sapeins[823]=	"	9600033161	";

//***************************************************************


			
			for($i=0;$i<=823;$i++){
				//echo "$regis_no[$i], $acc_no_wpd[$i], $acc_no_sapeins[$i]" . ", ";
				
			
					$regis_not = trim($regis_no[$i]);
					$acc_no_wpdt = trim($acc_no_wpd[$i]);
					$acc_no_sapeinst = trim($acc_no_sapeins[$i]);
					
					echo "{$i}, {$regis_not}, {$acc_no_wpdt}, {$acc_no_sapeinst} <br>";
				
				//$registername = "-";
				
				
				//เริ่ม update data=====================================
					$sts = 0; 
					//insert CleansingTb
					$clsd=CleansingTb::model()->findByAttributes(array('clsg_registernumber'=>$regis_not));
					if(!$clsd){
		   				$CleansingTb = new CleansingTb();
		     			$CleansingTb->clsg_registernumber = $regis_not;
			 			$CleansingTb->clsg_wpdaccno = $acc_no_wpdt;
			 			$CleansingTb->clsg_sapainsaccno = $acc_no_sapeinst;
			 			$CleansingTb->clsg_registername = $registername;
			 			$CleansingTb->clsg_createby = Yii::app()->user->username;
			 			$CleansingTb->clsg_created = date('Y-m-d H:i:s');
			 			$CleansingTb->clsg_updateby = Yii::app()->user->username;
			 			$CleansingTb->clsg_modified = date('Y-m-d H:i:s');
			 			$CleansingTb->clsg_remark = 'y';
			 			$CleansingTb->clsg_status = 1;
			 			if($CleansingTb->save()){
							//echo "{$r}, {$regis_no}, {$acc_no_wpd}, {$acc_no_sapeins} <br>";
							$sts = 0;
				 			//update data to table cropinfo_tmp ====================
				 			$cif=CropinfoTmpTb::model()->findByAttributes(array('registernumber'=>$regis_not));
							if($cif){
				  				$cif->acc_no = $acc_no_sapeinst;
				  				$cif->crop_updateby = Yii::app()->user->username;
				  				$cif->crop_updatetime = date('Y-m-d H:i:s');
				  				$cif->crop_remark = "A";
				  				$cif->crop_status = 4;
				  				if($cif->save()){
									$sts = 0;
									//$msg3 = "update data is success.";
									// update accnumber===============================
									  $anb=AccnumberTb::model()->findByAttributes(array('acc_regis_no'=>$regis_not));
									  if($anb){
									  	$anb->acc_active_flag = 'C';
									  	$anb->acc_updateby = Yii::app()->user->username;
									  	$anb->acc_modified = date('Y-m-d H:i:s');
									  	$anb->acc_remark = $acc_no_sapeinst;
									  	$anb->acc_status = 5;
									  	if($anb->save()){
										  $sts = 0;
										  // update EmpstateTb =============================================
										  $est=EmpstateTb::model()->findByAttributes(array('ems_registernumber'=>$regis_not));
										  if($est){
											$est->ems_updateby = Yii::app()->user->username;
											$est->ems_modified = date('Y-m-d H:i:s');
											$est->ems_remark = $acc_no_sapeinst;
											$est->ems_status = 2;
											if($est->save()){
												$sts = 0;
											}else{
												$sts = 2;
											}//if
										  }//if
										  
											//update crop_v_bran =========================================
											$cvb=CropVBran::model()->findByAttributes(array('registernumber'=>$regis_not));
											if($cvb){
											  $cvb->acc_no = $acc_no_sapeinst;
											  $cvb->crop_remark = 'A';
											  $cvb->crop_updatetime = date('Y-m-d H:i:s');
											  $cvb->crop_status = 4;
											  if($cvb->save()){
												  $sts = 0;
											  }else{
												  $sts = 1;
											  }
											}//if
										  
										  
									  	}else{//if
											$sts = 3;
										}//if
									  }else{//if
									  	$sts = 4;
									  }//if
								}else{//if
									$sts = 5;
								}
							}//if
						}//if
					}//if
					//จบ update data=====================================
					
					
			}//for $i
				

		//**************************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}//if
	}//function
	
	public function actionDownloadtxtfilefrmsftpsapeinsauto(){
		
		$username = "sys";
		
		$action = $_POST['action'];
		$dwntxt = $_POST['dwntxt'];
		
		$localpathf = Yii::app()->Cgentextfile->localpathd . $dwntxt; //"C:/xampp/htdocs/wpdtextfile/out/" . $dwntxt;
		$remotepathf = Yii::app()->Cgentextfile->remotepathd . $dwntxt; //"/home/wpdusr/uploaddir/" . $dwntxt; //T8000_D621030.txt";
		
		// checking whether file exists or not 
		if (file_exists($localpathf))  
		{ 
			echo "ไฟล์ชื่อ : {$dwntxt} มีอยู่แล้ว"; 
		} 
		else 
		{ 
			if(Yii::app()->Cgentextfile->getConnectionsftp()){
			  $sftp = ssh2_sftp(Yii::app()->Cgentextfile->conn);
			  $contents = file_get_contents("ssh2.sftp://" . intval($sftp) . "$remotepathf");
			  if(file_put_contents($localpathf,$contents)){
				  
				//เพิ่มรายการไฟล์ที่ donwload ลงใน table SapainstxtfileTb  *******
				$SapainstxtfileTb = new SapainstxtfileTb();
				$SapainstxtfileTb->sptf_filename = $dwntxt;
				$SapainstxtfileTb->sptf_path = $localpathf;
				$SapainstxtfileTb->sptf_numrec = 0;
				$SapainstxtfileTb->sptf_createby = $username;
				$SapainstxtfileTb->sptf_created = date('Y-m-d H:i:s');
				$SapainstxtfileTb->sptf_updateby = $username;
				$SapainstxtfileTb->sptf_modified = date('Y-m-d H:i:s');
				$SapainstxtfileTb->sptf_remark = "-";
				$SapainstxtfileTb->sptf_status = 1;
				if($SapainstxtfileTb->save()){
					//	
				}else{
					//
				}//if
				echo "Success to download {$dwntxt} <br>";
				
				//เริ่มอ่าน textfile ที่ละบรรทัด แล้วเก็บค่าไว้ในตัวแปร array
				$data = file_get_contents($localpathf);
				$data   = explode("\n", $data);
				$ln = 0;
				for ($line = 0; $line < count($data); $line++) { 
					$dataln   = explode("|", $data[$line]);
					if(isset($dataln[8])){
						if(intval($dataln[8])>0){ 
							$sad_regisno = trim($dataln[8]);
							$sapeinsalldataTb=SapeinsalldataTb::model()->findByAttributes(array('sad_regisno'=>$sad_regisno));
							if($sapeinsalldataTb){
								//
							}else{
								 $insert_sp = new SapeinsalldataTb();
								 $insert_sp->sad_regisno = trim($dataln[8]);
								 $insert_sp->sad_accno = trim($dataln[3]);
								 $insert_sp->sad_createby = $username;
								 $insert_sp->sad_created = date('Y-m-d H:i:s');
								 $insert_sp->sad_updateby = $username;
								 $insert_sp->sad_modified = date('Y-m-d H:i:s');
								 $insert_sp->sad_remark = "N";
								 $insert_sp->sad_status = 1;
								 if($insert_sp->save()){
									 echo "{$ln}, ha {$dataln[8]} <br>";
								 }else{//if
								 	$msg = $insert_sp->getErrors();
								 	echo "{$ln},{$dataln[8]},{$dataln[3]} can't insert data <br>";
									print_r($msg);
								 }
							}//if
						}else{
							//
						}//if
					
					}else{
						//echo "{$ln}, nh {$dataln[8]} <br>";
					}
					$ln += 1;
				}//for
				//echo "{$ln} <br>";
              }else{
				echo "Failed to download {$dwntxt} <br>";
              }
			}
		}//if
		
	}//function
	
	public function actionCleansingdatastep2(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//**************************************************************
			$action = $_POST['action'];
			$regisnum = $_POST['regisnum'];
			
			$registername = "-";
			
			//ค้นหาเลช 10 หลักของ wpd
			$accnumbertb=AccnumberTb::model()->findByAttributes(array('acc_regis_no'=>$regisnum));
			if($accnumbertb){
				$acc_no_wpdt = $accnumbertb->acc_no;
			}//if
			
			//เริ่มค้นหาข้อมูลจาก SapeinsalldataTb
			$sapeinsalldataTb=SapeinsalldataTb::model()->findByAttributes(array('sad_regisno'=>$regisnum));
			if($sapeinsalldataTb){//ถ้ามีเลขนี้อยู่ใน sapeins แล้ว
				//เรียกใช้ฟังก์ชั่น cleansing data
				$regis_not = $sapeinsalldataTb->sad_regisno;
				$acc_no_sapeinst = $sapeinsalldataTb->sad_accno;
				
				//echo "{$regis_not},{$acc_no_sapeinst}, {$acc_no_wpdt}";
				
				
				//เริ่ม update data=====================================
					$sts = 0; 
					//insert CleansingTb
					$clsd=CleansingTb::model()->findByAttributes(array('clsg_registernumber'=>$regis_not));
					if(!$clsd){
		   				$CleansingTb = new CleansingTb();
		     			$CleansingTb->clsg_registernumber = $regis_not;
			 			$CleansingTb->clsg_wpdaccno = $acc_no_wpdt;
			 			$CleansingTb->clsg_sapainsaccno = $acc_no_sapeinst;
			 			$CleansingTb->clsg_registername = $registername;
			 			$CleansingTb->clsg_createby = Yii::app()->user->username;
			 			$CleansingTb->clsg_created = date('Y-m-d H:i:s');
			 			$CleansingTb->clsg_updateby = Yii::app()->user->username;
			 			$CleansingTb->clsg_modified = date('Y-m-d H:i:s');
			 			$CleansingTb->clsg_remark = 'y';
			 			$CleansingTb->clsg_status = 1;
			 			if($CleansingTb->save()){
							//echo "{$r}, {$regis_no}, {$acc_no_wpd}, {$acc_no_sapeins} <br>";
							$sts = 0;
				 			//update data to table cropinfo_tmp ====================
				 			$cif=CropinfoTmpTb::model()->findByAttributes(array('registernumber'=>$regis_not));
							if($cif){
				  				$cif->acc_no = $acc_no_sapeinst;
				  				$cif->crop_updateby = Yii::app()->user->username;
				  				$cif->crop_updatetime = date('Y-m-d H:i:s');
				  				$cif->crop_remark = "A";
				  				$cif->crop_status = 4;
				  				if($cif->save()){
									$sts = 0;
									//$msg3 = "update data is success.";
									// update accnumber===============================
									  $anb=AccnumberTb::model()->findByAttributes(array('acc_regis_no'=>$regis_not));
									  if($anb){
									  	$anb->acc_active_flag = 'C';
									  	$anb->acc_updateby = Yii::app()->user->username;
									  	$anb->acc_modified = date('Y-m-d H:i:s');
									  	$anb->acc_remark = $acc_no_sapeinst;
									  	$anb->acc_status = 5;
									  	if($anb->save()){
										  $sts = 0;
										  // update EmpstateTb =============================================
										  $est=EmpstateTb::model()->findByAttributes(array('ems_registernumber'=>$regis_not));
										  if($est){
											$est->ems_updateby = Yii::app()->user->username;
											$est->ems_modified = date('Y-m-d H:i:s');
											$est->ems_remark = $acc_no_sapeinst;
											$est->ems_status = 2;
											if($est->save()){
												$sts = 0;
											}else{
												$sts = 2;
											}//if
										  }//if
										  
											//update crop_v_bran =========================================
											$cvb=CropVBran::model()->findByAttributes(array('registernumber'=>$regis_not));
											if($cvb){
											  $cvb->acc_no = $acc_no_sapeinst;
											  $cvb->crop_remark = 'A';
											  $cvb->crop_updatetime = date('Y-m-d H:i:s');
											  $cvb->crop_status = 4;
											  if($cvb->save()){
												  $sts = 0;
											  }else{
												  $sts = 1;
											  }
											}//if
										  
										  
									  	}else{//if
											$sts = 3;
										}//if
									  }else{//if
									  	$sts = 4;
									  }//if
								}else{//if
									$sts = 5;
								}
							}//if
						}//if
					}//if
					
					//จบ update data=====================================
					
				echo preg_replace("/\xEF\xBB\xBF/", "","Y");	
						
			}else{ //ถ้ายังไม่มี
			
				echo preg_replace("/\xEF\xBB\xBF/", "","N");
				
			}//if 
		//**************************************************************
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}//if
	}//function
	
		public function actionCallschandsavecropinfo2(){
		if(!Yii::app()->user->isGuest) {
	   		if(isset(Yii::app()->user->username)){
		//*********************************************************
			if(Yii::app()->user->username){
				$username = Yii::app()->user->username;
			}else{
				$username = "sys";
			}
			
			$action = $_POST['action'];
			$schtxt = $_POST['schtxt'];
			$seltxt = $_POST['seltxt'];
			
			//ค้นหา provicecode เดิมออกมา
			$modelbch=BranchTmpTb::model()->findByAttributes(array('registernumber'=>$schtxt));
			$provincecode1 = $modelbch->provincecode;
			
			//ค้นหา provicecode จาก dbd
			
		  
			//$fullPathToWsdl = $_SERVER['DOCUMENT_ROOT'] . "/wpdcore_local/protected/components/" . "CorpInfoWebService.wsdl";
			$fullPathToWsdl = $_SERVER['DOCUMENT_ROOT'] . "/wpdcore/protected/components/" . "CorpInfoWebServiceV5.wsdl";
		
	if (file_exists($fullPathToWsdl)){	
		//echo "The file {$fullPathToWsdl} exists";	
		try{
			$client = new SoapClient($fullPathToWsdl,[
			  'stream_context' => stream_context_create([
				  'ssl' => [
						  'verify_peer' => false,
						  'verify_peer_name' => false,
					  ],
				  ]),
		    ]);
			
			
			$params = array(
				"subscribeId" => 'usersso', //'6211003', //usersso
				"pincode" => 'pinsso', //'P@ssw0rd', //pinsso
				"registerNumber" => $schtxt //'0305562004027'
			 );
			 
			 $data = $client->GetCorpInfoByRegisterNumberService($params);	 
			
		}catch (SoapFault $fault){ //catch (Exception $e){catch (SoapFault $fault){
			//echo "Exception: \n" . $e->getMessage() . "\n";
			//trigger_error("SOAP Fault: (faultcode: {$fault->faultcode}, faultstring: {$fault->faultstring})", E_USER_ERROR);
			$data = "";
			//echo "พบปัญหาการเชื่อมต่อ Server => SOAP Fault: (faultcode: {$fault->faultcode}, faultstring: {$fault->faultstring}) <br> กรุณาติดต่อผู้ดูแลระบบ!";
		}//
			
		   	// echo '<pre>';var_dump($data);echo '</pre>'; 
			 
	}else{
    	//echo "The file wsdl: {$fullPathToWsdl} does not exist";
		//echo "ไม่พบไฟล์ wsdl สำหรับเรียกใช้ web service จาก dbd.";
	}
		
	if($data){
		//echo "have data";
			 if(property_exists($data->CorpInfo,"branches")) {
				if(is_array($data->CorpInfo->branches->branch)){
					$countbranches = count($data->CorpInfo->branches->branch);
					$brow = 1;
					for($b=0;$b<=$countbranches-1;$b++){
						  if(property_exists($data->CorpInfo->branches->branch[$b],"orderNumber")) { 
							$orderNumber = $data->CorpInfo->branches->branch[$b]->orderNumber; 
						  }else{
							$orderNumber = 0; 
						  }
						  if(empty($orderNumber)){
							  $orderNumber = 0;
						  }//if
						  if(property_exists($data->CorpInfo->branches->branch[$b],"provinceCode")) { 
							$provinceCode = $data->CorpInfo->branches->branch[$b]->provinceCode;  
						  }else{
							$provinceCode = "-"; 
						  }
						  if(empty($provinceCode)){
							  $provinceCode ='-';
						  }//if
						  
						  if($orderNumber==0){
						  	//echo "{$orderNumber}, {$provinceCode}<br>";
							break;
						  }
						  
					}//for($b=0
				}else{//if(is_array($data->CorpInfoList->corpInfo[$f]->branches->branch))
					$countbranches=1;
					if(property_exists($data->CorpInfo->branches->branch,"orderNumber")) { 
					  $orderNumber = $data->CorpInfo->branches->branch->orderNumber; 
					}else{
					  $orderNumber = 0; 
					}
					if(empty($orderNumber)){
						$orderNumber =0;
					}
					if(property_exists($data->CorpInfo->branches->branch,"provinceCode")) { 
					  $provinceCode = $data->CorpInfo->branches->branch->provinceCode;  
					}else{
					  $provinceCode = "-"; 
					}
					if(empty($provinceCode)){
						$provinceCode ='-';
					}
					
					//echo "{$orderNumber}, {$provinceCode}<br>";
					
				}//if is_array
			 }//if
			
			//echo "{$orderNumber}, {$provinceCode}, {$provincecode1}<br>";
			
			if($provincecode1==$provinceCode){//กรณีจังหวัดเท่ากัน แสดงว่าไม่จำเป็นต้อง update ให้ส่งค่า "N"
				echo "X";
			}else{
				$transaction = Yii::app()->db->beginTransaction();
				try {
					Yii::app()->CCropinfo_tmp->registernumber = $schtxt;
					Yii::app()->CCropinfo_tmp->username = $username; 
					if(Yii::app()->CCropinfo_tmp->BackupBrn()){ //backup สาขาสำนักงานใหญ่
						echo "backup branch is succss. <br>";
					}else{
						echo "can't backup branch. <br>";
					}
					
					Yii::app()->CCropinfo_tmp->UpdateBrn(); //update ที่ตั้งสำนักงานใหญ่
					
					Yii::app()->CGenAccNo->registernumber = $schtxt;
					Yii::app()->CGenAccNo->CheckAndGenAccno(); //เรียกใช้ฟังก์ชั่น ตรวจสอบและ gen เลข 10 หลักใหม่
					
					$transaction->commit();
					
					$levremark = "update data bran" . $schtxt ;
					$msgresult = Yii::app()->Clogevent->createlogevent("Update", "bran", "UpdateByUser", "bran", $levremark);
					
					echo "ระบบ wpd ทำการปรับปรุงข้อมูลที่อยู่สำนักงานเรียบร้อยแล้ว.";
					
				}catch (\Exception $e) {
					
					$transaction->rollBack();
        			throw $e;	
					
					echo "ระบบ wpd ไม่สามารถปรับปรุงข้อมูลที่อยู่สำนักงานจาก wpd ได้.";
						
				}//try
			}//if
			
	}else{
		//echo "not have data";
		//echo "ไม่พบข้อมูลจาก dbd";
	}//if($data)
			
			//*********************************************************
			
			}else{//if
				$idplib = new Idplib();
				$idplib->getIdpinfo();
			}
		}else{//if
			$idplib = new Idplib();
			$idplib->getIdpinfo();
		}
	}//function
	
}//class